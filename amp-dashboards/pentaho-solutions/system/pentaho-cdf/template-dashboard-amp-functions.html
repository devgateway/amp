<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>AMP Dashboards</title>
        <meta name="keywords" content="" />
        <meta name="description" content="" />
        <link href="/amp-dashboards/css/template.css" rel="stylesheet" type="text/css" media="screen" />
        <link type="text/css" href="/amp-dashboards/js/jquery-ui-1.8.20/css/smoothness/jquery-ui-1.8.20.custom.css" rel="stylesheet" />
        <link rel="stylesheet" type="text/css" href="/amp-dashboards/js/jquery-ui-1.8.20/css/jquery.multiselect.css" />
        <script language="javascript" type="text/javascript" src="/amp-dashboards/js/jquery-ui-1.8.20/js/jquery.multiselect.js" ></script>
        <link rel="stylesheet" type="text/css" href="/amp-dashboards/js/jquery-ui-1.8.20/css/jquery.multiselect.filter.css" />
        <script language="javascript" type="text/javascript" src="/amp-dashboards/js/jquery-ui-1.8.20/js/jquery.multiselect.filter.js" ></script>
        <link rel="stylesheet" type="text/css" href="/amp-dashboards/js/jquery-ui-1.8.20/css/ui.slider.extras.css" />
        <script language="javascript" type="text/javascript" src="/amp-dashboards/js/jquery-ui-1.8.20/js/selectToUISlider.jQuery.js" ></script>
    </head>
    <body>
        <script language="javascript">
		
			var catalogPath = "solution:/AMP Dashboards Phase 2/AMPNepal.xml";
			var jndi = "AMPNepal";

			
            isAdmin = "{isAdmin}";
            isLoggedIn = "{isLoggedIn}";
			
			var startYearConfig = "2006";
			var endYearConfig = "2012";

            // Init jQuery i18n plugin
            loadMessageBundles = function(lang) {
                jQuery.i18n.properties({
                    name:'#{GLOBAL_MESSAGE_SET_NAME}',
                    path:'#{GLOBAL_MESSAGE_SET_PATH}',
                    mode:'both',
                    language:(lang == 'browser' ? jQuery.i18n.browserLang() : lang),
                    callback: function() {
                        #{GLOBAL_MESSAGE_SET}
                    }
                });
                Dashboards.setI18nSupport('#{LANGUAGE_CODE}', jQuery.i18n);
            }

            $(document).ready(function(){
                // Initialize jquery.i18n plugin - load message files
                var userLocale = '#{LANGUAGE_CODE}';
                loadMessageBundles(userLocale);
            });

			
			
        </script>
        <script language="javascript">
        var seminal_chart = {
            type: "cccBarChart",
            name: "render_first_chart",
            chartDefinition: {
              width: 500,
              height: 400,
              dataAccessId: "",
              path: "/AMP Dashboards Phase 2/Better Understand Trends in ODA/composition_of_pool_of_donors_ccc.cda",
              crosstabMode: true,
              seriesInRows: true,
              animate: true,
              clickable: false,
              selectable: false,
              timeSeries: false,
              timeSeriesFormat: "%Y-%m-%d",
              stacked: false,
              maxBarSize: 90,
              panelSizeRatio: 0.5,
              barSizeRatio: 1,
              orientation: "vertical",
              colors: [],
              showValues: false,
              valueFormat: function f(value){return Math.round(value*100) + "%";},
              valuesAnchor: "right",
              titlePosition: "top",
              titleSize: 25,
              legend: true,
              legendPosition: "right",
              legendAlign: "center",
              showXScale: true,
              xAxisPosition: "bottom",
              xAxisSize: 30,
              showYScale: true,
              yAxisPosition: "left",
              yAxisSize: 50,
              xAxisFullGrid: true,
              yAxisFullGrid: true,
              xAxisEndLine: false,
              yAxisEndLine: false,
              xAxisDomainRoundMode: "none",
              yAxisDomainRoundMode: "none",
              secondAxisDomainRoundMode: "none",
              xAxisMinorTicks: true,
              yAxisMinorTicks: true,
              secondAxisMinorTicks: true,
              axisOffset: 0,
              originIsZero: true,
              secondAxis: false,
              secondAxisIndependentScale: true,
              secondAxisIdx: [],
              secondAxisOriginIsZero: true,
              secondAxisColor: "blue",
              extensionPoints: [["xAxisLabel_textAngle","0"],["xAxisLabel_font","12px sans-serif"],["yAxisLabel_font","12px sans-serif"]]
            },
            parameters: [],
            executeAtStart: true,
            htmlObject: "",
            listeners: []
        };
            
            
        var seminal_data_table = {
          type: "Table",
          name: "first_data_table",
          htmlObject: "first_chart_data",
          listeners: [],
          parameters: [],
          chartDefinition: {
            dataAccessId: "first_chart_mdx",
            path: "/AMP Dashboards Phase 2/Better Understand Trends in ODA/composition_of_pool_of_donors_ccc.cda",
            colHeaders: "",
            colTypes: ['string','numeric','numeric','numeric','numeric'],
            colFormats:  [null,'%.2f','%.2f','%.2f','%.2f'],
            colWidths: [],
            colSortable: [],
            colSearchable: [],
            paginate: false,
            paginateServerside: false,
            paginationType: "two_button",
            filter: true,
            info: false,
            sort: false,
            sortBy: [],
            lengthChange: true,
              tableStyle: "themeroller",
            
          },
          executeAtStart: true,
          extraOptions: [],
          expandParameters: [],
          expandOnClick: false
        };
        </script>
        
        <script language="javascript">
        var formatLabel = function(text) {
            var valor = text.split("/");
            return valor[0];
          }
        var formatTooltip = function(text) {
            var valor = text.split("/");
            return valor[0] + valor[1].split("#,")[1];
          }
        var formatYearLabel = function(text) {
            var valor = text.split("/");
            return valor[0];
          }
        var formatPercentage = function(value) {
            var formattedValue = (Math.round(value)*100)/100 + "%";
            return formattedValue;
          }
        var formatCurrencyValue = function(currency, value) {
          if (value != null && value != "")
            return currency + " " + addCommas(value.toFixed(2));
          return "";
          }
        var addCommas = function (nStr) {
            nStr += '';
            x = nStr.split('.');
            x1 = x[0];
            x2 = x.length > 1 ? '.' + x[1] : '';
            var rgx = /(\d+)(\d{3})/;
            while (rgx.test(x1)) {
              x1 = x1.replace(rgx, '$1' + ',' + '$2');
            }
            return x1 + x2;
          }
        </script>

        <div id="content">
            {content}
        </div>
        <script language="javascript">

var startYearSelect = 
{
  name: "startYearSelect",
  type: "select",
  parameters:[],
  parameter:"startYear",
  valueAsId: true,
  htmlObject: "startYearSelect_object",
  queryDefinition: {
    queryType: "mdx",
    jndi: jndi,
    catalog: catalogPath,
    query: function(){
      var query = "SELECT NON EMPTY {[Measures].[Activity Count]} ON COLUMNS, NON EMPTY [Donor Dates].[Year].Members ON ROWS FROM [Donor Funding]";
      return query;
    }
  },
  executeAtStart: true,
  preExecution:function(){},
  postExecution:function(){
    Dashboards.processChange(this.name);
    $("#startYearSelect_object select").val(startYear);
    $("#startYearSelect_object select")[0].id = "startYear";
  }
}
var endYearSelect = 
{
  name: "endYearSelect",
  type: "select",
  parameters:[],
  parameter:"endYear",
  valueAsId: true,
  htmlObject: "endYearSelect_object",
  queryDefinition: {
    queryType: "mdx",
    jndi: jndi,
    catalog: catalogPath,
    query: function(){
      var query = "SELECT NON EMPTY {[Measures].[Activity Count]} ON COLUMNS, NON EMPTY [Donor Dates].[Year].Members ON ROWS FROM [Donor Funding]";
      return query;
    }
  },
  executeAtStart: true,
  preExecution:function(){},
  postExecution:function(){
    Dashboards.processChange(this.name);
    console.log("postExec endYear");
    dateRangeInitialized = true;
    $("#endYearSelect_object select").val(endYear);
    $("#endYearSelect_object select")[0].id = "endYear";
  }
}


var regionSelect = 
{
  name: "regionSelect",
  type: "SelectMulti",
  parameters:[],
  parameter: "regionParameter",
  valueAsId: true,
  htmlObject: "regionSelect_object",
  queryDefinition: {
    queryType: "mdx",
    jndi: jndi,
    catalog: catalogPath,
    query: function(){
      var query = "SELECT NON EMPTY {[Measures].[Activity Count]} ON COLUMNS, " +
        "NON EMPTY [Regions].[Region].Members ON ROWS " +
        "FROM [Donor Funding]";
      return query;
    }
  },
  executeAtStart: true,
  preExecution:function(){},
  postExecution:function(){
    Dashboards.processChange(this.name);
    $("#regionSelect_object select option[value='#No_Data#']").html(Dashboards.i18nSupport.prop("msg_no_data"));
    $('#regionSelect_object > select').width('300px');
    $('#regionSelect_object > select').multiselect(multiSelectConfig);
  },
  postChange: processParameters
}
  
var sectorSelect = 
{
  name: "sectorSelect",
  type: "SelectMulti",
  parameters:[],
  parameter:"sectorParameter",
  valueAsId: true,
  htmlObject: "sectorSelect_object",
  queryDefinition: {
    queryType: "mdx",
    jndi: jndi,
    catalog: catalogPath,
    query: function(){
      var query = "SELECT NON EMPTY {[Measures].[Activity Count]} ON COLUMNS, " +
        "NON EMPTY [Primary Sector].[Primary Sector].Members ON ROWS " +
        "FROM [Donor Funding]";
      return query;
    }
  },
  executeAtStart: true,
  preExecution:function(){},
  postExecution:function(){
    Dashboards.processChange(this.name);
    $("#sectorSelect_object select option[value='#No_Data#']").html(Dashboards.i18nSupport.prop("msg_no_data"));
    $('#sectorSelect_object > select').width('300px');
    $('#sectorSelect_object > select').multiselect(multiSelectConfig);
  },
  postChange:processParameters
}

var programSelect = 
{
  name: "programSelect",
  type: "SelectMulti",
  parameters:[],
  parameter:"programParameter",
  valueAsId: true,
  htmlObject: "programSelect_object",
  queryDefinition: {
    queryType: "mdx",
    jndi: jndi,
    catalog: catalogPath,
    query: function(){
      var query = "SELECT NON EMPTY {[Measures].[Activity Count]} ON COLUMNS, " +
        "NON EMPTY [National Program Level 1].[National Program Level 1].Members ON ROWS " +
        "FROM [Donor Funding]";
      return query;
    }
  },
  executeAtStart: true,
  preExecution:function(){},
  postExecution:function(){
    Dashboards.processChange(this.name);
    $("#programSelect_object select option[value='#No_Data#']").html(Dashboards.i18nSupport.prop("msg_no_data"));
    $('#programSelect_object > select').width('300px');
    $('#programSelect_object > select').multiselect(multiSelectConfig);

  },
  postChange:processParameters
}
        </script>
		</body>
</html>
