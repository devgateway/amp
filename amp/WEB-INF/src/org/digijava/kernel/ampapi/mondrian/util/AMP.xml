<?xml version="1.0"?>
<!DOCTYPE AMP [
<!ENTITY mondriandtd SYSTEM "mondrian.dtd">]>
<Schema name="AMP">
	<Dimension name="AMP Sector">
		<Hierarchy hasAll="true" allMemberName="All Level 0 Sectors" primaryKey="amp_sector_id" name="Level 0 Sector">
			<SectorViewDefinition />
			<Level name="Level 0 Sector" type="Integer" column="level0_sector_id" nameColumn="level0_sector_name" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Level 1 Sectors" primaryKey="amp_sector_id" name="Level 1 Sector">
			<SectorViewDefinition />
			<Level name="Level 1 Sector" type="Integer" column="level1_sector_id" nameColumn="level1_sector_name" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 2 Sectors" primaryKey="amp_sector_id" name="Level 2 Sector">
			<SectorViewDefinition />
			<Level name="Level 2 Sector" type="Integer" column="level2_sector_id" nameColumn="level2_sector_name" />
		</Hierarchy>
	</Dimension>

	<Dimension name="AMP Organization" >
		<Hierarchy hasAll="true" allMemberName="All Orgs" primaryKey="amp_org_id" name="Organization Name">
			<Table name="mondrian_organizations@@locale@@@@nopledges@@" />
			<Level name="Organization Name" uniqueMembers="true" type="Integer" column="amp_org_id" nameColumn="org_name" />
			<Level name="Organization Code" type="Integer" column="amp_org_id" nameColumn="org_code" translated="false"/>
			<Level name="Organization Acronym" type="Integer" column="amp_org_id" nameColumn="org_acronym" translated="false"/>
		</Hierarchy>
		
<!-- 		<Hierarchy hasAll="true" allMemberName="All Orgs" primaryKey="amp_org_id" name="Organization Id">
			<Table name="mondrian_organizations@@locale@@@@nopledges@@" />
			<Level name="Organization Id" uniqueMembers="true" type="Integer" column="amp_org_id"/>
		</Hierarchy>  -->
		
		<Hierarchy hasAll="true" allMemberName="All Types" primaryKey="amp_org_id" name="Organization Type Name">
			<Table name="mondrian_organizations@@locale@@@@nopledges@@" />
			<Level name="Organization Type Name" uniqueMembers="true" type="Integer" column="amp_org_type_id" nameColumn="org_type_name" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Groups" primaryKey="amp_org_id" name="Organization Group Name">
			<Table name="mondrian_organizations@@locale@@@@nopledges@@" />
			<Level name="Organization Group Name" uniqueMembers="true" type="Integer" column="amp_org_grp_id" nameColumn="org_grp_name" />
		</Hierarchy>
	</Dimension>

	<Dimension name="AMP Program" >
		<Hierarchy hasAll="true" allMemberName="All Level 0" primaryKey="amp_theme_id" name="Level 0">
			<ProgramViewDefinition />
			<Level name="Level 0 Name" type="Integer" column="id0" nameColumn="name0" translated="false"/>
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Normal" primaryKey="amp_theme_id" name="Normal">
			<ProgramViewDefinition />
			<Level name="Level 1 Name" type="Integer" column="id1" nameColumn="name1" />
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Detail" primaryKey="amp_theme_id" name="Detail">
			<ProgramViewDefinition />
			<Level name="Detail Name" type="Integer" column="amp_theme_id" nameColumn="name" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 1" primaryKey="amp_theme_id" name="Level 1">
			<ProgramViewDefinition />
			<Level name="Level 1 Name" type="Integer" column="id1" nameColumn="name1" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 2" primaryKey="amp_theme_id" name="Level 2">
			<ProgramViewDefinition />
			<Level name="Level 2 Name" type="Integer" column="id2" nameColumn="name2" />
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Level 3" primaryKey="amp_theme_id" name="Level 3">
			<ProgramViewDefinition />
			<Level name="Level 3 Name" type="Integer" column="id3" nameColumn="name3" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 4" primaryKey="amp_theme_id" name="Level 4">
			<ProgramViewDefinition />
			<Level name="Level 4 Name" type="Integer" column="id4" nameColumn="name4" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 5" primaryKey="amp_theme_id" name="Level 5">
			<ProgramViewDefinition />
			<Level name="Level 5 Name" type="Integer" column="id5" nameColumn="name5" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 6" primaryKey="amp_theme_id" name="Level 6">
			<ProgramViewDefinition />
			<Level name="Level 6 Name" type="Integer" column="id6" nameColumn="name6" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 7" primaryKey="amp_theme_id" name="Level 7">
			<ProgramViewDefinition />
			<Level name="Level 7 Name" type="Integer" column="id7" nameColumn="name7" />
		</Hierarchy>
		
		<Hierarchy hasAll="true" allMemberName="All Level 8" primaryKey="amp_theme_id" name="Level 8">
			<ProgramViewDefinition />
			<Level name="Level 8 Name" type="Integer" column="id8" nameColumn="name8" />
		</Hierarchy>
		
	</Dimension>

	<Dimension name="Category Value">
		<Hierarchy hasAll="true" allMemberName="All Values" primaryKey="acv_id" name="Category Name">
			<Table name="mondrian_category_values@@locale@@" />
			<Level name="Category Name" column="acv_id" type="Integer" nameColumn="acv_name"/>
		</Hierarchy>
	</Dimension>
		
	<Dimension name="Hardcoded Texts">
		<Hierarchy hasAll="true" allMemeberName="All Values" primaryKey="id" name="Hardcoded Text">
			<Table name="mondrian_generic_texts@@locale@@" />
			<Level name="Hardcoded Text" column="id" type="Integer" nameColumn="val" />
		</Hierarchy>
	</Dimension>
		
	<Dimension name="AMP Date" type="TimeDimension">
		<Hierarchy hasAll="true" allMemberName="All Periods" primaryKey="day_code" name="Dates">
			<Table name="mondrian_dates" />
			<Level name="Year" column="year_code@@calendar@@" nameColumn="year_name@@calendar@@" levelType="TimeYears" type="Integer" translated="false" />
			<Level name="Quarter" column="quarter_code@@calendar@@" ordinalColumn="quarter_code@@calendar@@" nameColumn="quarter_name@@calendar@@" levelType="TimeQuarters" type="Integer" translated="false" />
			<Level name="Month" column="month_code@@calendar@@" ordinalColumn="month_code@@calendar@@" nameColumn="month_name@@calendar@@" levelType="TimeMonths" type="Integer"  translated="false" />
			<!-- Level name="Day" column="day_of_month" ordinalColumn="day_of_month" nameColumn="day_of_month_name" levelType="TimeDays" type="Integer" /-->
			<Level name="Date" column="day_code" ordinalColumn="day_code" nameColumn="full_date" type="Integer" levelType="TimeDays" translated="false" >
				<Property name="year_code@@calendar@@" column="year_code@@calendar@@" type="Integer"/>
				<Property name="date_code" column="day_code" type="Integer"/>
			</Level>
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Periods" primaryKey="day_code" name="Year">
		 <Table name="mondrian_dates" />
		  <Level name="Year" column="year_code@@calendar@@" nameColumn="year_name@@calendar@@" levelType="TimeYears" type="Integer" translated="false" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Periods" primaryKey="day_code" name="Quarter">
		 <Table name="mondrian_dates" />
		  <Level name="Quarter" column="quarter_code@@calendar@@" ordinalColumn="quarter_code@@calendar@@" nameColumn="quarter_name@@calendar@@" levelType="TimeQuarters" type="Integer" translated="false" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Periods" primaryKey="day_code" name="Month">
		  <Table name="mondrian_dates" />
		  <Level name="Month" column="month_code@@calendar@@" ordinalColumn="month_code@@calendar@@" nameColumn="month_name@@calendar@@" levelType="TimeMonths" type="Integer" translated="false" />
		</Hierarchy>
	</Dimension>
	
	<Dimension name="Entity Texts">
		<Hierarchy hasAll="true" allMemberName="All Project Title" primaryKey="amp_activity_id" name="Project Title">
			<Table name="mondrian_activity_texts@@locale@@" />
			<Level name="Project Title" column="amp_activity_id" type="Integer" nameColumn="name" />
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Team" primaryKey="amp_activity_id" name="Team">
			<Table name="mondrian_activity_texts@@locale@@" />
			<Level name="Team Id" column="team_id" type="Integer" visible="false"/> 
			<Level name="Team" column="team_id" type="String" nameColumn="team_name"/> 
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Activity Created By" primaryKey="amp_activity_id" name="Activity Created By">
			<Table name="mondrian_activity_texts@@locale@@" />
			<Level name="Activity Created By" column="creator_id" type="String" nameColumn="creator_name" /> 
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Activity Updated By" primaryKey="amp_activity_id" name="Activity Updated By">
			<Table name="mondrian_activity_texts@@locale@@" />
			<Level name="Activity Updated By" column="modifier_id" type="String" nameColumn="modifier_name" /> 
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Activity Approved By" primaryKey="amp_activity_id" name="Activity Approved By">
			<Table name="mondrian_activity_texts@@locale@@" />
			<Level name="Activity Approved By" column="approved_id" type="String" nameColumn="approver_name" /> 
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Government Approval Procedures" primaryKey="amp_activity_id" name="Government Approval Procedures">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="Government Approval Procedures" column="governmentapprovalprocedures_id" type="String" nameColumn="governmentapprovalprocedures_text" /> 
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Joint Criteria" primaryKey="amp_activity_id" name="Joint Criteria">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="Joint Criteria" column="jointcriteria_id" type="String" nameColumn="jointcriteria_text" /> 
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All Indirect On Budget" primaryKey="amp_activity_id" name="Indirect On Budget">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="Indirect On Budget" column="iob_id" type="String" nameColumn="iob_text" /> 
		</Hierarchy>
			
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Implementation Level" primaryKey="amp_activity_id">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="Implementation Level" column="impl_level_id" type="String" nameColumn="impl_level_name" />
		</Hierarchy>
			
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Implementation Location" primaryKey="amp_activity_id">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="Implementation Location" column="impl_location_id" type="String" nameColumn="impl_location_name" />
		</Hierarchy>

		<Hierarchy hasAll="true" allMemberName="All On/Off/Treasury Budget" primaryKey="amp_activity_id" name="On/Off/Treasury Budget">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="On/Off/Treasury Budget" column="on_off_budget_id" type="String" nameColumn="on_off_budget_name" /> 
		</Hierarchy>		
		
		<Hierarchy hasAll="true" allMemberName="All Humanitarian Aid" primaryKey="amp_activity_id" name="Humanitarian Aid">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="Humanitarian Aid" column="humanitarian_aid_id" type="String" nameColumn="humanitarian_aid_name" /> 
		</Hierarchy>		
		
		<Hierarchy hasAll="true" allMemberName="ALL A.C. Chapter" primaryKey="amp_activity_id" name="A.C. Chapter">
			<Table name="mondrian_activity_trn_texts@@locale@@" />
			<Level name="A.C. Chapter" column="ac_chapter_id" type="String" nameColumn="ac_chapter_name" /> 
		</Hierarchy>
		
	</Dimension>
	
	<Dimension name="AMP Location">
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Country" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="Country" column="country_id" type="Integer" nameColumn="country_name" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Region" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="Region" column="region_id" type="Integer" nameColumn="region_name" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Region Id" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="Region Id" column="region_id" type="Integer" nameColumn="region_id" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Zone" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="Zone" column="zone_id" type="Integer" nameColumn="zone_name" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Locations" name="District" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="District" column="district_id" type="Integer" nameColumn="district_name" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Locations" name="GeoCode" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="GeoId" column="id" type="String" nameColumn="geo_code" />
		</Hierarchy>
		<Hierarchy hasAll="true" allMemberName="All Locations" name="Specified Location" primaryKey="id">
			<Table name="mondrian_locations@@locale@@" />
			<Level name="Specified Location" column="id" type="String" nameColumn="location_name" />			
		</Hierarchy>
	</Dimension>
	
	<Cube name="Donor Funding">
		<Table name="@@mondrian_fact_table@@" >
			<SQL dialect="generic"><![CDATA[@@filteredActivities@@]]> </SQL>
		</Table>

		<DimensionUsage name="Activity Texts" source="Entity Texts" foreignKey="entity_id" />
		<DimensionUsage name="Pledge Texts" source="Entity Texts" foreignKey="entity_id" />
		
		<DimensionUsage name="Activity Status" source="Category Value" foreignKey="status_id" />
		<DimensionUsage name="Pledge Status" source="Category Value" foreignKey="status_id" />
		<DimensionUsage name="PledgeModalities" source="Category Value" foreignKey="modality_id" />
		<DimensionUsage name="Modalities" source="Category Value" foreignKey="modality_id" />
		<DimensionUsage name="Type of Cooperation" source="Category Value" foreignKey="type_of_cooperation_id" />
		<DimensionUsage name="Type of Implementation" source="Category Value" foreignKey="type_of_implementation_id" />
		<DimensionUsage name="Procurement System" source="Category Value" foreignKey="procurement_system_id" />
		<DimensionUsage name="Funding Status" source="Category Value" foreignKey="funding_status_id" />
		<DimensionUsage name="Mode of Payment" source="Category Value" foreignKey="mode_of_payment_id" />
		<DimensionUsage name="Financing Instrument" source="Category Value" foreignKey="financing_instrument_id" />
		<DimensionUsage name="Type Of Assistance" source="Category Value" foreignKey="terms_of_assistance_id" />
		<DimensionUsage name="Pledges Type Of Assistance" source="Category Value" foreignKey="terms_of_assistance_id" />
		<DimensionUsage name="Pledges Aid Modality" source="Category Value" foreignKey="modality_id" />
		<DimensionUsage name="Disaster Response Marker" source="Hardcoded Texts" foreignKey="disaster_response" />
		<DimensionUsage name="Expenditure Class" source="Category Value" foreignKey="expenditure_class" />
		
		<Dimension name="Related Projects" foreignKey="related_entity_id">
			<Hierarchy hasAll="true" allMemberName="All Related Projects" primaryKey="amp_activity_id" name="Related Projects">
				<Table name="mondrian_activity_texts@@locale@@" />
				<Level name="Related Projects" column="amp_activity_id" type="Integer" nameColumn="name" />
			</Hierarchy>
		</Dimension>

		<Dimension name="Related Pledges" foreignKey="related_entity_id">
			<Hierarchy hasAll="true" allMemberName="All Related Pledges" primaryKey="amp_activity_id" name="Related Pledges">
				<Table name="mondrian_activity_texts@@locale@@" />
				<Level name="Related Pledges" column="amp_activity_id" type="Integer" nameColumn="name" />
			</Hierarchy>
		</Dimension>
		
		<Dimension name="Activity Fixed Texts" foreignKey="entity_id">
			<Hierarchy hasAll="true" allMemberName="All Activity Id" primaryKey="amp_activity_id" name="Activity Id">
				<Table name="mondrian_activity_fixed_texts" />
				<Level name="Activity Id" column="amp_activity_id" type="Integer"/>
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Activity Id" primaryKey="amp_activity_id" name="Constant">
				<Table name="mondrian_activity_fixed_texts" />
				<Level name="Constant" column="constant" type="String"/>
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Internal Use Id" primaryKey="amp_activity_id" name="Internal Use Id">
				<Table name="mondrian_activity_fixed_texts" />
				<Level name="Internal Use Id" column="amp_activity_id" type="Integer"/>
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Approval Statuses" primaryKey="amp_activity_id" name="Approval Status">
				<Table name="mondrian_activity_fixed_texts" />
				<Level name="Approval Status" columnName="approval_status" column="approval_status_key" />
			</Hierarchy>

			<Hierarchy hasAll="true" allMemberName="All Draft" primaryKey="amp_activity_id" name="Draft">
				<Table name="mondrian_activity_fixed_texts" />
				<Level name="Draft" column="amp_activity_id" type="String" nameColumn="draft" />
			</Hierarchy>
		</Dimension>
		
		<Dimension name="Component" foreignKey="component_id">
			<Hierarchy hasAll="true" allMemberName="All Component Names" name="Component Name" primaryKey="amp_component_id">
				<Table name="mondrian_components@@locale@@" />
				<Level name="Component Name" column="amp_component_id" type="Integer" nameColumn="component_name" />
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Component Descriptions" name="Component Description" primaryKey="amp_component_id">
				<Table name="mondrian_components@@locale@@" />
				<Level name="Component Description" column="amp_component_id" type="Integer" nameColumn="component_description" />
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Component Type Names" name="Component Type Name" primaryKey="amp_component_id">
				<Table name="mondrian_components@@locale@@" />
				<Level name="Component Type Name" column="component_type_id" type="Integer" nameColumn="component_type_name" />
			</Hierarchy>

			<Hierarchy hasAll="true" allMemberName="All Component Type Codes" name="Component Type Code" primaryKey="amp_component_id">
				<Table name="mondrian_components@@locale@@" />
				<Level name="Component Type Code" column="component_type_id" type="Integer" nameColumn="component_type_code" />
			</Hierarchy>
		</Dimension>
		
		<Dimension name="Agreement" foreignKey="agreement_id">
			<Hierarchy hasAll="true" allMemberName="All Agreement Codes" name="Agreement Code" primaryKey="amp_agreement_id">
				<Table name="mondrian_agreements@@locale@@" />
				<Level name="Agreement Code" column="amp_agreement_id" type="Integer" nameColumn="agreement_code" />
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Agreement Title + Codes" name="Agreement Title + Code" primaryKey="amp_agreement_id">
				<Table name="mondrian_agreements@@locale@@" />
				<Level name="Agreement Title + Code" column="amp_agreement_id" type="Integer" nameColumn="agreement_title_code" />
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Agreement Close Dates" name="Agreement Close Date" primaryKey="amp_agreement_id">
				<Table name="mondrian_agreements@@locale@@" />
				<Level name="Agreement Close Date" column="close_date_code" type="Integer" nameColumn="close_date" />
			</Hierarchy>
			
			<Hierarchy hasAll="true" allMemberName="All Agreement Signature Dates" name="Agreement Signature Date" primaryKey="amp_agreement_id">
				<Table name="mondrian_agreements@@locale@@" />
				<Level name="Agreement Signature Date" column="signature_date_code" type="Integer" nameColumn="signature_date" />
			</Hierarchy>

			<Hierarchy hasAll="true" allMemberName="All Agreement Effective Dates" name="Agreement Effective Date" primaryKey="amp_agreement_id">
				<Table name="mondrian_agreements@@locale@@" />
				<Level name="Agreement Effective Date" column="effective_date_code" type="Integer" nameColumn="effective_date" />
			</Hierarchy>

			<Hierarchy hasAll="true" allMemberName="All Agreement Parlimentary Approval Dates" name="Agreement Parlimentary Approval Date" primaryKey="amp_agreement_id">
				<Table name="mondrian_agreements@@locale@@" />
				<Level name="Agreement Parlimentary Approval Date" column="parliamentary_date_code" type="Integer" nameColumn="parliamentary_date" />
			</Hierarchy>
		</Dimension>
		
		<Dimension name="Activity Currency Amounts" foreignKey="entity_id">
			<Hierarchy hasAll="true" allMemberName="All Proposed Project Amount" primaryKey="amp_activity_id" name="Proposed Project Amount">
				<Table name="mondrian_activity_currency_numbers" />
				<Level name="Proposed Project Amount" type="Numeric" column="ppc_transaction_exch_@@currency@@" />
			</Hierarchy>
		</Dimension>
	
		<DimensionUsage name="Location" source="AMP Location" foreignKey="location_id" />
		<DimensionUsage name="Pledges Location" source="AMP Location" foreignKey="location_id" />
		
		<DimensionUsage name="Donor Agency" source="AMP Organization" foreignKey="donor_id" />
		<DimensionUsage name="Pledges Donor Agency" source="AMP Organization" foreignKey="donor_id" />
		<DimensionUsage name="Component Funding Organization" source="AMP Organization" foreignKey="donor_id" />
		
		<DimensionUsage name="Implementing Agency" source="AMP Organization" foreignKey="ia_org_id" />
		<DimensionUsage name="Executing Agency" source="AMP Organization" foreignKey="ea_org_id" />
		<DimensionUsage name="Beneficiary Agency" source="AMP Organization" foreignKey="ba_org_id" />
		<DimensionUsage name="Responsible Organization" source="AMP Organization" foreignKey="ro_org_id" />
		<DimensionUsage name="Contracting Agency" source="AMP Organization" foreignKey="ca_org_id" />
		<DimensionUsage name="Regional Group" source="AMP Organization" foreignKey="rg_org_id" />
		<DimensionUsage name="Sector Group" source="AMP Organization" foreignKey="sg_org_id" />

		<DimensionUsage name="Primary Program" source="AMP Program" foreignKey="primary_program_id" typeName="Primary Program" />
		<DimensionUsage name="Secondary Program" source="AMP Program" foreignKey="secondary_program_id" typeName="Secondary Program" />
		<DimensionUsage name="Tertiary Program" source="AMP Program" foreignKey="tertiary_program_id" typeName="Tertiary Program" />
		<DimensionUsage name="National Objectives" source="AMP Program" foreignKey="national_objectives_program_id" typeName="National Plan Objective" />

		<DimensionUsage name="Pledges Primary Program" source="AMP Program" foreignKey="primary_program_id" typeName="Primary Program" />
		<DimensionUsage name="Pledges Secondary Program" source="AMP Program" foreignKey="secondary_program_id" typeName="Secondary Program" />
		<DimensionUsage name="Pledges Tertiary Program" source="AMP Program" foreignKey="tertiary_program_id" typeName="Tertiary Program" />
		<DimensionUsage name="Pledges National Objectives" source="AMP Program" foreignKey="national_objectives_program_id" typeName="National Planning Objective" />

		<DimensionUsage name="Primary Sector"   source="AMP Sector" foreignKey="primary_sector_id" typeName="Primary" />
		<DimensionUsage name="Secondary Sector" source="AMP Sector" foreignKey="secondary_sector_id" typeName="Secondary" />
		<DimensionUsage name="Tertiary Sector"  source="AMP Sector" foreignKey="tertiary_sector_id" typeName="Tertiary" />
		
		<DimensionUsage name="Pledge Primary Sector"	source="AMP Sector" foreignKey="primary_sector_id" typeName="Primary" />
		<DimensionUsage name="Pledge Secondary Sector"	source="AMP Sector" foreignKey="secondary_sector_id" typeName="Secondary" />
		<DimensionUsage name="Pledge Tertiary Sector"	source="AMP Sector" foreignKey="tertiary_sector_id" typeName="Tertiary" />
		
		<DimensionUsage name="Dates" source="AMP Date" foreignKey="date_code" />
		
		<Dimension name="Flow Name">
		<!-- degenerate dimension; not used in filtering or other complicated ways but for displaying only, so no key column -->
			<Hierarchy hasAll="true">
				<Level name="Flow Name" column="flow_name" />
			</Hierarchy>
		</Dimension>
				
		<Measure name="@@trivial_measure@@" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic" aggregator="sum">
					CASE 
						WHEN @@non_ac_pledges_excluder@@ (@@mondrian_fact_table@@.transaction_type=@@trivial_measure_transaction_type@@) AND (@@mondrian_fact_table@@.adjustment_type=@@trivial_measure_adjustment_type@@) AND (src_role='DN') THEN @@trivial_column@@ 
						ELSE null
					END
				</SQL>
			</MeasureExpression>
		</Measure>
		
		<Measure name="__Actual Commitments United__" aggregator="sum"> <!-- Actual Commitments for "pledges + activities" reports -->
			<MeasureExpression>
				<SQL dialect="generic" aggregator="sum">
					CASE
						WHEN (@@mondrian_fact_table@@.entity_id &gt; 800000000) AND (@@mondrian_fact_table@@.entity_id &lt; 900000000) AND (@@mondrian_fact_table@@.transaction_type=0) AND (@@mondrian_fact_table@@.adjustment_type=@@actual@@) AND (src_role='DN')
							THEN - @@trivial_column@@
							
						WHEN (@@mondrian_fact_table@@.entity_id &gt; 800000000) AND (@@mondrian_fact_table@@.entity_id &lt; 900000000) AND ("@@mondrian_fact_table@@".transaction_type=7)
							THEN @@trivial_column@@
						 						 
						WHEN (@@mondrian_fact_table@@.entity_id &lt; 800000000) AND (@@mondrian_fact_table@@.transaction_type=0) AND (@@mondrian_fact_table@@.adjustment_type=@@actual@@) AND (src_role='DN')
							THEN @@trivial_column@@
							
						ELSE null
					END
				</SQL>
			</MeasureExpression>
		</Measure>
		
		<Measure name="__Actual Commitments Usual__" aggregator="sum"> <!-- Actual Commitments for either pledge reports or activities reports -->
			<MeasureExpression>
				<SQL dialect="generic" aggregator="sum">
					CASE
						WHEN (@@mondrian_fact_table@@.transaction_type=0) AND (@@mondrian_fact_table@@.adjustment_type=@@actual@@) AND (src_role='DN')
							THEN @@trivial_column@@
						ELSE null
					END
				</SQL>
			</MeasureExpression>
		</Measure>

		<Measure name="Real Commitments" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic" aggregator="sum">
					CASE
						WHEN (@@mondrian_fact_table@@.transaction_type = 200) AND (@@mondrian_fact_table@@.adjustment_type=@@actual@@) AND (flow_name &lt;&gt; 'Undefined')
							THEN @@trivial_column@@
						ELSE null
					END
				</SQL>
			</MeasureExpression>
		</Measure>
		
		<Measure name="Real Disbursements" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic" aggregator="sum">
					CASE
						WHEN (@@mondrian_fact_table@@.transaction_type = 201) AND (@@mondrian_fact_table@@.adjustment_type=@@actual@@) AND (flow_name &lt;&gt; 'Undefined')
							THEN @@trivial_column@@
						ELSE null
					END
				</SQL>
			</MeasureExpression>
		</Measure>		
		
		<Measure name="Real MTEFs" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic" aggregator="sum">
					CASE
						WHEN (@@mondrian_fact_table@@.transaction_type = 203) AND (flow_name &lt;&gt; 'Undefined')
							THEN @@trivial_column@@
						ELSE null
					END
				</SQL>
			</MeasureExpression>
		</Measure>		
		
		<Measure name="Planned Disbursements - Capital" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic">
					CASE WHEN @@mondrian_fact_table@@.transaction_type=1 AND @@mondrian_fact_table@@.adjustment_type=@@planned@@ AND src_role='DN' AND capital_spend_percent IS NOT NULL
					THEN @@trivial_column@@ * capital_spend_percent / 100.0 ELSE null END
				</SQL>
			</MeasureExpression>
		</Measure>
		
		<Measure name="Planned Disbursements - Expenditure" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic"> 
					CASE WHEN @@mondrian_fact_table@@.transaction_type=1 AND @@mondrian_fact_table@@.adjustment_type=@@planned@@ AND src_role='DN' AND capital_spend_percent IS NOT NULL
					THEN @@trivial_column@@ * (100 - capital_spend_percent) / 100.0 ELSE null END
				</SQL>
			</MeasureExpression>
		</Measure>
	
		<Measure name="Actual Disbursements - Capital" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic"> 
					CASE WHEN @@mondrian_fact_table@@.transaction_type=1 AND @@mondrian_fact_table@@.adjustment_type=@@actual@@ AND src_role='DN' AND capital_spend_percent IS NOT NULL
					THEN @@trivial_column@@ * capital_spend_percent / 100.0 ELSE null END
				</SQL>
			</MeasureExpression>
		</Measure>
		
		<Measure name="Actual Disbursements - Recurrent" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic">
					CASE WHEN @@mondrian_fact_table@@.transaction_type=1 AND @@mondrian_fact_table@@.adjustment_type=@@actual@@ AND src_role='DN' AND capital_spend_percent IS NOT NULL
					THEN @@trivial_column@@ * (100 - capital_spend_percent) / 100.0 ELSE null END
				</SQL>
			</MeasureExpression>
		</Measure>
			
		<Measure name="Commitment Gap" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic">
					CASE 
						WHEN @@mondrian_fact_table@@.transaction_type=0 AND @@mondrian_fact_table@@.adjustment_type=@@actual@@ AND src_role='DN'
							THEN - @@trivial_column@@ 
						WHEN "@@mondrian_fact_table@@".transaction_type=7
							THEN @@trivial_column@@
					END					
				</SQL>
			</MeasureExpression>
		</Measure>	
				
		<Measure name="MTEF Projections" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic"><![CDATA[
					CASE WHEN (@@mondrian_fact_table@@.transaction_type=3) AND (src_role='DN') AND (@@mteffilter@@)
					THEN @@trivial_column@@ ELSE null END
				]]>	
				</SQL>
			</MeasureExpression>
		</Measure>
		
		<Measure name="Pipeline MTEF Projections" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic"><![CDATA[
					CASE WHEN (@@mondrian_fact_table@@.transaction_type=3) AND (src_role='DN') AND (@@pipelinemteffilter@@)
					THEN @@trivial_column@@ ELSE null END
				]]>
				</SQL>
			</MeasureExpression>
		</Measure>

		<Measure name="Projection MTEF Projections" aggregator="sum">
			<MeasureExpression>
				<SQL dialect="generic"><![CDATA[
					CASE WHEN (@@mondrian_fact_table@@.transaction_type=3) AND (src_role='DN') AND (@@projectionmteffilter@@)
					THEN @@trivial_column@@ ELSE null END
				]]>
				</SQL>
			</MeasureExpression>
		</Measure>

		
		<!-- For SSC specific calculated members please include SSC in the name 
		or define a special attr/tag to exclude them for AMP without SSC config (see AmpMondrianSchemaProcessor.removeSSCComputedMembers) 
		 -->
		<CalculatedMember name="Cumulated SSC Commitments" dimension="Measures">
		 	<Formula>
				[Measures].[Bilateral SSC Commitments] + [Measures].[Triangular SSC Commitments]
			</Formula>
		</CalculatedMember>
		
		<CalculatedMember name="Undisbursed Balance" dimension="Measures">
		 	<Formula>
				[Measures].[Actual Commitments] - [Measures].[Actual Disbursements]
			</Formula>
			<!-- some strange exception happens at last conversion call that implies some 
				formats conversion for negative values, 
				thus we need to define it explicitly,
				but it is not used anyway in Saiku display
				-->
			<CalculatedMemberProperty name="FORMAT_STRING" value="#,##0.00"/>			
		</CalculatedMember>						
	</Cube>
 </Schema>
