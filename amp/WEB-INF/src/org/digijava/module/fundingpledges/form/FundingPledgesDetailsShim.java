// Generated by delombok at Mon Mar 24 00:10:06 EET 2014
package org.digijava.module.fundingpledges.form;

import java.util.Date;

import org.dgfoundation.amp.ar.AmpARFilter;
import org.digijava.module.aim.dbentity.AmpCurrency;
import org.digijava.module.aim.helper.FormatHelper;
import org.digijava.module.aim.util.CurrencyUtil;
import org.digijava.module.categorymanager.util.CategoryManagerUtil;
import org.digijava.module.fundingpledges.dbentity.FundingPledges;
import org.digijava.module.fundingpledges.dbentity.FundingPledgesDetails;
import org.digijava.module.common.util.DateTimeUtil;

import static org.dgfoundation.amp.algo.AlgoUtils.*;

public class FundingPledgesDetailsShim implements UniquelyIdentifiable {
    private Long pledgeTypeId;
    private Long typeOfAssistanceId;
    private Long aidModalityId;
    private String amount;
    private Long currencyId;
    private Long fundingYear;
    private long uniqueId = PledgeForm.uniqueIds.getAndIncrement();
    
    private String fundingDateStart;
    private String fundingDateEnd;
    
    public FundingPledgesDetailsShim(AmpCurrency currency) {
        this.amount = "0";
        this.currencyId = currency.getAmpCurrencyId();
    }
    
    public FundingPledgesDetailsShim(FundingPledgesDetails fpd) {
        this.pledgeTypeId = getIdFrom(fpd.getPledgetype());
        this.typeOfAssistanceId = getIdFrom(fpd.getTypeOfAssistance());
        this.aidModalityId = getIdFrom(fpd.getAidmodality());
        this.amount = FormatHelper.formatNumber(fpd.getAmount());
        this.currencyId = getIdFrom(fpd.getCurrency());
        this.fundingYear = getLongFrom(fpd.getFundingYear());
        this.fundingDateStart = DateTimeUtil.formatDate(fpd.getFundingDateStart(), AmpARFilter.SDF_OUT_FORMAT_STRING);
        this.fundingDateEnd = DateTimeUtil.formatDate(fpd.getFundingDateEnd(), AmpARFilter.SDF_OUT_FORMAT_STRING);
    }
    
    public FundingPledgesDetails buildFundingPledgesDetail(FundingPledges pledge){
        FundingPledgesDetails fps = new FundingPledgesDetails();
        fps.setPledgeid(pledge);
        fps.setAmount(FormatHelper.parseDouble(this.getAmount()));
        fps.setAidmodality(CategoryManagerUtil.loadAcvOrNull(this.getAidModalityId()));
        fps.setCurrency(this.getCurrencyId() == null ? null : CurrencyUtil.getAmpcurrency(this.getCurrencyId()));
        fps.setFundingYear(this.getFundingYear() == null ? null : this.getFundingYear().toString());
        fps.setPledgetype(CategoryManagerUtil.loadAcvOrNull(this.getPledgeTypeId()));
        fps.setTypeOfAssistance(CategoryManagerUtil.loadAcvOrNull(this.getTypeOfAssistanceId()));
        fps.setFundingDateStart(this.getFundingDateStartAsDate());
        fps.setFundingDateEnd(this.getFundingDateEndAsDate());
        return fps;
    }
    
    public String getCurrencyCode(){
        return currencyId == null ? null : CurrencyUtil.getCurrency(this.currencyId).getCurrencyCode();
    }
    
    public String getFundingTimeFrame(){
        return FundingPledgesDetails.getDatesDescriptionOf(this.getFundingYear(), this.getFundingDateStartAsDate(), this.getFundingDateEndAsDate());
    }
    
    public Date getFundingDateStartAsDate(){
        return DateTimeUtil.parseDate(fundingDateStart, AmpARFilter.SDF_OUT_FORMAT_STRING);
    }
    
    public Date getFundingDateEndAsDate(){
        return DateTimeUtil.parseDate(fundingDateEnd, AmpARFilter.SDF_OUT_FORMAT_STRING);
    }
    
    public String getFundingDateStartSettingsFormat(){
        return DateTimeUtil.formatDate(this.getFundingDateStartAsDate());
    }
    
    public String getFundingDateEndSettingsFormat(){
        //
        return DateTimeUtil.formatDate(this.getFundingDateEndAsDate());
    }

    @Override public String toString(){
        return String.format("%s curr: %s, ToA: %d, fundingYear: %d, pledgeTypeId: %d", this.amount, this.currencyId, this.typeOfAssistanceId, this.fundingYear, this.pledgeTypeId);
    }
        
    @java.lang.SuppressWarnings("all")
    public Long getPledgeTypeId() {
        return this.pledgeTypeId;
    }
    
    @java.lang.SuppressWarnings("all")
    public Long getTypeOfAssistanceId() {
        return this.typeOfAssistanceId;
    }
    
    @java.lang.SuppressWarnings("all")
    public Long getAidModalityId() {
        return this.aidModalityId;
    }
    
    @java.lang.SuppressWarnings("all")
    public String getAmount() {
        return this.amount;
    }
    
    @java.lang.SuppressWarnings("all")
    public Long getCurrencyId() {
        return this.currencyId;
    }
    
    @java.lang.SuppressWarnings("all")
    public Long getFundingYear() {
        return this.fundingYear;
    }
    
    @java.lang.SuppressWarnings("all")
    public long getUniqueId() {
        return this.uniqueId;
    }
    
    @java.lang.SuppressWarnings("all")
    public void setPledgeTypeId(final Long pledgeTypeId) {
        this.pledgeTypeId = pledgeTypeId;
    }
    
    @java.lang.SuppressWarnings("all")
    public void setTypeOfAssistanceId(final Long typeOfAssistanceId) {
        this.typeOfAssistanceId = typeOfAssistanceId;
    }
    
    @java.lang.SuppressWarnings("all")
    public void setAidModalityId(final Long aidModalityId) {
        this.aidModalityId = aidModalityId;
    }
    
    @java.lang.SuppressWarnings("all")
    public void setAmount(final String amount) {
        this.amount = amount;
    }
    
    @java.lang.SuppressWarnings("all")
    public void setCurrencyId(final Long currencyId) {
        this.currencyId = currencyId;
    }
    
    @java.lang.SuppressWarnings("all")
    public void setFundingYear(final Long fundingYear) {
        this.fundingYear = fundingYear;
    }
    
    public String getFundingDateStart() {
        return fundingDateStart;
    }

    public void setFundingDateStart(String fundingDateStart) {
        this.fundingDateStart = fundingDateStart;
    }

    public String getFundingDateEnd() {
        return fundingDateEnd;
    }

    public void setFundingDateEnd(String fundingDateEnd) {
        this.fundingDateEnd = fundingDateEnd;
    }

    @java.lang.SuppressWarnings("all")
    public void setUniqueId(final long uniqueId) {
        this.uniqueId = uniqueId;
    }
}
