"use strict";(self.webpackChunkreampv2=self.webpackChunkreampv2||[]).push([[552],{60409:function(e,t,n){n.d(t,{Z:function(){return a}});var r="FETCH_SETTINGS_PENDING",o="FETCH_SETTINGS_SUCCESS",i="FETCH_SETTINGS_ERROR";var c=n(79748);var a=function(){return function(e){return e({type:r}),fetch(c.Ko).then((function(e){return e.json()})).then((function(t){if(t.error)throw t.error;return e({type:o,payload:t}),t})).catch((function(t){e(function(e){return{type:i,error:e}}(t))}))}}},79748:function(e,t,n){n.d(t,{CY:function(){return h},DC:function(){return m},G7:function(){return o},Ko:function(){return v},PJ:function(){return c},Pz:function(){return d},YP:function(){return i},kj:function(){return p},mh:function(){return l},nI:function(){return u},q4:function(){return g},ry:function(){return r},tD:function(){return f},x2:function(){return a},z1:function(){return s}});var r="src-program",o="dst-program",i="all-programs",c="program-mapping",a="-program",s="children",l=2,d=3,u=4,p="srcLvl",h="src",f="dst",g="/rest/security/layout",v="/rest/amp/settings",m="/rest/activity/updateMappings/async"},60552:function(e,t,n){n.r(t),n.d(t,{default:function(){return wt}});var r=n(9249),o=n(87371),i=n(45754),c=n(86906),a=n(50383),s=n.n(a),l=n(83112),d=n(10941),u=n.n(d),p=n(94652),h=n(50840),f=n(33028),g=n(38587),v="Project Title",m="Activity Updated On",j="AMP ID",y="Administrative Level 0",x="FETCH_ACTIVITIES_PENDING",Z="FETCH_ACTIVITIES_SUCCESS",C="FETCH_ACTIVITIES_ERROR",S="SELECT_ACTIVITY_FOR_GEOCODING",A="TOGGLE_NATIONAL_PROJECTS";function b(e){return{type:S,payload:e}}var _=function(){return function(e){e({type:A})}},E=function(e){var t=[-999999999],n=[];e?(t.push(96),n.push(y)):n.push(j);var r={name:"Geocoding",add_columns:[v,m,j,y,"Project Description"],filters:{"administrative-level-0":t},sorting:[{columns:n,asc:!1}],recordsPerPage:-1,"include-location-children":!1};return function(e){return e({type:x}),(0,g.aV)({url:"/rest/data/report/custom/paginate",body:r}).then((function(t){return e(function(e){return{type:Z,payload:e.page.pageArea.children.map((function(e){return{id:e.contents["["+v+"]"].entityId,col1:e.contents["["+m+"]"]?e.contents["["+m+"]"].displayedValue:"",col2:e.contents["["+j+"]"]?e.contents["["+j+"]"].displayedValue:"",col3:e.contents["["+v+"]"].displayedValue,col4:e.contents["["+y+"]"].displayedValue?e.contents["["+y+"]"].displayedValue:"---"}}))}}(t))})).catch((function(t){return console.error(t),e(function(e){return{type:C,error:e}}(t))}))}},R="FETCH_GEOCODING_PENDING",T="FETCH_GEOCODING_SUCCESS",N="FETCH_GEOCODING_ERROR",P="GEOCODING_LOCATION_PENDING",w="GEOCODING_LOCATION_SUCCESS",O="GEOCODING_LOCATION_ERROR",G="GEOCODING_RESET_ALL_PENDING",I="GEOCODING_RESET_ALL_SUCCESS",k="GEOCODING_RESET_ALL_ERROR",L="GEOCODING_CANCEL_PENDING",D="GEOCODING_CANCEL_SUCCESS",F="GEOCODING_CANCEL_ERROR",H="GEOCODING_RUN_SEARCH_PENDING",V="GEOCODING_RUN_SEARCH_SUCCESS",U="GEOCODING_RUN_SEARCH_ERROR",B="GEOCODING_SAVE_ALL_EDITS_PENDING",M="GEOCODING_SAVE_ALL_EDITS_CHECK",z="GEOCODING_SAVE_ACTIVITY_PENDING",J="GEOCODING_SAVE_ACTIVITY_SUCCESS",Y="GEOCODING_SAVE_ACTIVITY_ERROR",W="GEOCODING_REMOVE_PROJECT_PENDING",K="GEOCODING_REMOVE_PROJECT_SUCCESS",X="GEOCODING_REMOVE_PROJECT_ERROR",q="GEOCODING_RESET_SAVE_RESULTS";function Q(e,t,n){return{type:N,error:e,status:t,errorCode:n}}function $(){return{type:M}}var ee=function(){return function(e){return e({type:R}),(0,g.S2)({url:"/rest/geo-coder/process"}).then((function(t){return e(function(e){return{type:T,payload:e,pending:!1,geocodeShouldRun:(t=e.data,t.activities&&t.activities.filter((function(e){return"RUNNING"===e.status})).length>0),status:"IN_PROGRESS"};var t}(t))})).catch((function(t){return 404===t.status?e({type:T,payload:{},status:"NOT_STARTED"}):e(Q(t.message,"NOT_AVAILABLE",t.code))}))}},te=function(e){return function(t){return t({type:H}),(0,g.S2)({body:e,url:"/rest/geo-coder/process"}).then((function(e){return t(function(e){return{type:V,payload:e,pending:!1,status:"IN_PROGRESS"}}(e))})).catch((function(e){return t(function(e){return{type:U,error:e.message,errorCode:e.code}}(e))}))}},ne=function(e,t,n){var r={amp_id:e,amp_category_value_location_id:t,accepted:n};return function(o){return o(function(e,t,n){return{type:P,payload:{amp_id:e,location_id:t,accepted:n}}}(e,t,n)),(0,g.S2)({url:"/rest/geo-coder/location-status",body:r}).then((function(){return o(function(e,t,n){return{type:w,payload:{amp_id:e,location_id:t,accepted:n}}}(e,t,n))})).catch((function(e){return o(function(e){return{type:O,error:e}}(e.message))}))}},re=function(){return function(e){return e({type:G}),(0,g.S2)({url:"/rest/geo-coder/reset-location-statuses",body:{}}).then((function(){return e({type:I})})).catch((function(t){return e(function(e){return{type:k,error:e}}(t.message))}))}},oe=function(){return function(e){return e({type:L}),(0,g.hL)({url:"/rest/geo-coder/process"}).then((function(){return e({type:D})})).catch((function(t){return e(function(e){return{type:F,error:e}}(t))}))}},ie=function(e){return function(t){t({type:B}),e.forEach((function(e){return t(ce(e))}))}},ce=function(e){return function(t){return t(function(e){return{type:z,payload:e}}(e)),(0,g.S2)({body:{},url:"/rest/geo-coder/activity/save/"+e}).then((function(n){return t(function(e){return{type:J,payload:e}}(e)),t($())})).catch((function(n){return t(function(e,t){return{type:Y,error:t,payload:e}}(e,n.message)),t($())}))}},ae=function(e){return function(t){return t(function(e){return{type:W,payload:e}}(e)),(0,g.S2)({body:{},url:"/rest/geo-coder/activity/remove/"+e}).then((function(n){return t(function(e){return{type:K,payload:e}}(e))})).catch((function(e){return t(function(e){return{type:X,error:e}}(e.message))}))}},se=function(){return function(e){return e({type:q})}};var le={pending:!1,activities:[],selectedActivities:[],includeNationalProjects:!1,error:null};var de={pending:!1,reset_pending:!1,running:!1,status:null,creator:null,workspace:null,activities:[],save_activities_result:[],save_pending:!1,error:null,reset_error:null,geocodeShouldRun:!1};function ue(e,t){return e.map((function(e,n){return e.amp_id===t.payload.amp_id?(0,f.Z)((0,f.Z)({},e),{},{locations:pe(e.locations,t)}):e}))}function pe(e,t){return e.map((function(e,n){return e.id===t.payload.location_id?(0,f.Z)((0,f.Z)({},e),{},{accepted:t.payload.accepted,pending:!1}):e}))}function he(e,t,n,r){return e.find((function(e){return e.amp_id===t}))?e.map((function(e,o){return e.amp_id===t?(0,f.Z)((0,f.Z)({},e),{},{pending:n,error:r}):e})):(e.push({amp_id:t,pending:n,error:r}),e)}function fe(e,t){return e.filter((function(e){return e.amp_id!==t}))}var ge="FETCH_SETTINGS_PENDING",ve="FETCH_SETTINGS_SUCCESS",me="FETCH_SETTINGS_ERROR";var je={settingsLoaded:!1,settingsPending:!1,settings:{},error:null},ye=(0,l.combineReducers)({translationsReducer:h.Z,activitiesReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return(0,f.Z)((0,f.Z)({},e),{},{pending:!0});case Z:return(0,f.Z)((0,f.Z)({},e),{},{pending:!1,activities:t.payload});case C:return(0,f.Z)((0,f.Z)({},e),{},{pending:!1,error:t.error});case H:return(0,f.Z)((0,f.Z)({},e),{},{selectedActivities:[],pending:!0,error:null});case U:return(0,f.Z)((0,f.Z)({},e),{},{pending:!1,error:t.error});case V:return(0,f.Z)((0,f.Z)({},e),{},{pending:t.pending,error:null});case S:return(0,f.Z)((0,f.Z)({},e),{},{selectedActivities:t.payload});case A:return(0,f.Z)((0,f.Z)({},e),{},{includeNationalProjects:!e.includeNationalProjects});default:return e}},geocodingReducer:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case R:return(0,f.Z)((0,f.Z)({},t),{},{geocodeShouldRun:!1,pending:!0});case T:return(0,f.Z)((0,f.Z)((0,f.Z)({},t),n.payload.data),{},{status:n.status,pending:n.pending,geocodeShouldRun:n.geocodeShouldRun,error:null,errorCode:null});case N:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,error:n.error,geocodeShouldRun:!1,status:n.status,errorCode:n.errorCode});case V:return(0,f.Z)((0,f.Z)((0,f.Z)({},t),n.payload.data),{},{status:n.status,pending:!1,geocodeShouldRun:!0,error:null});case P:return(0,f.Z)((0,f.Z)({},t),{},{activities:ue(t.activities,n)});case w:case O:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,activities:ue(t.activities,n)});case G:return(0,f.Z)((0,f.Z)({},t),{},{pending:!0,error:null});case I:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,activities:(e=t.activities,e.map((function(e,t){return(0,f.Z)((0,f.Z)({},e),{},{locations:(n=e.locations,n.map((function(e,t){return(0,f.Z)((0,f.Z)({},e),{},{accepted:null,pending:!1})})))});var n})))});case k:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,error:n.error});case L:return(0,f.Z)((0,f.Z)({},t),{},{pending:!0,error:null});case D:return(0,f.Z)((0,f.Z)({},t),{},{status:"NOT_STARTED",error:null,pending:!1,activities:[]});case F:return(0,f.Z)((0,f.Z)({},t),{},{error:n.error});case B:return(0,f.Z)((0,f.Z)({},t),{},{pending:!0,save_pending:!0,geocodeShouldRun:!1});case M:var r=function(e){if(e.find((function(e){return!0===e.pending})))return!0;return!1}(t.save_activities_result);return(0,f.Z)((0,f.Z)({},t),{},{error:null,save_pending:r,pending:r,geocodeShouldRun:!r});case z:return(0,f.Z)((0,f.Z)({},t),{},{save_activities_result:he(t.save_activities_result,n.payload,!0,null)});case J:return(0,f.Z)((0,f.Z)({},t),{},{save_activities_result:he(t.save_activities_result,n.payload,!1,null),activities:fe(t.activities,n.payload)});case Y:return(0,f.Z)((0,f.Z)({},t),{},{save_activities_result:he(t.save_activities_result,n.payload,!1,n.error)});case q:return(0,f.Z)((0,f.Z)({},t),{},{save_activities_result:[]});case U:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,error:n.error,errorCode:n.errorCode});case W:return(0,f.Z)((0,f.Z)({},t),{},{pending:!0,error:null});case K:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,activities:fe(t.activities,n.payload)});case X:return(0,f.Z)((0,f.Z)({},t),{},{pending:!1,error:n.error,errorCode:n.errorCode});default:return t}},settingsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ge:return(0,f.Z)((0,f.Z)({},e),{},{settingsPending:!0});case ve:return(0,f.Z)((0,f.Z)({},e),{},{settingsPending:!1,settingsLoaded:!0,settings:t.payload});case me:return(0,f.Z)((0,f.Z)({},e),{},{settingsPending:!1,settingsLoaded:!1,error:t.payload.error});default:return e}}}),xe=JSON.parse('{"amp.geocoder:projectList":"Project List","amp.geocoder:geocodedSelection":"GeoCoded Selection","amp.geocoder:selectProjects":"Select Projects","amp.geocoder:addNationalLevelProjects":"+ Add National Level Projects","amp.geocoder:addNationalLevelProjectsTooltip":"Include all national level projects","amp.geocoder:removeNationalLevelProjects":"- Remove National Level Projects ","amp.geocoder:removeNationalLevelProjectsTooltip":"Exclude all national level projects","amp.geocoder:select":"Select","amp.geocoder:settings":"Settings","amp.geocoder:resetAll":"Reset All","amp.geocoder:selectAllTooltip":"You can select all the projects which you will use to run the research and label with locations","amp.geocoder:cancelGeocoding":"Cancel Geocoding","amp.geocoder:saveAllEdits":"Save All Edits","amp.geocoder:saveAllEditsTooltip":"When you are done editing, save the edits to post the changes to the server.","amp.geocoder:saveAllEditsConfirmation":"Save All Edits made in activities?","amp.geocoder:editActionTooltip":"You can open the activity window to accept or reject a location label","amp.geocoder:saveResults":"Save Results","amp.geocoder:saveResultsText":"Activities saved without errors","amp.geocoder:saveResultsErrorText":"Activities not saved due to errors","amp.geocoder:runSearch":"Run Search","amp.geocoder:runSearchTooltip":"When you run the search, it will label projects that meet the criteria with a location, which you can then accept or reject.","amp.geocoder:runSearchText":"Activities to be geocoded","amp.geocoder:removeProject":"Remove Project","amp.geocoder:removeProjectTooltip":"You can remove the project from the list","amp.geocoder:removeProjectConfirmation":"Do you want to remove this project from the list?","amp.geocoder:running":"Geocoding is still running","amp.geocoder:cancel":"Cancel","amp.geocoder:ok":"OK","amp.geocoder:projectName":"Project Name","amp.geocoder:lastUpdatedDate":"Last Updated Date","amp.geocoder:ampId":"AMP ID","amp.geocoder:country":"Administrative Level 0","amp.geocoder:projectDescription":"Project Description","amp.geocoder:location":"Location","amp.geocoder:locations":"Locations","amp.geocoder:locationAccept":"accept","amp.geocoder:locationAcceptTooltip":"Confirm that the location label for the project is correct","amp.geocoder:locationReject":"reject","amp.geocoder:locationRejectTooltip":"Confirm that the location label for the project is not correct. When you click \\"Save All Edits\\" the location of the project will not be changed. ","amp.geocoder:noLocations":"No locations","amp.geocoder:errorGeocoding":"Error in Geocoding","amp.geocoder:errorGeocodingTooltip":"There has been an error in the geocoding process. Contact the administrator for further investigation.","amp.geocoder:noActivities":"No activities found for Geocoding","amp.geocoder:discardGeocodingButton":"Discard Geocoding","amp.geocoder:discardGeocodingText":"There is no geocoded location found. You can cancel the geocoding process.","amp.geocoder:cancelGeocodingConfirmation":"Cancel the geocode process?","amp.geocoder:resetAllConfirmation":"All the geocoded locations would be reset.","amp.geocoder:errorAlertWarning":"Sorry, there was a problem.","amp.geocoder:geocodingRunning":"Geocoder Running","amp.geocoder:geocodingRunningText":"The GeoCoding Tool is currently running based on selections chosen to be GeoCoded","amp.geocoder:paginationTo":"to","amp.geocoder:paginationOf":"of","amp.geocoder:paginationProjects":"projects","amp.geocoder:searchResults":"Search Results of","amp.geocoder:paginationNextPageTitle":"Next Page","amp.geocoder:paginationPrevPageTitle":"Previous Page","amp.geocoder:paginationFirstPageTitle":"First Page","amp.geocoder:paginationLastPageTitle":"Last Page","amp.geocoder:error.0001":"Unexpected error has happened. Please contact the administrator to get more details.","amp.geocoder:error.1704":"The Current Geocoding process was created by user \'{0}\' and is not available. Please contact them to get more details. Once that process is done another one will be able to be launched.","amp.geocoder:error.1705":"The Current Geocoding process was created in the \'{0}\' workspace and it is available only in that workspace. Please login to that workspace to see the geocoding process status.","amp.geocoder:error.1706":"Geocoding client error. Please contact the administrator to get more details.","amp.geocoder:error.1707":"The connection to the geocoding service has failed. Please contact the administrator to get more details.","amp.geocoder:error.0512":"You are not authenticated or your session has been expired.","amp.geocoder:error.differentImplementationLevels":"You cannot save activities with different implementation levels at the same time."}'),Ze=n(35209),Ce=n(47371),Se=n(60409),Ae=n(59653),be=s().createContext({translations:xe}),_e=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e._fetchTranslations,n=e._loadGeocoding,r=e._fetchSettings;t(xe),n(),r()}},{key:"render",value:function(){return this.props.translationPending||this.props.geocodingPending?(0,Ae.jsx)(Ce.g,{}):(0,Ae.jsx)(be.Provider,{value:{translations:this.props.translations},children:this.props.children})}}]),n}(a.Component),Ee=(0,p.connect)((function(e){return{translationPending:e.translationsReducer.pending,translations:e.translationsReducer.translations,geocoding:e.geocodingReducer.geocoding}}),(function(e){return(0,l.bindActionCreators)({_fetchTranslations:Ze.Z,_loadGeocoding:ee,_fetchSettings:Se.Z},e)}))(_e),Re=n(80753),Te=n(50150),Ne=n(16819),Pe=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onResetAll=function(e){o.props.resetAllActivities(),o.handleClose()},o.state={show:!1},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o.handleShow=o.handleShow.bind((0,Re.Z)(o)),o.onResetAll=o.onResetAll.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"hasActivityAcceptedOrRejectedLocations",value:function(e){return 0!==e.locations.length&&e.locations.filter((function(e){return null!=e.accepted})).length>0}},{key:"render",value:function(){var e=this,t=this.context.translations,n=this.props.geocoding.activities.filter((function(t){return e.hasActivityAcceptedOrRejectedLocations(t)})).length>0;return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(Te.Z,{variant:"primary",className:"pull-right",onClick:this.handleShow,disabled:!n,children:this.props.title}),(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:this.props.title})}),(0,Ae.jsx)(Ne.Z.Body,{children:t["amp.geocoder:resetAllConfirmation"]}),(0,Ae.jsxs)(Ne.Z.Footer,{children:[(0,Ae.jsx)(Te.Z,{variant:"secondary",onClick:this.handleClose,children:t["amp.geocoder:cancel"]}),(0,Ae.jsx)(Te.Z,{variant:"primary",className:"button-header",onClick:this.onResetAll,children:this.props.title})]})]})]})}}]),n}(a.Component);Pe.contextType=be;var we=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer}}),(function(e){return(0,l.bindActionCreators)({resetAllActivities:re},e)}))(Pe),Oe=n(99565),Ge=n(90844),Ie=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.context.translations,t=function(e,t){var n=t.errorCode,r=t.error,o="amp.geocoder:error."+n;if(e.hasOwnProperty(o)){if("1704"===n||"1705"===n){var i=JSON.parse(r);return(0,Ge.R)(e[o],i[0][Object.keys(i[0])[0]][0])}return e[o]}return r}(e,this.props);return(0,Ae.jsxs)(Oe.Z,{variant:"danger",show:!0,transition:!1,children:[(0,Ae.jsx)(Oe.Z.Heading,{children:e["amp.geocoder:errorAlertWarning"]}),(0,Ae.jsx)("p",{children:t})]})}}]),n}(a.Component);Ie.contextType=be;var ke=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCancelGeocoding=function(e){o.props.cancelGeocoding(),o.handleClose()},o.state={show:!1},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o.handleShow=o.handleShow.bind((0,Re.Z)(o)),o.onCancelGeocoding=o.onCancelGeocoding.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this.context.translations;return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(Te.Z,{variant:"warning",onClick:this.handleShow,children:this.props.title}),(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:this.props.title})}),(0,Ae.jsx)(Ne.Z.Body,{children:e["amp.geocoder:cancelGeocodingConfirmation"]}),(0,Ae.jsxs)(Ne.Z.Footer,{children:[(0,Ae.jsx)(Te.Z,{variant:"secondary",onClick:this.handleClose,children:e["amp.geocoder:cancel"]}),(0,Ae.jsx)(Te.Z,{variant:"primary",className:"button-header",onClick:this.onCancelGeocoding,children:this.props.title}),this.props.geocoding.pending&&(0,Ae.jsx)(Ce.g,{}),this.props.geocoding.error&&(0,Ae.jsx)(Ie,{error:this.props.geocoding.error})]})]})]})}}]),n}(a.Component);ke.contextType=be;var Le=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer}}),(function(e){return(0,l.bindActionCreators)({cancelGeocoding:oe},e)}))(ke),De=n(57298),Fe=n(52979),He=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onSaveAllEdits=function(){var e=o.props.geocoding.activities.filter((function(e){return e.locations.length>0})).filter((function(e){return e.locations.filter((function(e){return!1!==e.accepted&&!0!==e.accepted})).length<1})).filter((function(e){return"SAVED"!==e.status})).map((function(e){return e.amp_id}));o.props._resetSaveResults(),o.props._saveAllEdits(e),o.handleClose()},o.state={show:!1},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o.handleShow=o.handleShow.bind((0,Re.Z)(o)),o.onSaveAllEdits=o.onSaveAllEdits.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"hasActivityAcceptedOrRejectedAllLocations",value:function(e){return 0!==e.locations.length&&0===e.locations.filter((function(e){return null===e.accepted})).length}},{key:"render",value:function(){var e=this,t=this.context.translations,n=this.props.geocoding.activities.filter((function(t){return e.hasActivityAcceptedOrRejectedAllLocations(t)&&"SAVED"!==t.status})).length>0;return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:function(t){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},t),{},{children:e.props.tooltip}))},children:(0,Ae.jsx)(Te.Z,{variant:"success",className:"pull-right button-header",disabled:!n,onClick:this.handleShow,children:this.props.title})}),(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:this.props.title})}),(0,Ae.jsx)(Ne.Z.Body,{children:t["amp.geocoder:saveAllEditsConfirmation"]}),(0,Ae.jsxs)(Ne.Z.Footer,{children:[(0,Ae.jsx)(Te.Z,{variant:"secondary",onClick:this.handleClose,children:t["amp.geocoder:cancel"]}),(0,Ae.jsx)(Te.Z,{variant:"success",className:"button-header",onClick:this.onSaveAllEdits,children:this.props.title})]})]})]})}}]),n}(a.Component);He.contextType=be;var Ve=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer}}),(function(e){return(0,l.bindActionCreators)({_resetSaveResults:se,_saveAllEdits:ie},e)}))(He),Ue=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.context.translations;return this.props.geocoding.pending||this.props.geocoding.geocodeShouldRun?(0,Ae.jsx)(Ae.Fragment,{}):(0,Ae.jsxs)("div",{className:"panel-body custom-panel geocoder-header",children:[(0,Ae.jsx)(Le,{title:e["amp.geocoder:cancelGeocoding"]}),(0,Ae.jsx)(Ve,{className:"pull-right button-header",title:e["amp.geocoder:saveAllEdits"],tooltip:e["amp.geocoder:saveAllEditsTooltip"]}),(0,Ae.jsx)(we,{title:e["amp.geocoder:resetAll"],tooltip:e["amp.geocoder:resetAllTooltip"]})]})}}]),n}(a.Component);Ue.contextType=be;var Be=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer}}),(function(e){return(0,l.bindActionCreators)({},e)}))(Ue),Me=n(49730),ze=n.n(Me),Je=n(94909),Ye=n.n(Je),We=n(70202),Ke=n.n(We);function Xe(e){var t=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);return t?new Date(t[3],t[2]-1,t[1]):null}function qe(e,t,n){return"asc"===n?Xe(e)-Xe(t):Xe(t)-Xe(e)}var Qe=n(22465),$e=function(e){return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)("div",{className:"modal-backdrop show"}),(0,Ae.jsx)("div",{className:"loading",children:(0,Ae.jsx)("div",{className:"loading-dialog",children:(0,Ae.jsxs)("div",{className:"loading-content",children:[(0,Ae.jsx)("div",{className:"loading-title",children:e.title}),(0,Ae.jsx)("div",{className:"loading-spinner",children:(0,Ae.jsx)(Qe.ClipLoader,{size:30,loading:!0})}),(0,Ae.jsx)("div",{className:"loading-text",children:e.text})]})})})]})},et=function(e,t,n,r){return(0,Ae.jsxs)("span",{className:"react-bootstrap-table-pagination-total",children:[e," ",r["amp.geocoder:paginationTo"]," ",t," ",r["amp.geocoder:paginationOf"]," ",n," ",r["amp.geocoder:paginationProjects"]]})},tt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).wrapper=s().createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props._loadActivities()}},{key:"render",value:function(){var e=this,t=this.context.translations,n=function(e){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},e),{},{children:t["amp.geocoder:selectAllTooltip"]}))},r={page:1,sizePerPage:this.props.settings["workspace-default-records-per-page"],pageStartIndex:1,paginationSize:15,hideSizePerPage:!0,showTotal:!0,prePageTitle:t["amp.geocoder:paginationNextPageTitle"],nextPageTitle:t["amp.geocoder:paginationPrevPageTitle"],firstPageTitle:t["amp.geocoder:paginationFirstPageTitle"],lastPageTitle:t["amp.geocoder:paginationLastPageTitle"],paginationTotalRenderer:function(e,n,r){return et(e,n,r,t)}},o={mode:"checkbox",style:{background:"#F2FFF8"},onSelect:function(t,n,r,o){e.props.onSelectActivity(n,t.id)},selectionHeaderRenderer:function(e){var t=e.mode,r=e.checked;return(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:n,children:(0,Ae.jsx)("input",{type:t,checked:r})})},onSelectAll:this.props.onSelectAllActivities},i=t["amp.geocoder:lastUpdatedDate"],c=t["amp.geocoder:ampId"],a=t["amp.geocoder:projectName"],s=t["amp.geocoder:location"],l=[{dataField:"id",text:"ID",hidden:!0},{dataField:"col1",text:i,sort:!0,sortFunc:function(e,t,n){return qe(e,t,n)},headerStyle:function(){return{width:"15%"}}},{dataField:"col2",text:c,headerStyle:function(){return{width:"20%"}},sort:!0,filter:(0,We.textFilter)({placeholder:t["amp.geocoder:select"]+" "+c})},{dataField:"col3",text:a,headerStyle:function(){return{width:"45%"}},filter:(0,We.textFilter)({placeholder:t["amp.geocoder:select"]+" "+a}),sort:!0},{dataField:"col4",text:s,headerStyle:function(){return{width:"15%"}},sort:!0}];return(0,Ae.jsx)("div",{className:"activity-table",children:this.props.activitiesPending?(0,Ae.jsx)($e,{title:t["amp.geocoder:geocodingRunning"],text:t["amp.geocoder:geocodingRunningText"]}):(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsx)(ze(),{ref:function(t){return e.node=t},keyField:"id",scrollY:!0,data:this.props.activities,maxHeight:"200px",columns:l,classes:"table-striped",selectRow:o,pagination:Ye()(r),noDataIndication:function(){return t["amp.geocoder:noActivities"]},filter:Ke()()})})})}}]),n}(a.Component);tt.contextType=be;var nt=(0,p.connect)((function(e){return{activitiesPending:e.activitiesReducer.pending,activities:e.activitiesReducer.activities,settings:e.settingsReducer.settings}}),(function(e){return(0,l.bindActionCreators)({_loadActivities:E},e)}))(tt),rt=n(33587),ot=n(71861),it=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onRemoveProject=function(e){o.props._removeProject(o.props.ampId),o.handleClose(e)},o.state={show:!1},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o.handleShow=o.handleShow.bind((0,Re.Z)(o)),o.onRemoveProject=o.onRemoveProject.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(e){e&&e.stopPropagation&&e.stopPropagation(),this.setState({show:!1})}},{key:"handleShow",value:function(e){e&&e.stopPropagation&&e.stopPropagation(),this.setState({show:!0})}},{key:"render",value:function(){var e=this.context.translations;return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:function(t){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},t),{},{children:e["amp.geocoder:removeProjectTooltip"]}))},children:(0,Ae.jsx)(ot.FontAwesomeIcon,{className:"fa-icon fa-lg",icon:rt.faTimesCircle,onClick:this.handleShow})}),(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:e["amp.geocoder:removeProject"]})}),(0,Ae.jsxs)(Ne.Z.Body,{children:[(0,Ae.jsx)("p",{children:e["amp.geocoder:removeProjectConfirmation"]}),(0,Ae.jsx)("div",{className:"modal-activities",children:(0,Ae.jsxs)("div",{children:[e["amp.geocoder:ampId"],": ",this.props.ampId]})})]}),(0,Ae.jsxs)(Ne.Z.Footer,{children:[(0,Ae.jsx)(Te.Z,{variant:"secondary",onClick:this.handleClose,children:e["amp.geocoder:cancel"]}),(0,Ae.jsx)(Te.Z,{variant:"success",className:"button-header",onClick:this.onRemoveProject,children:e["amp.geocoder:removeProject"]})]})]})]})}}]),n}(a.Component);it.contextType=be;var ct=(0,p.connect)((function(){return{}}),(function(e){return(0,l.bindActionCreators)({_removeProject:ae},e)}))(it),at=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=function(t){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},t),{},{children:e.props.tooltip}))};return this.props.enabled?(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:t,children:(0,Ae.jsx)(ot.FontAwesomeIcon,{className:"fa-icon fa-lg",icon:rt.faPencilAlt})}),(0,Ae.jsx)(ct,{ampId:this.props.ampId})]}):this.props.tooltipEnabled?(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:t,children:(0,Ae.jsx)("div",{className:"red-bold-message",children:this.props.message})})}):(0,Ae.jsx)("div",{className:"red-bold-message",children:this.props.message})}}]),n}(a.Component),st=n(69278),lt=n.n(st),dt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props.handleLocation,n=t.handleAcceptLocation,r=t.handleRejectLocation,o=this.context.translations;return(0,Ae.jsx)("div",{className:"location-action",children:!0===this.props.location.accepted?"ACCEPTED":!1===this.props.location.accepted?"REJECTED":(0,Ae.jsxs)("ul",{children:[(0,Ae.jsx)("li",{children:(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:function(e){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},e),{},{children:o["amp.geocoder:locationAcceptTooltip"]}))},children:(0,Ae.jsxs)("a",{href:"#",title:"accept",onClick:function(t){return n(t,e.props.location.id)},children:[(0,Ae.jsx)(ot.FontAwesomeIcon,{className:"fa-icon fa-2x",icon:rt.faCheckCircle}),(0,Ae.jsx)("span",{children:o["amp.geocoder:locationAccept"]})]})})}),(0,Ae.jsx)("li",{children:(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:function(e){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},e),{},{children:o["amp.geocoder:locationRejectTooltip"]}))},children:(0,Ae.jsxs)("a",{href:"#",title:"reject",onClick:function(t){return r(t,e.props.location.id)},children:[(0,Ae.jsx)(ot.FontAwesomeIcon,{className:"fa-icon fa-2x",icon:rt.faTimesCircle}),(0,Ae.jsx)("span",{children:o["amp.geocoder:locationReject"]})]})})})]})})}}]),n}(a.Component);dt.contextType=be;var ut=(0,p.connect)((function(e,t){return{}}),(function(e){return(0,l.bindActionCreators)({},e)}))(dt);function pt(e){return e.fields.map((function(e){return(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsxs)("div",{children:[" / ",(0,Ae.jsx)("b",{children:e.label})," |",(0,Ae.jsx)("span",{className:"location-text",children:(0,Ae.jsx)(lt(),{searchWords:[e.entity],autoEscape:!0,textToHighlight:e.value})})]})})}))}var ht=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).selectLocations=function(e){return o.props.activities.filter((function(t){return t.amp_id===e}))[0].locations},o.handleAcceptLocation=function(e,t){o.props.geocodeLocation(o.props.ampId,t,!0),e.preventDefault()},o.handleRejectLocation=function(e,t){o.props.geocodeLocation(o.props.ampId,t,!1),e.preventDefault()},o.selectLocations=o.selectLocations.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.selectLocations(this.props.ampId),n={handleAcceptLocation:this.handleAcceptLocation.bind(this),handleRejectLocation:this.handleRejectLocation.bind(this)},r=this.context.translations,o=t.map((function(t){return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsxs)("tr",{children:[(0,Ae.jsxs)("td",{className:"col-10 location-name-column",children:[(0,Ae.jsx)("span",{className:"location-name",children:t.name}),(0,Ae.jsxs)("span",{children:["(",t.administrative_level,")"]})]}),(0,Ae.jsx)("td",{className:"col-70 location-field-column ",children:(0,Ae.jsx)(pt,{fields:t.fields})}),(0,Ae.jsx)("td",{className:"col-20",children:(0,Ae.jsx)(ut,{location:t,handleLocation:n,props:e.props})})]}),(0,Ae.jsx)("tr",{children:(0,Ae.jsx)("td",{colSpan:"3",children:(0,Ae.jsx)("div",{className:"border-line"})})})]})}));return(0,Ae.jsxs)("div",{children:[(0,Ae.jsxs)("div",{className:"search-result",children:[(0,Ae.jsx)("b",{children:t.length})," ",r["amp.geocoder:searchResults"]," ",(0,Ae.jsx)("b",{children:r["amp.geocoder:locations"]})]}),(0,Ae.jsx)("div",{children:(0,Ae.jsx)("table",{className:"location-container",children:(0,Ae.jsx)("tbody",{children:o})})})]})}}]),n}(a.Component);ht.contextType=be;var ft=(0,p.connect)((function(e){return{activities:e.geocodingReducer.activities}}),(function(e){return(0,l.bindActionCreators)({geocodeLocation:ne},e)}))(ht),gt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onDiscardChanges=function(e){o.props.cancelGeocoding(),o.handleClose()},o.state={show:!0},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o.onDiscardChanges=o.onDiscardChanges.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this.context.translations;return(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:this.props.title})}),(0,Ae.jsx)(Ne.Z.Body,{children:e["amp.geocoder:discardGeocodingText"]}),(0,Ae.jsxs)(Ne.Z.Footer,{children:[(0,Ae.jsx)(Te.Z,{variant:"secondary",onClick:this.handleClose,children:e["amp.geocoder:cancel"]}),(0,Ae.jsx)(Te.Z,{variant:"primary",className:"button-header",onClick:this.onDiscardChanges,children:this.props.title}),this.props.geocoding.pending&&(0,Ae.jsx)(Ce.g,{}),this.props.geocoding.error&&(0,Ae.jsx)(Ie,{error:this.props.geocoding.error})]})]})})}}]),n}(a.Component);gt.contextType=be;var vt=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer}}),(function(e){return(0,l.bindActionCreators)({cancelGeocoding:oe},e)}))(gt),mt=n(68079);function jt(e){var t=[],n=e.activities.filter((function(e){return!e.error})),r=e.activities.filter((function(e){return e.error}));function o(e){return e.reduce((function(e,t){return Array.isArray(t)?e.push.apply(e,(0,mt.Z)(o(t))):(e.push(t),e)}),[])}function i(t){return"Different implementation levels selected"===t?e.translations["amp.geocoder:error.differentImplementationLevels"]:t}function c(e){return o(Object.values(JSON.parse(e)).map((function(e){return Object.values(e)})).flat()).map(i).join("; ")}return n.length>0&&(t.push((0,Ae.jsxs)("div",{className:"status-header",children:[e.translations["amp.geocoder:saveResultsText"],":"]})),t.push(n.map((function(t){return(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsxs)("div",{children:[e.translations["amp.geocoder:ampId"],": ",t.amp_id]})})})))),r.length>0&&(t.push((0,Ae.jsx)("br",{})),t.push((0,Ae.jsxs)("div",{className:"status-header",children:[e.translations["amp.geocoder:saveResultsErrorText"],":"]})),t.push(r.map((function(t){return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsxs)("div",{children:[e.translations["amp.geocoder:ampId"],": ",t.amp_id]}),(0,Ae.jsx)("div",{className:"status-error",children:c(t.error)}),(0,Ae.jsx)("br",{})]})})))),t}var yt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).state={show:!0},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(){this.props.resetSaveResults(),this.setState({show:!1})}},{key:"render",value:function(){var e=this.context.translations;return(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:this.props.title})}),(0,Ae.jsx)(Ne.Z.Body,{children:(0,Ae.jsx)(jt,{translations:e,activities:this.props.geocoding.save_activities_result})}),(0,Ae.jsx)(Ne.Z.Footer,{children:(0,Ae.jsx)(Te.Z,{variant:"primary",onClick:this.handleClose,children:e["amp.geocoder:ok"]})})]})})}}]),n}(a.Component);yt.contextType=be;var xt=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer}}),(function(e){return(0,l.bindActionCreators)({loadGeocoding:ee,resetSaveResults:se},e)}))(yt),Zt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleActionsClick=function(e){o.setState({selectedRowAction:e})},o.hasLocations=function(e){return o.props.activities.filter((function(t){return t.amp_id===e}))[0].locations.length>0},o.hasError=function(e){return"ERROR"===o.props.activities.filter((function(t){return t.amp_id===e}))[0].status},o.getNonExpandableIds=function(){return o.props.activities.filter((function(e){return e.locations.length<1})).map((function(e){return e.amp_id}))},o.existLocationsInGeocoding=function(){return o.props.activities.some((function(e){return"ERROR"===e.status||e.locations.length>0&&"SAVED"!==e.status}))},o.existSaveResults=function(){return o.props.save_activities_result&&o.props.save_activities_result.length>0},o.state={selectedRowAction:null},o.handleActionsClick=o.handleActionsClick.bind((0,Re.Z)(o)),o.hasLocations=o.hasLocations.bind((0,Re.Z)(o)),o.wrapper=s().createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props.geocodeShouldRun&&this.props.loadGeocoding()}},{key:"componentDidUpdate",value:function(){var e=this;this.props.geocodeShouldRun&&setTimeout((function(){return e.props.loadGeocoding()}),5e3)}},{key:"expandComponent",value:function(e){return(0,Ae.jsx)("div",{children:(0,Ae.jsx)(ft,{})})}},{key:"render",value:function(){var e=this,t=this.context.translations;if(this.props.geocodingPending||this.props.geocodeShouldRun)return(0,Ae.jsx)($e,{title:t["amp.geocoder:geocodingRunning"],text:t["amp.geocoder:geocodingRunningText"]});var n={onlyOneExpanding:!1,renderer:function(e){return(0,Ae.jsx)(ft,{ampId:e.amp_id})},nonExpandable:this.getNonExpandableIds(),showExpandColumn:!0,expandByColumnOnly:!1,expandColumnPosition:"right",parentClassName:"geocoding-table-expanded-row",expandColumnRenderer:function(n){n.isExpanded;var r=n.rowKey,o=(n.expandable,e.hasError(r)),i=e.hasLocations(r);return(0,Ae.jsx)(at,{ampId:r,enabled:i,tooltipEnabled:i||o,message:o?t["amp.geocoder:errorGeocoding"]:t["amp.geocoder:noLocations"],tooltip:o?t["amp.geocoder:errorGeocodingTooltip"]:t["amp.geocoder:editActionTooltip"]})},expandHeaderColumnRenderer:function(e){e.isAnyExpands;return null}},r={page:1,sizePerPage:this.props.settings["workspace-default-records-per-page"],pageStartIndex:1,paginationSize:5,hideSizePerPage:!0,showTotal:!0,prePageTitle:t["amp.geocoder:paginationNextPageTitle"],nextPageTitle:t["amp.geocoder:paginationPrevPageTitle"],firstPageTitle:t["amp.geocoder:paginationFirstPageTitle"],lastPageTitle:t["amp.geocoder:paginationLastPageTitle"],paginationTotalRenderer:function(e,n,r){return et(e,n,r,t)}},o=t["amp.geocoder:lastUpdatedDate"],i=t["amp.geocoder:ampId"],c=t["amp.geocoder:projectName"],a=[{dataField:"updated_date",text:o,sort:!0,sortFunc:function(e,t,n){return qe(e,t,n)},headerStyle:function(){return{width:"15%"}}},{dataField:"amp_id",text:i,headerStyle:function(){return{width:"20%"}},filter:(0,We.textFilter)({placeholder:t["amp.geocoder:select"]+" "+i}),sort:!0},{dataField:"project_title",text:c,headerStyle:function(){return{width:"58%"}},filter:(0,We.textFilter)({placeholder:t["amp.geocoder:select"]+" "+c}),sort:!0}],s=this.props.activities.filter((function(e){return"ERROR"===e.status||e.locations.length>0&&"SAVED"!==e.status}));return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)("div",{className:"activity-table",children:(0,Ae.jsx)(ze(),{keyField:"amp_id",scrollY:!0,data:s,maxHeight:"200px",columns:a,expandRow:n,classes:"table-striped geocoding-table",pagination:Ye()(r),filter:Ke()(),expandColumnOptions:{expandColumnVisible:!0,columnWidth:"200px"}})}),this.existSaveResults()?(0,Ae.jsx)(xt,{title:t["amp.geocoder:saveResults"]}):!this.existLocationsInGeocoding()&&(0,Ae.jsx)(vt,{title:t["amp.geocoder:discardGeocodingButton"]})]})}}]),n}(a.Component);Zt.contextType=be;var Ct=(0,p.connect)((function(e){return{geocodingPending:e.geocodingReducer.pending,activities:e.geocodingReducer.activities,save_activities_result:e.geocodingReducer.save_activities_result,geocodeShouldRun:e.geocodingReducer.geocodeShouldRun,settings:e.settingsReducer.settings}}),(function(e){return(0,l.bindActionCreators)({loadGeocoding:ee},e)}))(Zt),St=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onRunSearch=function(){o.props.runSearch(o.props.selectedActivities),o.handleClose()},o.state={show:!1},o.handleClose=o.handleClose.bind((0,Re.Z)(o)),o.handleShow=o.handleShow.bind((0,Re.Z)(o)),o.onRunSearch=o.onRunSearch.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this,t=this.context.translations;return(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:function(t){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},t),{},{children:e.props.tooltip}))},children:(0,Ae.jsx)(Te.Z,{variant:"success",className:"pull-right button-header",disabled:this.props.selectedActivities.length<1||this.props.activitiesPending,onClick:this.handleShow,children:this.props.title})}),(0,Ae.jsxs)(Ne.Z,{show:this.state.show,onHide:this.handleClose,animation:!1,children:[(0,Ae.jsx)(Ne.Z.Header,{closeButton:!0,children:(0,Ae.jsx)(Ne.Z.Title,{children:this.props.title})}),(0,Ae.jsxs)(Ne.Z.Body,{children:[t["amp.geocoder:runSearchText"],":",(0,Ae.jsx)("div",{className:"modal-activities",children:this.props.activities.filter((function(t){return e.props.selectedActivities.includes(t.id)})).map((function(e){return(0,Ae.jsx)("div",{children:e.col2},e.col2)}))})]}),(0,Ae.jsxs)(Ne.Z.Footer,{children:[(0,Ae.jsx)(Te.Z,{variant:"secondary",onClick:this.handleClose,children:t["amp.geocoder:cancel"]}),(0,Ae.jsx)(Te.Z,{variant:"success",className:"button-header",onClick:this.onRunSearch,children:this.props.title})]})]})]})}}]),n}(a.Component);St.contextType=be;var At=(0,p.connect)((function(e){return{geocoding:e.geocodingReducer,activitiesPending:e.activitiesReducer.pending,activities:e.activitiesReducer.activities}}),(function(e){return(0,l.bindActionCreators)({runSearch:te},e)}))(St),bt=function(e){var t=e.title,n=e.selectedSize,r=e.size;return(0,Ae.jsx)(Ae.Fragment,{children:(0,Ae.jsxs)("div",{className:"col-md-2 text-header",children:[(0,Ae.jsx)("span",{children:t}),(0,Ae.jsx)("span",{className:"activities-message",children:(0,Ae.jsxs)("b",{children:["(",n,"/",r,")"]})})]})})},_t=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onToggleNationalProjects=function(){o.props._switchNationalProjects(),o.props._loadActivities(!o.props._includeNationalProjects)},o.onToggleNationalProjects=o.onToggleNationalProjects.bind((0,Re.Z)(o)),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.context.translations;if(this.props.activitiesPending)return(0,Ae.jsx)(Ae.Fragment,{});var t=this.props._includeNationalProjects?e["amp.geocoder:removeNationalLevelProjectsTooltip"]:e["amp.geocoder:addNationalLevelProjectsTooltip"],n=this.props._includeNationalProjects?e["amp.geocoder:removeNationalLevelProjects"]:e["amp.geocoder:addNationalLevelProjects"];return(0,Ae.jsxs)("div",{className:"panel-body custom-panel geocoder-header",children:[(0,Ae.jsx)(bt,{title:e["amp.geocoder:selectProjects"],selectedSize:this.props.selectedActivities.length,size:this.props.activities.length}),(0,Ae.jsx)(At,{title:e["amp.geocoder:runSearch"],tooltip:e["amp.geocoder:runSearchTooltip"],selectedActivities:this.props.selectedActivities,onRunSearch:this.onRunSearch}),(0,Ae.jsx)(Fe.Z,{placement:"top",overlay:function(e){return(0,Ae.jsx)(De.Z,(0,f.Z)((0,f.Z)({},e),{},{children:t}))},children:(0,Ae.jsx)(Te.Z,{variant:"primary",className:"pull-right button-header",onClick:this.onToggleNationalProjects,children:n})})]})}}]),n}(a.Component);_t.contextType=be;var Et=(0,p.connect)((function(e){return{activities:e.activitiesReducer.activities,activitiesPending:e.activitiesReducer.pending,_includeNationalProjects:e.activitiesReducer.includeNationalProjects}}),(function(e){return(0,l.bindActionCreators)({_switchNationalProjects:_,_loadActivities:E},e)}))(_t),Rt=function(e){var t=e.title;return(0,Ae.jsx)("div",{className:"geocoder-title",children:t})},Tt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).onSelectActivity=function(t,n){var r=Array.from(e.props.selectedActivities);t?r.push(n):r=r.filter((function(e){return e!==n})),e.props.selectActivitiesForGeocoding(r)},e.onSelectAllActivities=function(t,n){var r=Array.from(e.props.selectedActivities),o=n.map((function(e){return e.id}));t?o.forEach((function(e){return r.push(e)})):r=r.filter((function(e){return!o.includes(e)})),e.props.selectActivitiesForGeocoding(r)},e}return(0,o.Z)(n,[{key:"render",value:function(){var e,t,n,r=this.context.translations,o=this.props.geocoding&&"NOT_STARTED"!==this.props.geocoding.status,i=r["amp.geocoder:projectList"];return o?(n=this.props.geocoding.pending||this.props.geocoding.geocodeShouldRun,i=i+" - "+r["amp.geocoder:geocodedSelection"],t=(0,Ae.jsx)(Be,{}),e=(0,Ae.jsx)(Ct,{})):(n=this.props.activitiesPending,t=(0,Ae.jsx)(Et,{selectedActivities:this.props.selectedActivities}),e=(0,Ae.jsx)(nt,{onSelectActivity:this.onSelectActivity.bind(this),onSelectAllActivities:this.onSelectAllActivities.bind(this)})),(0,Ae.jsx)("div",{children:this.props.geocoding.error?(0,Ae.jsx)(Ie,{error:this.props.geocoding.error,errorCode:this.props.geocoding.errorCode}):(0,Ae.jsxs)("div",{children:[!n&&(0,Ae.jsx)(Rt,{title:i}),(0,Ae.jsxs)("div",{className:"panel panel-default",children:[t,e]})]})})}}]),n}(a.Component);Tt.contextType=be;var Nt=(0,p.connect)((function(e){return{activitiesPending:e.activitiesReducer.pending,geocoding:e.geocodingReducer,selectedActivities:e.activitiesReducer.selectedActivities}}),(function(e){return(0,l.bindActionCreators)({selectActivitiesForGeocoding:b},e)}))(Tt),Pt=(n(16843),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.compose),wt=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).store=(0,l.createStore)(ye,Pt((0,l.applyMiddleware)(u()))),o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,Ae.jsx)(p.Provider,{store:this.store,children:(0,Ae.jsx)(Ee,{defaultTrnPack:xe,children:(0,Ae.jsx)("div",{className:"container",children:(0,Ae.jsx)(Nt,{})})})})}}]),n}(a.Component)},1342:function(e,t,n){n.d(t,{BB:function(){return f},ET:function(){return g},Ez:function(){return u},IN:function(){return U},Ic:function(){return s},JP:function(){return B},LM:function(){return _},O:function(){return h},PU:function(){return v},S9:function(){return j},SJ:function(){return x},Sw:function(){return R},TM:function(){return D},Vs:function(){return l},WP:function(){return k},_G:function(){return Z},aD:function(){return O},ah:function(){return I},bm:function(){return Y},cE:function(){return p},eM:function(){return b},e_:function(){return d},fz:function(){return y},g1:function(){return T},gW:function(){return A},ij:function(){return L},io:function(){return P},pj:function(){return N},qp:function(){return a},rF:function(){return c},rP:function(){return E},ry:function(){return o},sC:function(){return V},sK:function(){return F},tU:function(){return w},um:function(){return m},vW:function(){return S},wU:function(){return H},wt:function(){return C},xE:function(){return r},xg:function(){return J},yr:function(){return G},z7:function(){return i}});var r=0,o=1,i=-1,c="/assets/img/flags/",a="dashboard-default-min-year-range",s="dashboard-default-max-year-range",l="/rest/filters/sectors",d="/rest/filters/locations?firstLevelOnly=true&showAllCountries=true",u="/rest/amp/settings",p="/rest/filters/modalities?sscWorkspace=true",h="/rest/gis/sscdashboard",f="/rest/gis/sscdashboard/xsl",g="/rest/gis/activities",v=12,m="#fd8f00",j="#fd8f00",y="#007236",x="#007236",Z="png",C=50,S=-999999999,A=9,b=6,_=1766,E=5,R="-1",T=1920,N=145,P=2,w="0",O="SSC_",G="home",I="sector",k="modality",L="download",D="country-column",F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAbCAQAAACkGQXlAAAAI0lEQVR42mP8L8lAVcA4auCogaMGjho4auCogaMGjhpINAAAOBcdpLw/CDsAAAAASUVORK5CYII=",H="000",V="primary-sector",U="ssc-modalities",B="donor-agency-country",M=new Map([["110","#d46453"],["120","#f5a15d"],["130","#ffcf8e"],["140","#ff7a7d"],["150","#ff417d"],["160","#d61a88"],["210","#fff540"],["220","#28c074"],["230","#429058"],["240","#bd4035"],["250","#b0fff1"],["311","#144491"],["312","#9b0e3e"],["313","#10908e"],["321","#8f5765"],["322","#c7d4e1"],["323","#77b02a"],["331","#488bd4"],["332","#928fb8"],["400","#c6d831"],["500","#d41e3c"],["600","#cf968c"],["700","#78d7ff"],["910","#94007a"],["920","#ffb84a"],["930","#ed7b39"],["998","#ed4c40"],["000","#8f5765"]]),z=new Map([[H,"#8f5765"]]),J=new Map([[k,["#00429d","#3761ab","#5681b9","#73a2c6","#93c4d2","#b9e5dd","#ffffe0","#ffd3bf","#ffa59e","#f4777f","#dd4c65","#be214d","#93003a"]]]),Y=new Map([[I,M],[k,z]])},90844:function(e,t,n){n.d(t,{N:function(){return o},R:function(){return i}});var r=n(9542);function o(){return"production"===r.x?"/#":"".concat("/TEMPLATE/reampv2/build","/index.html#")}function i(e){var t=arguments;return e.replace(/{(\d+)}/g,(function(e,n){var r=parseInt(n)+1;return"undefined"!=typeof t[r]?t[r]:e}))}},35209:function(e,t,n){var r=n(64454),o=n(58234);t.Z=function(e){return function(t){return t((0,r.M0)(e)),(0,o.X)(e).then((function(e){return t((0,r.sq)(e))})).catch((function(e){return t((0,r.nW)(e))}))}}},64454:function(e,t,n){n.d(t,{M0:function(){return c},b5:function(){return r},k_:function(){return o},nW:function(){return s},pv:function(){return i},sq:function(){return a}});var r="FETCH_TRANSLATIONS_PENDING",o="FETCH_TRANSLATIONS_SUCCESS",i="FETCH_TRANSLATIONS_ERROR";function c(e){return{type:r,payload:e}}function a(e){return{type:o,payload:e}}function s(e){return{type:i,error:e}}},38587:function(e,t,n){n.d(t,{S2:function(){return c},aV:function(){return i},hL:function(){return o}});function r(e){var t={method:e?"POST":"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}};return e&&(t.body=JSON.stringify(e)),t}var o=function(e){var t=e.url,n={method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}};return new Promise((function(e,r){return fetch(t,n).then((function(t){return t.error?r(t.error):e(t)})).catch((function(e){return r(e)}))}))},i=function(e){var t=e.body,n=e.url;return new Promise((function(e,o){return fetch(n,r(t)).then((function(e){return e.json()})).then((function(t){return t.error?o(t.error):e(t)})).catch((function(e){return o(e)}))}))},c=function(e){var t=e.body,n=e.url;return new Promise((function(e,o){return fetch(n,r(t)).then((function(t){return t.text().then((function(e){var n=t.headers.get("content-type"),r=e;return e&&n&&-1!==n.indexOf("application/json")&&(r=JSON.parse(e)),{data:r,ok:t.ok,status:t.status}})).then((function(t){return t.ok?e(t):o({status:t.status,message:a(t),code:s(t)})}))})).catch((function(e){return o(e)}))}))};function a(e){var t="";if(e.data&&e.data.error)for(var n in e.data.error)t+=JSON.stringify(e.data.error[n]);else t=e.data;return t}function s(e){if(e.data&&e.data.error)for(var t in e.data.error)return t;return e.data}},47371:function(e,t,n){n.d(t,{g:function(){return o}});n(50383);var r=n(59653),o=function(){return(0,r.jsx)("div",{className:"jumbotron",children:(0,r.jsx)("div",{className:"progress",children:(0,r.jsx)("div",{className:"progress-bar progress-bar-striped bg-info",role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100",style:{width:"100%"},children:"..."})})})}},58234:function(e,t,n){n.d(t,{X:function(){return s},a:function(){return a}});var r=n(1342),o="POST",i="GET";function c(e,t){var n={method:e?o:i,headers:t||{"Content-Type":"application/json",Accept:"application/json","ws-prefix":r.aD}};return e&&(n.body=JSON.stringify(e)),n}var a=function(e){var t=e.body,n=e.url,r=e.headers;return new Promise((function(e,o){return fetch(n,c(t,r)).then((function(e){return r&&"text/html"===r.Accept?e.text():e.headers&&e.headers.get("Content-Type")&&e.headers.get("Content-Type").indexOf("application/json")>-1?e.json():e})).then((function(t){return t.error?o(t.error):e(t)}))}))};function s(e){return new Promise((function(t){return fetch("/rest/translations/label-translations",c(e)).then((function(e){var n=e.headers.get("content-type");if(n&&-1!==n.indexOf("application/json"))return e.json().then((function(e){if(e.error)throw new Error(e.error);return t(e)}))}))}))}},50840:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(33028),o=n(64454),i={pending:!0,translations:{},error:null};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.b5:return(0,r.Z)((0,r.Z)({},e),{},{pending:!0,translations:t.payload});case o.k_:return(0,r.Z)((0,r.Z)({},e),{},{pending:!1,translations:t.payload});case o.pv:return(0,r.Z)((0,r.Z)({},e),{},{pending:!1,error:t.error});default:return e}}},16843:function(){},80753:function(e,t,n){function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},9249:function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},87371:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(45850);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(0,r.Z)(o.key),o)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},86906:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(95058),o=n(70352),i=n(11987);function c(e){var t=(0,o.Z)();return function(){var n,o=(0,r.Z)(e);if(t){var c=(0,r.Z)(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}},56666:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(45850);function o(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},95058:function(e,t,n){function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},45754:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(88960);function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},70352:function(e,t,n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},81079:function(e,t,n){function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},33028:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(56666);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},11987:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(86522),o=n(80753);function i(e,t){if(t&&("object"===(0,r.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}},68079:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(926);var o=n(81079),i=n(59147);function c(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,o.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},45850:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(86522);function o(e){var t=function(e,t){if("object"!=(0,r.Z)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=(0,r.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,r.Z)(t)?t:String(t)}},86522:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})}}]);
//# sourceMappingURL=552.bundle.js.map