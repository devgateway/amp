package org.dgfoundation.amp.ar.amp212;

import java.util.Arrays;
import java.util.List;

import org.dgfoundation.amp.ar.ArConstants;
import org.dgfoundation.amp.ar.ColumnConstants;
import org.dgfoundation.amp.ar.MeasureConstants;
import org.dgfoundation.amp.newreports.ReportAreaForTests;
import org.dgfoundation.amp.newreports.AmpReportingTestCase;
import org.dgfoundation.amp.newreports.AreaOwner;
import org.dgfoundation.amp.newreports.FilterRule;
import org.dgfoundation.amp.newreports.GroupingCriteria;
import org.dgfoundation.amp.newreports.ReportColumn;
import org.dgfoundation.amp.newreports.ReportElement;
import org.dgfoundation.amp.newreports.ReportFiltersImpl;
import org.dgfoundation.amp.newreports.ReportSpecificationImpl;
import org.dgfoundation.amp.nireports.amp.AmpReportsScratchpad;
import org.dgfoundation.amp.nireports.testcases.NiReportModel;
import org.junit.Test;

/**
 * 
 * testcases for the pledges part of the AMP schema
 * 
 * @author Constantin Dolghier
 *
 */
public class AmpSchemaPledgesTests extends AmpReportingTestCase {

    final List<String> acts = Arrays.asList(
            "activity 1 with agreement",
            "Activity 2 with multiple agreements",
            "Activity Linked With Pledge",
            "Activity with both MTEFs and Act.Comms",
            "activity with capital spending",
            "activity with components",
            "activity with contracting agency",
            "activity with directed MTEFs",
            "activity_with_disaster_response",
            "activity with funded components",
            "activity with incomplete agreement",
            "activity with many MTEFs",
            "activity with pipeline MTEFs and act. disb",
            "Activity with planned disbursements",
            "activity with primary_program",
            "Activity with primary_tertiary_program",
            "activity with tertiary_program",
            "activity-with-unfunded-components",
            "Activity with Zones",
            "Activity With Zones and Percentages",
            "crazy funding 1",
            "date-filters-activity",
            "Eth Water",
            "execution rate activity",
            "mtef activity 1",
            "mtef activity 2",
            "new activity with contracting",
            "pledged 2",
            "pledged education activity 1",
            "Project with documents",
            "Proposed Project Cost 1 - USD",
            "Proposed Project Cost 2 - EUR",
            "ptc activity 1",
            "ptc activity 2",
            "Pure MTEF Project",
            "SSC Project 1",
            "SSC Project 2",
            "SubNational no percentages",
            "TAC_activity_1",
            "TAC_activity_2",
            "Test MTEF directed",
            "third activity with agreements",
            "Unvalidated activity",
            "with weird currencies"
        );
    
    public final static List<String> hierarchiesToTry = Arrays.asList(
            ColumnConstants.RELATED_PROJECTS, ColumnConstants.
            PLEDGES_DONOR_GROUP, ColumnConstants.PLEDGES_DONOR_TYPE, 
            ColumnConstants.PLEDGES_LOCATION_ADM_LEVEL_1, ColumnConstants.PLEDGES_LOCATION_ADM_LEVEL_2, ColumnConstants.PLEDGES_LOCATION_ADM_LEVEL_1,
            ColumnConstants.PLEDGES_AID_MODALITY, ColumnConstants.PLEDGE_STATUS,
            ColumnConstants.PLEDGES_TYPE_OF_ASSISTANCE,
            //ColumnConstants.PLEDGES_TITLES,
            ColumnConstants.PLEDGES_SECTORS, ColumnConstants.PLEDGES_SECONDARY_SECTORS, ColumnConstants.PLEDGES_TERTIARY_SECTORS,
            ColumnConstants.PLEDGES_PROGRAMS, ColumnConstants.PLEDGES_SECONDARY_PROGRAMS, ColumnConstants.PLEDGES_TERTIARY_PROGRAMS
        );

    public final static String correctTotals = "{RAW / Funding / 1998 / Actual Pledge=938069.75219, RAW / Funding / 1998 / Actual Commitments=0, RAW / Funding / 1998 / Actual Disbursements=0, RAW / Funding / 1998 / Commitment Gap=938069.75219, RAW / Funding / 2012 / Actual Pledge=1041111.767105, RAW / Funding / 2012 / Actual Commitments=0, RAW / Funding / 2012 / Actual Disbursements=0, RAW / Funding / 2012 / Commitment Gap=1041111.767105, RAW / Funding / 2013 / Actual Pledge=1800000, RAW / Funding / 2013 / Actual Commitments=2670000, RAW / Funding / 2013 / Actual Disbursements=0, RAW / Funding / 2013 / Commitment Gap=-870000, RAW / Funding / 2014 / Actual Pledge=9186878.10434, RAW / Funding / 2014 / Actual Commitments=3350000, RAW / Funding / 2014 / Actual Disbursements=450000, RAW / Funding / 2014 / Commitment Gap=5836878.10434, RAW / Totals / Actual Pledge=12966059.623635, RAW / Totals / Actual Commitments=6020000, RAW / Totals / Actual Disbursements=450000, RAW / Totals / Commitment Gap=6946059.623635}";
    
    protected ReportSpecificationImpl buildPledgeReport(String reportName, List<String> columns, List<String> measures,
            List<String> hierarchies, GroupingCriteria groupingCriteria) {
        return ReportSpecificationImpl.buildFor(reportName, columns, measures, hierarchies, groupingCriteria, 
                ArConstants.PLEDGES_TYPE);
    }
    
    protected ReportSpecificationImpl buildPledgeReportFilter(String reportName, List<String> columns, List<String> measures, 
            List<String> hierarchies, GroupingCriteria groupingCriteria, ReportElement elem, FilterRule rule) {
        ReportSpecificationImpl spec = ReportSpecificationImpl.buildFor(reportName, columns, measures, hierarchies, groupingCriteria, 
                ArConstants.PLEDGES_TYPE);
        
        ReportFiltersImpl filters = new ReportFiltersImpl();
        filters.addFilterRule(elem, rule);
        spec.setFilters(filters);
        return spec;
    }
    
    @Test
    public void testPlainPledgeReport() {
        NiReportModel cor = new NiReportModel("AMP-16003-flat")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 6))",
                        "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 3));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 5, colSpan: 1))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 1));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 1))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Pledges Titles", "", "Pledge Status", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Totals-Actual Pledge", "12 966 059,62")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledge Status", "second status", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35"),
                        new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledge Status", "", "Totals-Actual Pledge", "938 069,75"),
                        new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Pledge Status", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52"),
                        new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Pledge Status", "default status", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000")      ));

        
        runNiTestCase(spec("AMP-16003-flat"), "en", acts, cor);
    }
    
    @Test
    public void testActualPledgeActualCommitmentsByPrimarySector() {
        NiReportModel cor = new NiReportModel("AMP-17196-by-pledge-primary-sector")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 18))",
                    "(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 3, colSpan: 12));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 15, colSpan: 3))",
                    "(1998: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 3));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 3));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 9, colSpan: 3));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 3))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Sectors", "", "Pledges Titles", "", "Related Projects", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Commitments", "3 350 000", "Funding-2014-Commitment Gap", "5 836 878,1", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Commitments", "6 020 000", "Totals-Commitment Gap", "6 946 059,62")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Pledges Sectors", "112 - BASIC EDUCATION", 6242))
                    .withContents("Pledges Titles", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,44", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,44", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "8 545 407,34", "Funding-2014-Actual Commitments", "3 300 000", "Funding-2014-Commitment Gap", "5 245 407,34", "Totals-Actual Pledge", "10 345 407,77", "Totals-Actual Commitments", "5 970 000", "Totals-Commitment Gap", "4 375 407,77", "Pledges Sectors", "112 - BASIC EDUCATION")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,44", "Funding-2012-Commitment Gap", "0,44", "Funding-2014-Actual Pledge", "345 407,34", "Funding-2014-Commitment Gap", "345 407,34", "Totals-Actual Pledge", "345 407,77", "Totals-Commitment Gap", "345 407,77"),
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "8 200 000", "Funding-2014-Actual Commitments", "3 300 000", "Funding-2014-Commitment Gap", "4 900 000", "Totals-Actual Pledge", "10 000 000", "Totals-Actual Commitments", "5 970 000", "Totals-Commitment Gap", "4 030 000")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Sectors", "113 - SECONDARY EDUCATION", 6246)).withContents("Pledges Titles", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,81", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,81", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "641 470,77", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "641 470,77", "Totals-Actual Pledge", "641 471,58", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "641 471,58", "Pledges Sectors", "113 - SECONDARY EDUCATION")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,81", "Funding-2012-Commitment Gap", "0,81", "Funding-2014-Actual Pledge", "641 470,77", "Funding-2014-Commitment Gap", "641 470,77", "Totals-Actual Pledge", "641 471,58", "Totals-Commitment Gap", "641 471,58")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Sectors", "Pledges Sectors: Undefined", -999999999))
                    .withContents("Pledges Titles", "", "Related Projects", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 110,52", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "1 979 180,27", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "1 929 180,27", "Pledges Sectors", "Pledges Sectors: Undefined")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Related Projects", "Activity Linked With Pledge", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "938 069,75", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "888 069,75"),
                      new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Commitment Gap", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52", "Totals-Commitment Gap", "1 041 110,52")        )      ));

        
        runNiTestCase(spec("AMP-17196-by-pledge-primary-sector"), "en", acts, cor);
    }
    
    @Test
    public void testPledgePrimarySectorPure() {
        NiReportModel cor = new NiReportModel("AMP-17196-by-pledge-primary-sector-pure")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 17))",
                    "(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 12));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 14, colSpan: 3))",
                    "(1998: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 3));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 5, colSpan: 3));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 3));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 3))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Sectors", "", "Pledges Titles", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Commitments", "3 350 000", "Funding-2014-Commitment Gap", "5 836 878,1", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Commitments", "6 020 000", "Totals-Commitment Gap", "6 946 059,62")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Pledges Sectors", "112 - BASIC EDUCATION", 6242))
                    .withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,44", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,44", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "8 545 407,34", "Funding-2014-Actual Commitments", "3 300 000", "Funding-2014-Commitment Gap", "5 245 407,34", "Totals-Actual Pledge", "10 345 407,77", "Totals-Actual Commitments", "5 970 000", "Totals-Commitment Gap", "4 375 407,77", "Pledges Sectors", "112 - BASIC EDUCATION")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,44", "Funding-2012-Commitment Gap", "0,44", "Funding-2014-Actual Pledge", "345 407,34", "Funding-2014-Commitment Gap", "345 407,34", "Totals-Actual Pledge", "345 407,77", "Totals-Commitment Gap", "345 407,77"),
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "8 200 000", "Funding-2014-Actual Commitments", "3 300 000", "Funding-2014-Commitment Gap", "4 900 000", "Totals-Actual Pledge", "10 000 000", "Totals-Actual Commitments", "5 970 000", "Totals-Commitment Gap", "4 030 000")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Sectors", "113 - SECONDARY EDUCATION", 6246)).withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,81", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,81", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "641 470,77", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "641 470,77", "Totals-Actual Pledge", "641 471,58", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "641 471,58", "Pledges Sectors", "113 - SECONDARY EDUCATION")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,81", "Funding-2012-Commitment Gap", "0,81", "Funding-2014-Actual Pledge", "641 470,77", "Funding-2014-Commitment Gap", "641 470,77", "Totals-Actual Pledge", "641 471,58", "Totals-Commitment Gap", "641 471,58")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Sectors", "Pledges Sectors: Undefined", -999999999))
                    .withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 110,52", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "1 979 180,27", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "1 929 180,27", "Pledges Sectors", "Pledges Sectors: Undefined")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "938 069,75", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "888 069,75"),
                      new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Commitment Gap", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52", "Totals-Commitment Gap", "1 041 110,52")        )      ));
        
        runNiTestCase(spec("AMP-17196-by-pledge-primary-sector-pure"), "en", acts, cor);
    }
    
    @Test
    public void testPledgeByRegion() {
        NiReportModel cor = new NiReportModel("AMP-17196-by-regions")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 24))",
                    "(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Tertiary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 12));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 21, colSpan: 3))",
                    "(1998: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 9, colSpan: 3));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 3));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 15, colSpan: 3));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 3))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Administrative Level 1", "", "Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Commitments", "3 350 000", "Funding-2014-Commitment Gap", "5 836 878,1", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Commitments", "6 020 000", "Totals-Commitment Gap", "6 946 059,62")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Anenii Noi County", 9085)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0", "Funding-2013-Actual Pledge", "630 000", "Funding-2013-Actual Commitments", "934 500", "Funding-2013-Commitment Gap", "-304 500", "Funding-2014-Actual Pledge", "2 870 000", "Funding-2014-Actual Commitments", "1 155 000", "Funding-2014-Commitment Gap", "1 715 000", "Totals-Actual Pledge", "3 500 000", "Totals-Actual Commitments", "2 089 500", "Totals-Commitment Gap", "1 410 500", "Pledges Administrative Level 1", "Anenii Noi County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Pledges Sectors", "112 - BASIC EDUCATION", "Pledges Secondary Sectors", "", "Pledges Tertiary Sectors", "", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2013-Actual Pledge", "630 000", "Funding-2013-Actual Commitments", "934 500", "Funding-2013-Commitment Gap", "-304 500", "Funding-2014-Actual Pledge", "2 870 000", "Funding-2014-Actual Commitments", "1 155 000", "Funding-2014-Commitment Gap", "1 715 000", "Totals-Actual Pledge", "3 500 000", "Totals-Actual Commitments", "2 089 500", "Totals-Commitment Gap", "1 410 500")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Balti County", 9086)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,56", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,56", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "444 095,15", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "444 095,15", "Totals-Actual Pledge", "444 095,71", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "444 095,71", "Pledges Administrative Level 1", "Balti County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Funding-2012-Actual Pledge", "0,56", "Funding-2012-Commitment Gap", "0,56", "Funding-2014-Actual Pledge", "444 095,15", "Funding-2014-Commitment Gap", "444 095,15", "Totals-Actual Pledge", "444 095,71", "Totals-Commitment Gap", "444 095,71")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Cahul County", 9087)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,62", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,62", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "493 439,05", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "493 439,05", "Totals-Actual Pledge", "493 439,68", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "493 439,68", "Pledges Administrative Level 1", "Cahul County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Funding-2012-Actual Pledge", "0,62", "Funding-2012-Commitment Gap", "0,62", "Funding-2014-Actual Pledge", "493 439,05", "Funding-2014-Commitment Gap", "493 439,05", "Totals-Actual Pledge", "493 439,68", "Totals-Commitment Gap", "493 439,68")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Lapusna County", 9096)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0", "Funding-2013-Actual Pledge", "1 170 000", "Funding-2013-Actual Commitments", "1 735 500", "Funding-2013-Commitment Gap", "-565 500", "Funding-2014-Actual Pledge", "5 330 000", "Funding-2014-Actual Commitments", "2 145 000", "Funding-2014-Commitment Gap", "3 185 000", "Totals-Actual Pledge", "6 500 000", "Totals-Actual Commitments", "3 880 500", "Totals-Commitment Gap", "2 619 500", "Pledges Administrative Level 1", "Lapusna County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Pledges Sectors", "112 - BASIC EDUCATION", "Pledges Secondary Sectors", "", "Pledges Tertiary Sectors", "", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2013-Actual Pledge", "1 170 000", "Funding-2013-Actual Commitments", "1 735 500", "Funding-2013-Commitment Gap", "-565 500", "Funding-2014-Actual Pledge", "5 330 000", "Funding-2014-Actual Commitments", "2 145 000", "Funding-2014-Commitment Gap", "3 185 000", "Totals-Actual Pledge", "6 500 000", "Totals-Actual Commitments", "3 880 500", "Totals-Commitment Gap", "2 619 500")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Transnistrian Region", 9105)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,06", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,06", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "49 343,91", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "49 343,91", "Totals-Actual Pledge", "49 343,97", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "49 343,97", "Pledges Administrative Level 1", "Transnistrian Region")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Funding-2012-Actual Pledge", "0,06", "Funding-2012-Commitment Gap", "0,06", "Funding-2014-Actual Pledge", "49 343,91", "Funding-2014-Commitment Gap", "49 343,91", "Totals-Actual Pledge", "49 343,97", "Totals-Commitment Gap", "49 343,97")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Pledges Administrative Level 1: Undefined", -8977))
                    .withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Related Projects", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 110,52", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "1 979 180,27", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "1 929 180,27", "Pledges Administrative Level 1", "Pledges Administrative Level 1: Undefined")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledges Sectors", "", "Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Related Projects", "Activity Linked With Pledge", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "938 069,75", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "888 069,75"),
                      new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Pledges Sectors", "", "Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY", "Pledges Tertiary Sectors", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Commitment Gap", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52", "Totals-Commitment Gap", "1 041 110,52")        )      ));

        runNiTestCase(spec("AMP-17196-by-regions"), "en", acts, cor);
    }

    @Test
    public void testPledgeBySecSector() {
        NiReportModel cor = new NiReportModel("AMP-17196-by-sec-sector")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 24))",
                    "(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges Tertiary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 12));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 21, colSpan: 3))",
                    "(1998: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 9, colSpan: 3));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 3));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 15, colSpan: 3));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 3))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Commitment Gap: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Secondary Sectors", "", "Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Related Projects", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Commitments", "3 350 000", "Funding-2014-Commitment Gap", "5 836 878,1", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Commitments", "6 020 000", "Totals-Commitment Gap", "6 946 059,62")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY", 6475))
                    .withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Related Projects", "", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "1 041 110,52", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "1 979 180,27", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "1 929 180,27", "Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledges Sectors", "", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Related Projects", "Activity Linked With Pledge", "Funding-1998-Actual Pledge", "938 069,75", "Funding-1998-Commitment Gap", "938 069,75", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Commitment Gap", "-50 000", "Totals-Actual Pledge", "938 069,75", "Totals-Actual Commitments", "50 000", "Totals-Commitment Gap", "888 069,75"),
                      new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Pledges Sectors", "", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2012-Commitment Gap", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52", "Totals-Commitment Gap", "1 041 110,52")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS", 6481)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,69", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,69", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "542 782,96", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "542 782,96", "Totals-Actual Pledge", "542 783,64", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "542 783,64", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Funding-2012-Actual Pledge", "0,69", "Funding-2012-Commitment Gap", "0,69", "Funding-2014-Actual Pledge", "542 782,96", "Funding-2014-Commitment Gap", "542 782,96", "Totals-Actual Pledge", "542 783,64", "Totals-Commitment Gap", "542 783,64")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Secondary Sectors", "5 REGIONAL DEVELOPMENT", 6492)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0,56", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0,56", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Commitment Gap", "0", "Funding-2014-Actual Pledge", "444 095,15", "Funding-2014-Actual Commitments", "0", "Funding-2014-Commitment Gap", "444 095,15", "Totals-Actual Pledge", "444 095,71", "Totals-Actual Commitments", "0", "Totals-Commitment Gap", "444 095,71", "Pledges Secondary Sectors", "5 REGIONAL DEVELOPMENT")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Programs", "Subprogram p1.b", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Funding-2012-Actual Pledge", "0,56", "Funding-2012-Commitment Gap", "0,56", "Funding-2014-Actual Pledge", "444 095,15", "Funding-2014-Commitment Gap", "444 095,15", "Totals-Actual Pledge", "444 095,71", "Totals-Commitment Gap", "444 095,71")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Secondary Sectors", "Pledges Secondary Sectors: Undefined", -999999999)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Secondary Programs", "", "Pledges Programs", "", "Pledges National Plan Objectives", "", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "", "Related Projects", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-1998-Commitment Gap", "0", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Commitment Gap", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "8 200 000", "Funding-2014-Actual Commitments", "3 300 000", "Funding-2014-Commitment Gap", "4 900 000", "Totals-Actual Pledge", "10 000 000", "Totals-Actual Commitments", "5 970 000", "Totals-Commitment Gap", "4 030 000", "Pledges Secondary Sectors", "Pledges Secondary Sectors: Undefined")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Pledges Sectors", "112 - BASIC EDUCATION", "Pledges Tertiary Sectors", "", "Pledges Administrative Level 1", "Anenii Noi County, Lapusna County", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Commitment Gap", "-870 000", "Funding-2014-Actual Pledge", "8 200 000", "Funding-2014-Actual Commitments", "3 300 000", "Funding-2014-Commitment Gap", "4 900 000", "Totals-Actual Pledge", "10 000 000", "Totals-Actual Commitments", "5 970 000", "Totals-Commitment Gap", "4 030 000")        )      ));

        runNiTestCase(spec("AMP-17196-by-sec-sector"), "en", acts, cor);
    }

    @Test
    public void testActualPledgeByPledgeStatus() {
        NiReportModel cor = new NiReportModel("AMP-16003-by-pledge-status")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 6))",
                        "(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 3));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 5, colSpan: 1))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 1));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 1))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Pledge Status", "", "Pledges Titles", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Totals-Actual Pledge", "12 966 059,62")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Pledge Status", "default status", 2117)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000", "Pledge Status", "default status")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000")        ),
                        new ReportAreaForTests(new AreaOwner("Pledge Status", "second status", 2118)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "1,25", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35", "Pledge Status", "second status")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35")        ),
                        new ReportAreaForTests(new AreaOwner("Pledge Status", "Pledge Status: Undefined", -999999999))
                        .withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "0", "Totals-Actual Pledge", "1 979 180,27", "Pledge Status", "Pledge Status: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Totals-Actual Pledge", "938 069,75"),
                          new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52")        )      ));
        
        runNiTestCase(spec("AMP-16003-by-pledge-status"), "en", acts, cor);
    }
    
    @Test
    public void testActualPledgeDetailDatesAndContacts() {
        NiReportModel cor = new NiReportModel("AMP-21336-pledge-details-contacts")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 16))",
                        "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Detail Date Range: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Detail End Date: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Detail Start Date: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledge Contact 1 - Address: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledge Contact 1 - Alternate Contact: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledge Contact 1 - Email: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledge Contact 1 - Ministry: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Pledge Contact 1 - Name: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Pledge Contact 1 - Telephone: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 9, colSpan: 1));(Pledge Contact 1 - Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 10, colSpan: 1));(Pledge Contact 2 - Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 11, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 3));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 15, colSpan: 1))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 1));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 13, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 1))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Pledges Titles", "", "Pledges Detail Date Range", "", "Pledges Detail End Date", "", "Pledges Detail Start Date", "", "Pledge Contact 1 - Address", "", "Pledge Contact 1 - Alternate Contact", "", "Pledge Contact 1 - Email", "", "Pledge Contact 1 - Ministry", "", "Pledge Contact 1 - Name", "", "Pledge Contact 1 - Telephone", "", "Pledge Contact 1 - Title", "", "Pledge Contact 2 - Title", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Totals-Actual Pledge", "12 966 059,62")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Detail Date Range", "2012-06-06 - 2014-04-04, 2014-04-01 - 2014-04-16, 2014-04-18 - 2014-04-24", "Pledges Detail End Date", "04/04/2014, 16/04/2014, 24/04/2014", "Pledges Detail Start Date", "06/06/2012, 01/04/2014, 18/04/2014", "Pledge Contact 1 - Address", "Some Contact Address", "Pledge Contact 1 - Alternate Contact", "Alternative Guy first contact", "Pledge Contact 1 - Email", "contact@amp.org", "Pledge Contact 1 - Ministry", "Ministry of Pledge affairs", "Pledge Contact 1 - Name", "A Contact name", "Pledge Contact 1 - Telephone", "8976535", "Pledge Contact 1 - Title", "Dr", "Pledge Contact 2 - Title", "alternate contact title", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35"),
                        new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledge Contact 1 - Address", "", "Pledge Contact 1 - Alternate Contact", "", "Pledge Contact 1 - Email", "virvan@gmail.com", "Pledge Contact 1 - Ministry", "Ministry of Pledges", "Pledge Contact 1 - Name", "Vanessa Goas", "Pledge Contact 1 - Telephone", "", "Pledge Contact 1 - Title", "Dr", "Pledge Contact 2 - Title", "", "Totals-Actual Pledge", "938 069,75"),
                        new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Pledges Detail Date Range", "2012-03-02 - 2015-03-03", "Pledges Detail End Date", "03/03/2015", "Pledges Detail Start Date", "02/03/2012", "Pledge Contact 1 - Address", "", "Pledge Contact 1 - Alternate Contact", "", "Pledge Contact 1 - Email", "", "Pledge Contact 1 - Ministry", "", "Pledge Contact 1 - Name", "", "Pledge Contact 1 - Telephone", "", "Pledge Contact 1 - Title", "", "Pledge Contact 2 - Title", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52"),
                        new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Pledges Detail Date Range", "2013-02-01 - 2014-04-29, 2014-04-08 - 2015-02-11", "Pledges Detail End Date", "29/04/2014, 11/02/2015", "Pledges Detail Start Date", "01/02/2013, 08/04/2014", "Pledge Contact 1 - Address", "", "Pledge Contact 1 - Alternate Contact", "", "Pledge Contact 1 - Email", "", "Pledge Contact 1 - Ministry", "", "Pledge Contact 1 - Name", "", "Pledge Contact 1 - Telephone", "", "Pledge Contact 1 - Title", "", "Pledge Contact 2 - Title", "", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000")      ));
        
        runNiTestCase(spec("AMP-21336-pledge-details-contacts"), "en", acts, cor);
    }
    
    @Test
    public void testActualPledgeByAidModality() {
        // current result not matches old reports -> to re-check once actual pledge sum by hierarchy is fixed
        NiReportModel cor = new NiReportModel("AMP-17153-aid-modality-hier")
        .withHeaders(Arrays.asList(
                "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 7))",
                "(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 3, colSpan: 3));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 6, colSpan: 1))",
                "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 1));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 5, colSpan: 1))",
                "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1))"))
            .withWarnings(Arrays.asList())
            .withBody(      new ReportAreaForTests(null)
              .withContents("Pledges Aid Modality", "", "Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Totals-Actual Pledge", "12 966 059,62")
              .withChildren(
                new ReportAreaForTests(new AreaOwner("Pledges Aid Modality", "Conferences, seminars, capacity specializations", 2099))
                .withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "0", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "9 138 069,75", "Pledges Aid Modality", "Conferences, seminars, capacity specializations")
                .withChildren(
                  new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Related Projects", "Activity Linked With Pledge", "Totals-Actual Pledge", "938 069,75"),
                  new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "8 200 000")        ),
                new ReportAreaForTests(new AreaOwner("Pledges Aid Modality", "Development of shared analytical studies", 2107)).withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "1,25", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "0", "Totals-Actual Pledge", "1,25", "Pledges Aid Modality", "Development of shared analytical studies")
                .withChildren(
                  new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "1,25", "Totals-Actual Pledge", "1,25")        ),
                new ReportAreaForTests(new AreaOwner("Pledges Aid Modality", "Diplomats and courses", 2098)).withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "0", "Totals-Actual Pledge", "1 041 110,52", "Pledges Aid Modality", "Diplomats and courses")
                .withChildren(
                  new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52")        ),
                new ReportAreaForTests(new AreaOwner("Pledges Aid Modality", "Interchanging models, proposals, and printed materials", 2100)).withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "0", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "219 202,1", "Totals-Actual Pledge", "219 202,1", "Pledges Aid Modality", "Interchanging models, proposals, and printed materials")
                .withChildren(
                  new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2014-Actual Pledge", "219 202,1", "Totals-Actual Pledge", "219 202,1")        ),
                new ReportAreaForTests(new AreaOwner("Pledges Aid Modality", "Sending and exchanging experts, researchers, and professors", 2106)).withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "0", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "767 676", "Totals-Actual Pledge", "767 676", "Pledges Aid Modality", "Sending and exchanging experts, researchers, and professors")
                .withChildren(
                  new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2014-Actual Pledge", "767 676", "Totals-Actual Pledge", "767 676")        ),
                new ReportAreaForTests(new AreaOwner("Pledges Aid Modality", "Pledges Aid Modality: Undefined", -999999999)).withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "0", "Totals-Actual Pledge", "1 800 000", "Pledges Aid Modality", "Pledges Aid Modality: Undefined")
                .withChildren(
                  new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2013-Actual Pledge", "1 800 000", "Totals-Actual Pledge", "1 800 000")        )      ));
        
        runNiTestCase(spec("AMP-17153-aid-modality-hier"), "en", acts, cor);
    }
    
    @Test
    public void testActualPledgeActualCommitmentsByRegions() {
        NiReportModel cor = new NiReportModel("Actual Pledge and Actual Commitments By Regions")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 12))",
                    "(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 8));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 10, colSpan: 2))",
                    "(1998: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Administrative Level 1", "", "Pledges Titles", "", "Funding-1998-Actual Pledge", "938,069,75", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "1,041,111,77", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "1,800,000", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Pledge", "9,186,878,1", "Funding-2014-Actual Commitments", "3,350,000", "Totals-Actual Pledge", "12,966,059,62", "Totals-Actual Commitments", "6,020,000")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Anenii Noi County", 9085)).withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "630,000", "Funding-2013-Actual Commitments", "934,500", "Funding-2014-Actual Pledge", "2,870,000", "Funding-2014-Actual Commitments", "1,155,000", "Totals-Actual Pledge", "3,500,000", "Totals-Actual Commitments", "2,089,500", "Pledges Administrative Level 1", "Anenii Noi County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Pledge", "630,000", "Funding-2013-Actual Commitments", "934,500", "Funding-2014-Actual Pledge", "2,870,000", "Funding-2014-Actual Commitments", "1,155,000", "Totals-Actual Pledge", "3,500,000", "Totals-Actual Commitments", "2,089,500")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Balti County", 9086)).withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "0,56", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "444,095,15", "Funding-2014-Actual Commitments", "0", "Totals-Actual Pledge", "444,095,71", "Totals-Actual Commitments", "0", "Pledges Administrative Level 1", "Balti County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,56", "Funding-2014-Actual Pledge", "444,095,15", "Totals-Actual Pledge", "444,095,71")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Cahul County", 9087)).withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "0,62", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "493,439,05", "Funding-2014-Actual Commitments", "0", "Totals-Actual Pledge", "493,439,68", "Totals-Actual Commitments", "0", "Pledges Administrative Level 1", "Cahul County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,62", "Funding-2014-Actual Pledge", "493,439,05", "Totals-Actual Pledge", "493,439,68")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Lapusna County", 9096)).withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "1,170,000", "Funding-2013-Actual Commitments", "1,735,500", "Funding-2014-Actual Pledge", "5,330,000", "Funding-2014-Actual Commitments", "2,145,000", "Totals-Actual Pledge", "6,500,000", "Totals-Actual Commitments", "3,880,500", "Pledges Administrative Level 1", "Lapusna County")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Pledge", "1,170,000", "Funding-2013-Actual Commitments", "1,735,500", "Funding-2014-Actual Pledge", "5,330,000", "Funding-2014-Actual Commitments", "2,145,000", "Totals-Actual Pledge", "6,500,000", "Totals-Actual Commitments", "3,880,500")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Transnistrian Region", 9105)).withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "0,06", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "49,343,91", "Funding-2014-Actual Commitments", "0", "Totals-Actual Pledge", "49,343,97", "Totals-Actual Commitments", "0", "Pledges Administrative Level 1", "Transnistrian Region")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "0,06", "Funding-2014-Actual Pledge", "49,343,91", "Totals-Actual Pledge", "49,343,97")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Administrative Level 1", "Pledges Administrative Level 1: Undefined", -8977))
                    .withContents("Pledges Titles", "", "Funding-1998-Actual Pledge", "938,069,75", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "1,041,110,52", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Pledge", "1,979,180,27", "Totals-Actual Commitments", "50,000", "Pledges Administrative Level 1", "Pledges Administrative Level 1: Undefined")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Funding-1998-Actual Pledge", "938,069,75", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Pledge", "938,069,75", "Totals-Actual Commitments", "50,000"),
                      new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1,041,110,52", "Totals-Actual Pledge", "1,041,110,52")        )      ));
        
        ReportSpecificationImpl spec = buildPledgeReport("Actual Pledge and Actual Commitments By Regions", 
                Arrays.asList(ColumnConstants.PLEDGES_LOCATION_ADM_LEVEL_1, ColumnConstants.PLEDGES_TITLES),
                Arrays.asList(MeasureConstants.PLEDGES_ACTUAL_PLEDGE, MeasureConstants.PLEDGES_ACTUAL_COMMITMENTS),
                Arrays.asList(ColumnConstants.PLEDGES_LOCATION_ADM_LEVEL_1), GroupingCriteria.GROUPING_YEARLY);
        
        runNiTestCase(spec, "en", acts, cor);
    }

    @Test
    public void testByDonorGroup() {
        NiReportModel cor = new NiReportModel("By Donor Group")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 14))",
                    "(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 8));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 12, colSpan: 2))",
                    "(1998: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Donor Group", "", "Pledges Titles", "", "Pledges Sectors", "", "Pledges Programs", "", "Funding-1998-Actual Pledge", "938,069,75", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "1,041,111,77", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "1,800,000", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Pledge", "9,186,878,1", "Funding-2014-Actual Commitments", "3,350,000", "Totals-Actual Pledge", "12,966,059,62", "Totals-Actual Commitments", "6,020,000")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Pledges Donor Group", "American", 19)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Programs", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "1,800,000", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Pledge", "8,200,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Pledge", "10,000,000", "Totals-Actual Commitments", "5,970,000", "Pledges Donor Group", "American")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Pledges Sectors", "112 - BASIC EDUCATION", "Funding-2013-Actual Pledge", "1,800,000", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Pledge", "8,200,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Pledge", "10,000,000", "Totals-Actual Commitments", "5,970,000")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Donor Group", "Default Group", 17))
                    .withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Programs", "", "Funding-1998-Actual Pledge", "938,069,75", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "1,041,110,52", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Pledge", "1,979,180,27", "Totals-Actual Commitments", "50,000", "Pledges Donor Group", "Default Group")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledges Sectors", "", "Pledges Programs", "Subprogram p1.b", "Funding-1998-Actual Pledge", "938,069,75", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Pledge", "938,069,75", "Totals-Actual Commitments", "50,000"),
                      new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Pledges Sectors", "", "Funding-2012-Actual Pledge", "1,041,110,52", "Totals-Actual Pledge", "1,041,110,52")        ),
                    new ReportAreaForTests(new AreaOwner("Pledges Donor Group", "European", 18)).withContents("Pledges Titles", "", "Pledges Sectors", "", "Pledges Programs", "", "Funding-1998-Actual Pledge", "0", "Funding-1998-Actual Commitments", "0", "Funding-2012-Actual Pledge", "1,25", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "986,878,1", "Funding-2014-Actual Commitments", "0", "Totals-Actual Pledge", "986,879,35", "Totals-Actual Commitments", "0", "Pledges Donor Group", "European")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Programs", "Subprogram p1.b", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986,878,1", "Totals-Actual Pledge", "986,879,35")        )      ));
        
        ReportSpecificationImpl spec = buildPledgeReport("By Donor Group", 
                Arrays.asList(ColumnConstants.PLEDGES_DONOR_GROUP, ColumnConstants.PLEDGES_TITLES, ColumnConstants.PLEDGES_SECTORS, ColumnConstants.PLEDGES_PROGRAMS), 
                Arrays.asList(MeasureConstants.PLEDGES_ACTUAL_PLEDGE, MeasureConstants.PLEDGES_ACTUAL_COMMITMENTS),
                Arrays.asList(ColumnConstants.PLEDGES_DONOR_GROUP), GroupingCriteria.GROUPING_YEARLY);
        
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testByRelatedProject() {
        NiReportModel cor = new NiReportModel("AMP-22686-Related-Projects-Hierarchy-AC-AP")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 10))",
                        "(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 6));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 8, colSpan: 2))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Related Projects", "", "Pledges Titles", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Commitments", "3 350 000", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Commitments", "6 020 000")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Related Projects", "Activity Linked With Pledge", 41)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Pledge", "0", "Totals-Actual Commitments", "50 000", "Related Projects", "Activity Linked With Pledge")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000")        ),
                        new ReportAreaForTests(new AreaOwner("Related Projects", "pledged 2", 48)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "0", "Totals-Actual Pledge", "0", "Totals-Actual Commitments", "2 670 000", "Related Projects", "pledged 2")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Commitments", "2 670 000", "Totals-Actual Commitments", "2 670 000")        ),
                        new ReportAreaForTests(new AreaOwner("Related Projects", "pledged education activity 1", 46)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "0", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "0", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "0", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Pledge", "0", "Totals-Actual Commitments", "3 300 000", "Related Projects", "pledged education activity 1")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "3 300 000")        ),
                        new ReportAreaForTests(new AreaOwner("Related Projects", "Related Projects: Undefined", -999999999))
                        .withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Commitments", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Commitments", "0", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Commitments", "0", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Commitments", "0", "Related Projects", "Related Projects: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35"),
                          new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Totals-Actual Pledge", "938 069,75"),
                          new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52"),
                          new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000")        )      ));;
        
        runNiTestCase(spec("AMP-22686-Related-Projects-Hierarchy-AC-AP"), "en", acts, cor);
    }
    
    @Test
    public void testFilterByDonorGroup() {
        NiReportModel cor = new NiReportModel("AMP-22686 Filter by Donor Group")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 6))",
                        "(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 3));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 5, colSpan: 1))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 1));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 1))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Pledges Donor Group", "", "Pledges Titles", "", "Funding-2012-Actual Pledge", "1,25", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "9 186 878,1", "Totals-Actual Pledge", "10 986 879,35")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Pledges Donor Group", "American", 19)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000", "Pledges Donor Group", "American")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Actual Pledge", "10 000 000")        ),
                        new ReportAreaForTests(new AreaOwner("Pledges Donor Group", "European", 18)).withContents("Pledges Titles", "", "Funding-2012-Actual Pledge", "1,25", "Funding-2013-Actual Pledge", "0", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35", "Pledges Donor Group", "European")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35")        )      ));
        runNiTestCase(spec("AMP-22686 Filter by Donor Group"), "en", acts, cor);
    }
    
    @Test
    public void testFilterByAidModality() {
        NiReportModel cor = new NiReportModel("Filter Pledges by Aid Modality")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 6))",
                        "(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 2));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 4, colSpan: 2))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 2))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null).withContents("Pledges Aid Modality", "", "Pledges Titles", "", "Funding-2012-Actual Pledge", "1,25", "Funding-2012-Actual Commitments", "0", "Totals-Actual Pledge", "1,25", "Totals-Actual Commitments", "0")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner(3), "Pledges Aid Modality", "Development of shared analytical studies", "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "1,25", "Totals-Actual Pledge", "1,25")      ));
        
        ReportSpecificationImpl spec = buildPledgeReportFilter("Filter Pledges by Aid Modality", 
              Arrays.asList(ColumnConstants.PLEDGES_AID_MODALITY, ColumnConstants.PLEDGES_TITLES), 
              Arrays.asList(MeasureConstants.PLEDGES_ACTUAL_PLEDGE, MeasureConstants.PLEDGES_ACTUAL_COMMITMENTS),
              null, GroupingCriteria.GROUPING_YEARLY,
              new ReportElement(new ReportColumn(ColumnConstants.PLEDGES_AID_MODALITY)), 
              new FilterRule("2107", true)); // "Development of shared analytical studies"
      
      runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testPledgesActualDisbursements() {
        NiReportModel cor = new NiReportModel("AMP-22686-pledges-actual-disbursements")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 10))",
                        "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 6));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 8, colSpan: 2))",
                        "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2))",
                        "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Pledges Titles", "", "Related Projects", "", "Funding-2012-Actual Pledge", "1 041 111,77", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Pledge", "9 186 878,1", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Pledge", "12 966 059,62", "Totals-Actual Disbursements", "450 000")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35"),
                        new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Related Projects", "Activity Linked With Pledge", "Totals-Actual Pledge", "938 069,75"),
                        new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52"),
                        new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2013-Actual Pledge", "1 800 000", "Funding-2014-Actual Pledge", "8 200 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Pledge", "10 000 000", "Totals-Actual Disbursements", "450 000")      ));
        
        runNiTestCase(spec("AMP-22686-pledges-actual-disbursements"), "en", acts, cor);
    }
    
    @Test
    public void testPledgesPlannedAmounts() {
        NiReportModel cor = new NiReportModel("AMP-22686-planned-pledge-amounts")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 8))",
                        "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 3));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 5, colSpan: 3))",
                        "(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 3))",
                        "(Planned Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Planned Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Planned Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Planned Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Pledges Titles", "", "Related Projects", "", "Funding-2014-Planned Commitments", "65 000 000", "Funding-2014-Planned Disbursements", "0", "Funding-2014-Actual Pledge", "9 186 878,1", "Totals-Planned Commitments", "65 000 000", "Totals-Planned Disbursements", "0", "Totals-Actual Pledge", "12 966 059,62")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35"),
                        new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Related Projects", "Activity Linked With Pledge", "Totals-Actual Pledge", "938 069,75"),
                        new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Totals-Actual Pledge", "1 041 110,52"),
                        new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2014-Planned Commitments", "65 000 000", "Funding-2014-Actual Pledge", "8 200 000", "Totals-Planned Commitments", "65 000 000", "Totals-Actual Pledge", "10 000 000")      ));
        
        runNiTestCase(spec("AMP-22686-planned-pledge-amounts"), "en", acts, cor);
    }
    
    @Test
    public void testPledgeMergingFlat() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-flat")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 26))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 20, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 22, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 25, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 111,77", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 972 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2014-Actual Commitments", "13 996 691,87", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "26 354 750,81", "Totals-Actual Disbursements", "3 206 802")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Administrative Level 1", "Dubasari County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                        new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Administrative Level 1", "Falesti County", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                        new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Administrative Level 1", "Drochia County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "143 777", "Totals-Actual Disbursements", "143 777"),
                        new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Administrative Level 1", "Cahul County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "545 000", "Totals-Actual Disbursements", "545 000"),
                        new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                        new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", ""),
                        new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                        new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                        new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                        new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Administrative Level 1", "Edinet County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                        new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                        new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "570 000", "Totals-Actual Commitments", "570 000"),
                        new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "890 000", "Totals-Actual Commitments", "890 000"),
                        new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "75 000", "Totals-Actual Commitments", "75 000"),
                        new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                        new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                        new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                        new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                        new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                        new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Administrative Level 1", "Cahul County", "Primary Sector", "113 - SECONDARY EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                        new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                        new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County, Transnistrian Region", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2014-Actual Disbursements", "50 000", "Totals-Actual Commitments", "96 840,58", "Totals-Actual Disbursements", "50 000"),
                        new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                        new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Administrative Level 1", "Transnistrian Region", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321"),
                        new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                        new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                        new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                        new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                        new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                        new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                        new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Administrative Level 1", "", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                        new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County, Drochia County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                        new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                        new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY, 4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                        new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                        new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Administrative Level 1", "Chisinau City, Dubasari County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                        new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Administrative Level 1", "Drochia County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                        new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98"),
                        new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "1,25", "Funding-2014-Actual Commitments", "986 878,1", "Totals-Actual Commitments", "986 879,35"),
                        new ReportAreaForTests(new AreaOwner(800000004), "Project Title", "ACVL Pledge Name 2", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "-50 000", "Totals-Actual Commitments", "888 069,75"),
                        new ReportAreaForTests(new AreaOwner(800000005), "Project Title", "free text name 2", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2012-Actual Commitments", "1 041 110,52", "Totals-Actual Commitments", "1 041 110,52"),
                        new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Administrative Level 1", "Anenii Noi County, Lapusna County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name, OP2 name", "Funding-2013-Actual Commitments", "-870 000", "Funding-2014-Actual Commitments", "4 900 000", "Totals-Actual Commitments", "4 030 000")      ));

        
        runNiTestCase(spec("pledges-test-merging-flat"), "en", acts, cor);
    }

    @Test
    public void testPledgeMergingByPrimaryProgram() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-primary-program")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 26))",
                        "(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 20, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 22, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 25, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Primary Program Level 1", "", "Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 111,77", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 972 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2014-Actual Commitments", "13 996 691,87", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "26 354 750,81", "Totals-Actual Disbursements", "3 206 802")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1", 2))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "27 533,53", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Commitments", "1 074 389,66", "Funding-2015-Actual Disbursements", "115 000", "Totals-Actual Commitments", "1 101 923,2", "Totals-Actual Disbursements", "170 000", "Primary Program Level 1", "Subprogram p1")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "25 000", "Totals-Actual Commitments", "25 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County, Drochia County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY, 4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Administrative Level 1", "Chisinau City, Dubasari County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Administrative Level 1", "Drochia County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "2 433,53", "Funding-2015-Actual Commitments", "62 933,66", "Totals-Actual Commitments", "65 367,2")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1.b", 3))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1,25", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Commitments", "996 076,71", "Funding-2014-Actual Disbursements", "75 000", "Funding-2015-Actual Commitments", "147 997,18", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "2 082 144,89", "Totals-Actual Disbursements", "110 000", "Primary Program Level 1", "Subprogram p1.b")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "25 000", "Totals-Actual Commitments", "25 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "1 198,61", "Funding-2015-Actual Commitments", "30 997,18", "Totals-Actual Commitments", "32 195,78"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "1,25", "Funding-2014-Actual Commitments", "986 878,1", "Totals-Actual Commitments", "986 879,35"),
                          new ReportAreaForTests(new AreaOwner(800000004), "Project Title", "ACVL Pledge Name 2", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "-50 000", "Totals-Actual Commitments", "888 069,75")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Primary Program Level 1: Undefined", -1))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 110,52", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 972 086", "Funding-2013-Actual Disbursements", "1 231 956", "Funding-2014-Actual Commitments", "12 973 081,63", "Funding-2014-Actual Disbursements", "580 200", "Funding-2015-Actual Commitments", "749 445", "Funding-2015-Actual Disbursements", "322 335", "Totals-Actual Commitments", "23 170 682,73", "Totals-Actual Disbursements", "2 926 802", "Primary Program Level 1", "Primary Program Level 1: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Administrative Level 1", "Dubasari County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Administrative Level 1", "Falesti County", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "143 777", "Totals-Actual Disbursements", "143 777"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "545 000", "Totals-Actual Disbursements", "545 000"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Administrative Level 1", "Edinet County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "570 000", "Totals-Actual Commitments", "570 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "890 000", "Totals-Actual Commitments", "890 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "75 000", "Totals-Actual Commitments", "75 000"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Administrative Level 1", "Cahul County", "Primary Sector", "113 - SECONDARY EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County, Transnistrian Region", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2014-Actual Disbursements", "50 000", "Totals-Actual Commitments", "96 840,58", "Totals-Actual Disbursements", "50 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Administrative Level 1", "Transnistrian Region", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Administrative Level 1", "", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(800000005), "Project Title", "free text name 2", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2012-Actual Commitments", "1 041 110,52", "Totals-Actual Commitments", "1 041 110,52"),
                          new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Administrative Level 1", "Anenii Noi County, Lapusna County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name, OP2 name", "Funding-2013-Actual Commitments", "-870 000", "Funding-2014-Actual Commitments", "4 900 000", "Totals-Actual Commitments", "4 030 000")        )      ));
        
        runNiTestCase(spec("pledges-test-merging-by-primary-program"), "en", acts, cor);
    }

    @Test
    public void testPledgeMergingByPrimarySector() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-primary-sector-2")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 26))",
                        "(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 20, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 22, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 25, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Primary Sector", "", "Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 111,77", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 972 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2014-Actual Commitments", "13 996 691,87", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "26 354 750,81", "Totals-Actual Disbursements", "3 206 802")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Primary Sector", "110 - EDUCATION", 6236))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "58 104,35", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "203 777", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "3 981 665", "Funding-2013-Actual Disbursements", "1 135 111", "Funding-2014-Actual Commitments", "3 734 250,55", "Funding-2014-Actual Disbursements", "240 000", "Funding-2015-Actual Commitments", "1 332 044,26", "Funding-2015-Actual Disbursements", "275 882,5", "Totals-Actual Commitments", "9 231 064,16", "Totals-Actual Disbursements", "1 866 770,5", "Primary Sector", "110 - EDUCATION")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Administrative Level 1", "Anenii Noi County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "143 777", "Totals-Actual Disbursements", "143 777"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Administrative Level 1", "Anenii Noi County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "545 000", "Totals-Actual Disbursements", "545 000"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Administrative Level 1", "Anenii Noi County", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Administrative Level 1", "Anenii Noi County", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Administrative Level 1", "Anenii Noi County", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Administrative Level 1", "Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Administrative Level 1", "Anenii Noi County, Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "570 000", "Totals-Actual Commitments", "570 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "267 000", "Totals-Actual Commitments", "267 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "75 000", "Totals-Actual Commitments", "75 000"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Administrative Level 1", "Chisinau City", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Administrative Level 1", "Chisinau County", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Administrative Level 1", "Chisinau County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County, Transnistrian Region", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "58 104,35", "Funding-2014-Actual Disbursements", "30 000", "Totals-Actual Commitments", "58 104,35", "Totals-Actual Disbursements", "30 000"),
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Administrative Level 1", "Transnistrian Region", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Administrative Level 1", "", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Administrative Level 1", "Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "228 394,5", "Funding-2015-Actual Disbursements", "160 882,5", "Totals-Actual Commitments", "228 394,5", "Totals-Actual Disbursements", "160 882,5"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Administrative Level 1", "Chisinau County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Administrative Level 1", "Chisinau City", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County, Drochia County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "532 800", "Totals-Actual Commitments", "532 800"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Administrative Level 1", "", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "19 800", "Funding-2015-Actual Commitments", "70 200", "Totals-Actual Commitments", "90 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Administrative Level 1", "Chisinau City", "Secondary Sector", "1-DEMOCRATIC COUNTRY, 4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Administrative Level 1", "Chisinau County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Administrative Level 1", "Chisinau City, Dubasari County", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Administrative Level 1", "Drochia County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "3 268,92", "Funding-2015-Actual Commitments", "84 537,76", "Totals-Actual Commitments", "87 806,68")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Sector", "112 - BASIC EDUCATION", 6242))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "9 684,06", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,44", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "-302 579", "Funding-2013-Actual Disbursements", "131 845", "Funding-2014-Actual Commitments", "5 245 770,55", "Funding-2014-Actual Disbursements", "5 200", "Funding-2015-Actual Commitments", "592 987,58", "Funding-2015-Actual Disbursements", "161 452,5", "Totals-Actual Commitments", "5 759 094,63", "Totals-Actual Disbursements", "421 818,5", "Primary Sector", "112 - BASIC EDUCATION")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Administrative Level 1", "Dubasari County", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Administrative Level 1", "Edinet County", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County, Transnistrian Region", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "9 684,06", "Funding-2014-Actual Disbursements", "5 000", "Totals-Actual Commitments", "9 684,06", "Totals-Actual Disbursements", "5 000"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Administrative Level 1", "Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "228 394,5", "Funding-2015-Actual Disbursements", "160 882,5", "Totals-Actual Commitments", "228 394,5", "Totals-Actual Disbursements", "160 882,5"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County, Drochia County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "355 200", "Totals-Actual Commitments", "355 200"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "363,21", "Funding-2015-Actual Commitments", "9 393,08", "Totals-Actual Commitments", "9 756,3"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,44", "Funding-2014-Actual Commitments", "345 407,34", "Totals-Actual Commitments", "345 407,77"),
                          new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Administrative Level 1", "Anenii Noi County, Lapusna County", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name, OP2 name", "Funding-2013-Actual Commitments", "-870 000", "Funding-2014-Actual Commitments", "4 900 000", "Totals-Actual Commitments", "4 030 000")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Sector", "113 - SECONDARY EDUCATION", 6246))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,81", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "5 054 670,77", "Funding-2014-Actual Disbursements", "450 000", "Funding-2015-Actual Commitments", "46 800", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "7 771 471,58", "Totals-Actual Disbursements", "450 000", "Primary Sector", "113 - SECONDARY EDUCATION")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Administrative Level 1", "Cahul County", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Administrative Level 1", "", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "13 200", "Funding-2015-Actual Commitments", "46 800", "Totals-Actual Commitments", "60 000"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,81", "Funding-2014-Actual Commitments", "641 470,77", "Totals-Actual Commitments", "641 471,58")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Sector", "120 - HEALTH", 6252))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "29 052,17", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "623 000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "15 000", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "652 052,17", "Totals-Actual Disbursements", "15 000", "Primary Sector", "120 - HEALTH")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "623 000", "Totals-Actual Commitments", "623 000"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County, Transnistrian Region", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "29 052,17", "Funding-2014-Actual Disbursements", "15 000", "Totals-Actual Commitments", "29 052,17", "Totals-Actual Disbursements", "15 000")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", 6267)).withContents("Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Administrative Level 1", "Falesti County", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Sector", "Primary Sector: Undefined", -999999999))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 041 110,52", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "-38 000", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "1 941 180,27", "Totals-Actual Disbursements", "0", "Primary Sector", "Primary Sector: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Administrative Level 1", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(800000004), "Project Title", "ACVL Pledge Name 2", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "-50 000", "Totals-Actual Commitments", "888 069,75"),
                          new ReportAreaForTests(new AreaOwner(800000005), "Project Title", "free text name 2", "Administrative Level 1", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2012-Actual Commitments", "1 041 110,52", "Totals-Actual Commitments", "1 041 110,52")        )      ));

        
        runNiTestCase(spec("pledges-test-merging-by-primary-sector-2"), "en", acts, cor);
    }

    @Test
    public void testPledgeMergingByRegion() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-region")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 26))",
                        "(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 20, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 22, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 25, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Administrative Level 1", "", "Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 111,77", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 972 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2014-Actual Commitments", "13 996 691,87", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "26 354 750,81", "Totals-Actual Disbursements", "3 206 802")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Anenii Noi County", 9085))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "143 777", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "1 269 832", "Funding-2013-Actual Disbursements", "1 100 111", "Funding-2014-Actual Commitments", "1 752 500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "3 022 332", "Totals-Actual Disbursements", "1 243 888", "Administrative Level 1", "Anenii Noi County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "143 777", "Totals-Actual Disbursements", "143 777"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "545 000", "Totals-Actual Disbursements", "545 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "178 000", "Totals-Actual Commitments", "178 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name, OP2 name", "Funding-2013-Actual Commitments", "-304 500", "Funding-2014-Actual Commitments", "1 715 000", "Totals-Actual Commitments", "1 410 500")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Balti County", 9086))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,56", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "1 330 333", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "481 595,15", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "723 189", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "2 588 380,03", "Totals-Actual Disbursements", "349 265", "Administrative Level 1", "Balti County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "266 400", "Totals-Actual Commitments", "266 400"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,56", "Funding-2014-Actual Commitments", "444 095,15", "Totals-Actual Commitments", "444 095,71")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Cahul County", 9087))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,62", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "4 893 439,05", "Funding-2014-Actual Disbursements", "450 000", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "7 563 439,68", "Totals-Actual Disbursements", "450 000", "Administrative Level 1", "Cahul County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Primary Sector", "113 - SECONDARY EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,62", "Funding-2014-Actual Commitments", "493 439,05", "Totals-Actual Commitments", "493 439,68")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Chisinau City", 9088))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "50 000", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "246 912", "Funding-2015-Actual Disbursements", "17 500", "Totals-Actual Commitments", "296 912", "Totals-Actual Disbursements", "45 000", "Administrative Level 1", "Chisinau City")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY, 4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Disbursements", "17 500", "Totals-Actual Disbursements", "45 000")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Chisinau County", 9089))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Commitments", "3 365 760,63", "Funding-2014-Actual Disbursements", "155 000", "Funding-2015-Actual Commitments", "1 200", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "5 066 960,63", "Totals-Actual Disbursements", "190 000", "Administrative Level 1", "Chisinau County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Drochia County", 9090))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "621 600", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Commitments", "621 600", "Totals-Actual Disbursements", "80 000", "Administrative Level 1", "Drochia County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "621 600", "Totals-Actual Commitments", "621 600"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Dubasari County", 9091))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "17 500", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "168 321", "Administrative Level 1", "Dubasari County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Disbursements", "17 500", "Totals-Actual Disbursements", "45 000")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Edinet County", 9092)).withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845", "Administrative Level 1", "Edinet County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Falesti County", 9093)).withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213", "Administrative Level 1", "Falesti County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Lapusna County", 9096)).withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "-565 500", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "3 185 000", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "2 619 500", "Totals-Actual Disbursements", "0", "Administrative Level 1", "Lapusna County")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name, OP2 name", "Funding-2013-Actual Commitments", "-565 500", "Funding-2014-Actual Commitments", "3 185 000", "Totals-Actual Commitments", "2 619 500")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Transnistrian Region", 9105))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,06", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "172 664,91", "Funding-2014-Actual Disbursements", "22 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "216 243,23", "Totals-Actual Disbursements", "22 500", "Administrative Level 1", "Transnistrian Region")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2014-Actual Disbursements", "22 500", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500"),
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,06", "Funding-2014-Actual Commitments", "49 343,91", "Totals-Actual Commitments", "49 343,97")        ),
                        new ReportAreaForTests(new AreaOwner("Administrative Level 1", "Administrative Level 1: Undefined", -8977))
                        .withContents("Project Title", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "60 000", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 110,52", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "95 732,14", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Commitments", "378 930,84", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Commitments", "2 578 843,25", "Totals-Actual Disbursements", "72 770", "Administrative Level 1", "Administrative Level 1: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98"),
                          new ReportAreaForTests(new AreaOwner(800000004), "Project Title", "ACVL Pledge Name 2", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "-50 000", "Totals-Actual Commitments", "888 069,75"),
                          new ReportAreaForTests(new AreaOwner(800000005), "Project Title", "free text name 2", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2012-Actual Commitments", "1 041 110,52", "Totals-Actual Commitments", "1 041 110,52")        )      ));
        
        runNiTestCase(spec("pledges-test-merging-by-region"), "en", acts, cor);
    }

    @Test
    public void testPledgeMergingByTertiaryProgram() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-tertiary-program")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 26))",
                        "(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 20, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 22, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 25, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Tertiary Program Level 1", "", "Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 111,77", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 972 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2014-Actual Commitments", "13 996 691,87", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "26 354 750,81", "Totals-Actual Disbursements", "3 206 802")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Tertiary Program Level 1", "OP1 name", 5))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1,25", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "-348 000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "2 994 978,1", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Commitments", "1 128 456", "Funding-2015-Actual Disbursements", "115 000", "Totals-Actual Commitments", "4 713 505,11", "Totals-Actual Disbursements", "170 000", "Tertiary Program Level 1", "OP1 name")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County, Drochia County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY, 4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Administrative Level 1", "Chisinau City, Dubasari County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Administrative Level 1", "Drochia County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1", "Secondary Program Level 1", "", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Funding-2012-Actual Commitments", "1,25", "Funding-2014-Actual Commitments", "986 878,1", "Totals-Actual Commitments", "986 879,35"),
                          new ReportAreaForTests(new AreaOwner(800000004), "Project Title", "ACVL Pledge Name 2", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "-50 000", "Totals-Actual Commitments", "888 069,75"),
                          new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Administrative Level 1", "Anenii Noi County, Lapusna County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "-348 000", "Funding-2014-Actual Commitments", "1 960 000", "Totals-Actual Commitments", "1 612 000")        ),
                        new ReportAreaForTests(new AreaOwner("Tertiary Program Level 1", "OP2 name", 9))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "-522 000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "2 940 000", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "2 418 000", "Totals-Actual Disbursements", "0", "Tertiary Program Level 1", "OP2 name")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(800000006), "Project Title", "Heavily used pledge", "Administrative Level 1", "Anenii Noi County, Lapusna County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "-522 000", "Funding-2014-Actual Commitments", "2 940 000", "Totals-Actual Commitments", "2 418 000")        ),
                        new ReportAreaForTests(new AreaOwner("Tertiary Program Level 1", "Tertiary Program Level 1: Undefined", -999999999))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "1 066 110,52", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "7 842 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2014-Actual Commitments", "8 061 713,77", "Funding-2014-Actual Disbursements", "655 200", "Funding-2015-Actual Commitments", "843 375,84", "Funding-2015-Actual Disbursements", "322 335", "Totals-Actual Commitments", "19 223 245,7", "Totals-Actual Disbursements", "3 036 802", "Tertiary Program Level 1", "Tertiary Program Level 1: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Administrative Level 1", "Dubasari County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Administrative Level 1", "Falesti County", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2010-Actual Disbursements", "143 777", "Totals-Actual Disbursements", "143 777"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Disbursements", "545 000", "Totals-Actual Disbursements", "545 000"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Administrative Level 1", "Anenii Noi County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "02 TRANSDNISTRIAN CONFLICT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Administrative Level 1", "Edinet County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "570 000", "Totals-Actual Commitments", "570 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "890 000", "Totals-Actual Commitments", "890 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Administrative Level 1", "Anenii Noi County, Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "75 000", "Totals-Actual Commitments", "75 000"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Administrative Level 1", "Cahul County", "Primary Sector", "113 - SECONDARY EDUCATION", "Secondary Sector", "4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County, Transnistrian Region", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2014-Actual Disbursements", "50 000", "Totals-Actual Commitments", "96 840,58", "Totals-Actual Disbursements", "50 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Administrative Level 1", "Transnistrian Region", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Administrative Level 1", "", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Administrative Level 1", "Chisinau County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1.b", "Secondary Program Level 1", "", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "Subprogram p1, Subprogram p1.b", "Secondary Program Level 1", "", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98"),
                          new ReportAreaForTests(new AreaOwner(800000005), "Project Title", "free text name 2", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Primary Program Level 1", "", "Secondary Program Level 1", "", "Funding-2012-Actual Commitments", "1 041 110,52", "Totals-Actual Commitments", "1 041 110,52")        )      ));
        
        runNiTestCase(spec("pledges-test-merging-by-tertiary-program"), "en", acts, cor);
    }

    @Test
    public void testFilterMergedPledgesBySecondarySector() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-primary-program-filter-by-secondary-sector")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 12));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Primary Program Level 1", "", "Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,69", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Funding-2014-Actual Commitments", "575 782,96", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Commitments", "117 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Commitments", "1 473 435,64", "Totals-Actual Disbursements", "345 166")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1", 2)).withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Commitments", "0", "Totals-Actual Disbursements", "90 000", "Primary Program Level 1", "Subprogram p1")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Administrative Level 1", "Chisinau City, Dubasari County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1.b", 3))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,69", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "575 782,96", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "117 000", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "692 783,64", "Totals-Actual Disbursements", "0", "Primary Program Level 1", "Subprogram p1.b")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,69", "Funding-2014-Actual Commitments", "542 782,96", "Totals-Actual Commitments", "542 783,64")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Primary Program Level 1: Undefined", -999999999))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "780 652", "Totals-Actual Disbursements", "255 166", "Primary Program Level 1", "Primary Program Level 1: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Administrative Level 1", "Dubasari County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Administrative Level 1", "Edinet County", "Primary Sector", "112 - BASIC EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845")        )      ));

        
        runNiTestCase(spec("pledges-test-merging-by-primary-program-filter-by-secondary-sector"), "en", acts, cor);
    }
    
    @Test
    public void testFilterMergedPledgesByPrimaryProgram() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-primary-program-filtered-by-primary-program")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 14))",
                    "(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 4));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 12, colSpan: 2))",
                    "(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2))",
                    "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null).withContents("Primary Program Level 1", "", "Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "27 533,53", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Commitments", "1 074 389,66", "Funding-2015-Actual Disbursements", "115 000", "Totals-Actual Commitments", "1 101 923,2", "Totals-Actual Disbursements", "170 000")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1", 2))
                    .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "27 533,53", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Commitments", "1 074 389,66", "Funding-2015-Actual Disbursements", "115 000", "Totals-Actual Commitments", "1 101 923,2", "Totals-Actual Disbursements", "170 000", "Primary Program Level 1", "Subprogram p1")
                    .withChildren(
                      new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "25 000", "Totals-Actual Commitments", "25 000"),
                      new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                            new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County, Drochia County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                      new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Administrative Level 1", "Chisinau City", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY, 4 HUMAN RESOURCES", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                      new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Administrative Level 1", "Chisinau City, Dubasari County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                      new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Administrative Level 1", "Drochia County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                      new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Administrative Level 1", "", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "2 433,53", "Funding-2015-Actual Commitments", "62 933,66", "Totals-Actual Commitments", "65 367,2")        )      ));


        
        runNiTestCase(spec("pledges-test-merging-by-primary-program-filtered-by-primary-program"), "en", acts, cor);
    }
    
    @Test
    public void testFilterMergedPledgesByRegion() {
        NiReportModel cor = new NiReportModel("pledges-test-merging-by-primary-program-filtered-by-region")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 20))",
                        "(Primary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Primary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Secondary Sector: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(National Planning Objectives Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Secondary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Tertiary Program Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 8, colSpan: 10));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 18, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Primary Program Level 1", "", "Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,56", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "1 330 333", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "481 595,15", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "723 189", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "2 588 380,03", "Totals-Actual Disbursements", "349 265")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1", 2)).withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "266 400", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "266 400", "Totals-Actual Disbursements", "0", "Primary Program Level 1", "Subprogram p1")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2015-Actual Commitments", "266 400", "Totals-Actual Commitments", "266 400")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Subprogram p1.b", 3)).withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0,56", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "444 095,15", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "444 095,71", "Totals-Actual Disbursements", "0", "Primary Program Level 1", "Subprogram p1.b")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(800000003), "Project Title", "Test pledge 1", "Administrative Level 1", "Balti County", "Primary Sector", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Secondary Sector", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "OP1 name", "Funding-2012-Actual Commitments", "0,56", "Funding-2014-Actual Commitments", "444 095,15", "Totals-Actual Commitments", "444 095,71")        ),
                        new ReportAreaForTests(new AreaOwner("Primary Program Level 1", "Primary Program Level 1: Undefined", -999999999))
                        .withContents("Project Title", "", "Administrative Level 1", "", "Primary Sector", "", "Secondary Sector", "", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "1 330 333", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "37 500", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "1 877 884,32", "Totals-Actual Disbursements", "349 265", "Primary Program Level 1", "Primary Program Level 1: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Secondary Sector", "5 REGIONAL DEVELOPMENT", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Administrative Level 1", "Balti County", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Secondary Sector", "1-DEMOCRATIC COUNTRY", "National Planning Objectives Level 1", "", "Secondary Program Level 1", "", "Tertiary Program Level 1", "", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765")        )      ));
        
        runNiTestCase(spec("pledges-test-merging-by-primary-program-filtered-by-region"), "en", acts, cor);
    }

    @Test
    public void testPledgeFilterByRegion() {
        NiReportModel cor = new NiReportModel("pledge-test-filters-location-transnistria")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 15))",
                    "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Administrative Level 3: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 9, colSpan: 1));(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 10, colSpan: 1));(Pledges Tertiary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 11, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 14, colSpan: 1))",
                    "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 13, colSpan: 1))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null).withContents("Pledges Titles", "", "Pledges Aid Modality", "", "Pledges Administrative Level 3", "", "Pledges Donor Group", "", "Pledges National Plan Objectives", "", "Pledge Status", "", "Pledges Sectors", "", "Pledges Programs", "", "Pledges Administrative Level 1", "", "Pledges Secondary Programs", "", "Pledges Secondary Sectors", "", "Pledges Tertiary Programs", "", "Funding-2012-Actual Pledge", "0,06", "Funding-2014-Actual Pledge", "49 343,91", "Totals-Actual Pledge", "49 343,97")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Aid Modality", "Development of shared analytical studies, Interchanging models, proposals, and printed materials, Sending and exchanging experts, researchers, and professors", "Pledges Administrative Level 3", "", "Pledges Donor Group", "European", "Pledge Status", "second status", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Programs", "Subprogram p1.b", "Pledges Administrative Level 1", "Transnistrian Region", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Tertiary Programs", "OP1 name", "Funding-2012-Actual Pledge", "0,06", "Funding-2014-Actual Pledge", "49 343,91", "Totals-Actual Pledge", "49 343,97")      ));

        
        runNiTestCase(spec("pledge-test-filters-location-transnistria"), "en", acts, cor);
    }

    @Test
    public void testPledgeFilterByPrimaryProgram() {
        NiReportModel cor = new NiReportModel("pledge-test-filters-prim-program-p1b")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 15))",
                    "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Administrative Level 3: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 9, colSpan: 1));(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 10, colSpan: 1));(Pledges Tertiary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 11, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 14, colSpan: 1))",
                    "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 13, colSpan: 1))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Titles", "", "Pledges Aid Modality", "", "Pledges Administrative Level 3", "", "Pledges Donor Group", "", "Pledges National Plan Objectives", "", "Pledge Status", "", "Pledges Sectors", "", "Pledges Programs", "", "Pledges Administrative Level 1", "", "Pledges Secondary Programs", "", "Pledges Secondary Sectors", "", "Pledges Tertiary Programs", "", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "1 924 949,11")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Aid Modality", "Development of shared analytical studies, Interchanging models, proposals, and printed materials, Sending and exchanging experts, researchers, and professors", "Pledges Administrative Level 3", "", "Pledges Donor Group", "European", "Pledge Status", "second status", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Programs", "Subprogram p1.b", "Pledges Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Tertiary Programs", "OP1 name", "Funding-2012-Actual Pledge", "1,25", "Funding-2014-Actual Pledge", "986 878,1", "Totals-Actual Pledge", "986 879,35"),
                    new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledges Aid Modality", "Conferences, seminars, capacity specializations", "Pledges Administrative Level 3", "", "Pledges Donor Group", "Default Group", "Pledge Status", "", "Pledges Sectors", "", "Pledges Programs", "Subprogram p1.b", "Pledges Administrative Level 1", "", "Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY", "Pledges Tertiary Programs", "OP1 name", "Totals-Actual Pledge", "938 069,75")      ));

        
        runNiTestCase(spec("pledge-test-filters-prim-program-p1b"), "en", acts, cor);
    }

    @Test
    public void testPledgeFilterByPrimarySector() {
        NiReportModel cor = new NiReportModel("pledge-test-filters-prim-sector")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 15))",
                    "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Administrative Level 3: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 9, colSpan: 1));(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 10, colSpan: 1));(Pledges Tertiary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 11, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 14, colSpan: 1))",
                    "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 1));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 13, colSpan: 1))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null).withContents("Pledges Titles", "", "Pledges Aid Modality", "", "Pledges Administrative Level 3", "", "Pledges Donor Group", "", "Pledges National Plan Objectives", "", "Pledge Status", "", "Pledges Sectors", "", "Pledges Programs", "", "Pledges Administrative Level 1", "", "Pledges Secondary Programs", "", "Pledges Secondary Sectors", "", "Pledges Tertiary Programs", "", "Funding-2012-Actual Pledge", "0,81", "Funding-2014-Actual Pledge", "641 470,77", "Totals-Actual Pledge", "641 471,58")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Aid Modality", "Development of shared analytical studies, Interchanging models, proposals, and printed materials, Sending and exchanging experts, researchers, and professors", "Pledges Administrative Level 3", "", "Pledges Donor Group", "European", "Pledge Status", "second status", "Pledges Sectors", "113 - SECONDARY EDUCATION", "Pledges Programs", "Subprogram p1.b", "Pledges Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Tertiary Programs", "OP1 name", "Funding-2012-Actual Pledge", "0,81", "Funding-2014-Actual Pledge", "641 470,77", "Totals-Actual Pledge", "641 471,58")      ));
        
        runNiTestCase(spec("pledge-test-filters-prim-sector"), "en", acts, cor);
    }

    @Test
    public void testPledgeFilterBySecondarySector() {
        NiReportModel cor = new NiReportModel("pledge-test-filters-secondary-sector")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 14))",
                    "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Administrative Level 3: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 9, colSpan: 1));(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 10, colSpan: 1));(Pledges Tertiary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 11, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 1));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 13, colSpan: 1))",
                    "(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 1))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                  .withContents("Pledges Titles", "", "Pledges Aid Modality", "", "Pledges Administrative Level 3", "", "Pledges Donor Group", "", "Pledges National Plan Objectives", "", "Pledge Status", "", "Pledges Sectors", "", "Pledges Programs", "", "Pledges Administrative Level 1", "", "Pledges Secondary Programs", "", "Pledges Secondary Sectors", "", "Pledges Tertiary Programs", "", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 979 180,27")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Pledges Aid Modality", "Conferences, seminars, capacity specializations", "Pledges Administrative Level 3", "", "Pledges Donor Group", "Default Group", "Pledge Status", "", "Pledges Sectors", "", "Pledges Programs", "Subprogram p1.b", "Pledges Administrative Level 1", "", "Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY", "Pledges Tertiary Programs", "OP1 name", "Totals-Actual Pledge", "938 069,75"),
                    new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2", "Pledges Aid Modality", "Diplomats and courses", "Pledges Administrative Level 3", "", "Pledges Donor Group", "Default Group", "Pledge Status", "", "Pledges Sectors", "", "Pledges Administrative Level 1", "", "Pledges Secondary Sectors", "1-DEMOCRATIC COUNTRY", "Funding-2012-Actual Pledge", "1 041 110,52", "Totals-Actual Pledge", "1 041 110,52")      ));

        
        runNiTestCase(spec("pledge-test-filters-secondary-sector"), "en", acts, cor);
    }


    @Test
    public void testPledgeFilterByTypeOfAssistance() {
        NiReportModel cor = new NiReportModel("pledge-test-filters-type-of-assistance")
            .withHeaders(Arrays.asList(
                    "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 16))",
                    "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Pledges Aid Modality: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Pledges Administrative Level 3: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Pledges Donor Group: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Pledges National Plan Objectives: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 4, colSpan: 1));(Pledge Status: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 5, colSpan: 1));(Pledges Tertiary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 6, colSpan: 1));(Pledges Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 7, colSpan: 1));(Pledges Type Of Assistance: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 8, colSpan: 1));(Pledges Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 9, colSpan: 1));(Pledges Administrative Level 1: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 10, colSpan: 1));(Pledges Secondary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 11, colSpan: 1));(Pledges Secondary Sectors: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 12, colSpan: 1));(Pledges Tertiary Programs: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 13, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 14, colSpan: 1));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 15, colSpan: 1))",
                    "(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 1))",
                    "(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Pledge: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null).withContents("Pledges Titles", "", "Pledges Aid Modality", "", "Pledges Administrative Level 3", "", "Pledges Donor Group", "", "Pledges National Plan Objectives", "", "Pledge Status", "", "Pledges Tertiary Sectors", "", "Pledges Sectors", "", "Pledges Type Of Assistance", "", "Pledges Programs", "", "Pledges Administrative Level 1", "", "Pledges Secondary Programs", "", "Pledges Secondary Sectors", "", "Pledges Tertiary Programs", "", "Funding-2014-Actual Pledge", "219 202,1", "Totals-Actual Pledge", "219 202,1")
                  .withChildren(
                    new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1", "Pledges Aid Modality", "Development of shared analytical studies, Interchanging models, proposals, and printed materials, Sending and exchanging experts, researchers, and professors", "Pledges Administrative Level 3", "", "Pledges Donor Group", "European", "Pledge Status", "second status", "Pledges Tertiary Sectors", "", "Pledges Sectors", "112 - BASIC EDUCATION, 113 - SECONDARY EDUCATION", "Pledges Type Of Assistance", "second type of assistance", "Pledges Programs", "Subprogram p1.b", "Pledges Administrative Level 1", "Balti County, Cahul County, Transnistrian Region", "Pledges Secondary Sectors", "3 NATIONAL COMPETITIVENESS, 5 REGIONAL DEVELOPMENT", "Pledges Tertiary Programs", "OP1 name", "Funding-2014-Actual Pledge", "219 202,1", "Totals-Actual Pledge", "219 202,1")      ));
        
        runNiTestCase(spec("pledge-test-filters-type-of-assistance"), "en", acts, cor);
    }
    
    @Test
    public void test_NOT_IMPLEMENTED_YET_PledgesPercentageOfDisbursement() {
        NiReportModel cor = new NiReportModel("AMP-22686-Pledge-Percentage-of-Disbursement")
        .withHeaders(Arrays.asList(
                "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 5))",
                "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Related Projects: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 1));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 3, colSpan: 2))",
                "(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 2, colSpan: 1))",
                "(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Percentage of Disbursement: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1))"))
            .withWarnings(Arrays.asList())
            .withBody(      new ReportAreaForTests(null)
              .withContents("Pledges Titles", "", "Related Projects", "", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Disbursements", "450 000", "Totals-Percentage of Disbursement", "100")
              .withChildren(
                new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1"),
                new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Related Projects", "Activity Linked With Pledge"),
                new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2"),
                new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Related Projects", "pledged 2, pledged education activity 1", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Disbursements", "450 000", "Totals-Percentage of Disbursement", "100")      ));
     
        runNiTestCase(spec("AMP-22686-Pledge-Percentage-of-Disbursement"), "en", acts, cor);
    }
    
    @Test
    public void testHierarchiesDoNotChangeTotals() throws Exception {
        List<String> measures = Arrays.asList(MeasureConstants.PLEDGES_ACTUAL_PLEDGE, MeasureConstants.ACTUAL_COMMITMENTS, MeasureConstants.ACTUAL_DISBURSEMENTS, MeasureConstants.PLEDGES_COMMITMENT_GAP);
        
        ReportSpecificationImpl initSpec = buildPledgeReport("initSpec", 
            Arrays.asList(ColumnConstants.PROJECT_TITLE), 
            measures, 
            null, 
            GroupingCriteria.GROUPING_YEARLY);
                
        assertEquals(correctTotals, buildDigest(initSpec, acts, BasicSanityChecks.fundingGrandTotalsDigester).toString());
                
        // single-hierarchy reports
        for(boolean isSummary:Arrays.asList(true, false)) {
            for(String hierName:hierarchiesToTry) {
                ReportSpecificationImpl spec = buildPledgeReport(String.format("%s summary: %b", hierName, isSummary), 
                    Arrays.asList(ColumnConstants.PROJECT_TITLE, hierName), 
                    measures, 
                    Arrays.asList(hierName), 
                    GroupingCriteria.GROUPING_YEARLY);
                spec.setSummaryReport(isSummary);
                assertEquals(spec.getReportName(), correctTotals, buildDigest(spec, acts, BasicSanityChecks.fundingGrandTotalsDigester).toString());
            }
        }
    }

    public void testSimpleReportWithoutUnlinkedFunding() {
        try {
            AmpReportsScratchpad.displayUnlinkedFundingInPledgesReports = false;

            NiReportModel cor = new NiReportModel("Pledge Report Without Unlinked Funding")
                    .withHeaders(Arrays.asList(
                            "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 7))",
                            "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 1, colSpan: 4));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 5, colSpan: 2))",
                            "(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 1, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 2))",
                            "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 1, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(new ReportAreaForTests(null)
                            .withContents("Pledges Titles", "", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "3,350,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "6,020,000", "Totals-Actual Disbursements", "450,000")
                            .withChildren(
                                    new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1"),
                                    new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                    new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2"),
                                    new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "3,300,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "5,970,000", "Totals-Actual Disbursements", "450,000")      ));

            ReportSpecificationImpl spec = buildPledgeReport("Pledge Report Without Unlinked Funding",
                    Arrays.asList(ColumnConstants.PLEDGES_TITLES),
                    Arrays.asList(MeasureConstants.PLEDGES_ACTUAL_COMMITMENTS, MeasureConstants.PLEDGES_ACTUAL_DISBURSEMENTS),
                    null,
                    GroupingCriteria.GROUPING_YEARLY);

            runNiTestCase(spec, "en", acts, cor);
        } finally {
            AmpReportsScratchpad.displayUnlinkedFundingInPledgesReports = null;
        }
    }

    public void testSimpleReportWithUnlinkedFunding() {
        try {
            AmpReportsScratchpad.displayUnlinkedFundingInPledgesReports = true;

            NiReportModel cor = new NiReportModel("Pledge Report With Unlinked Funding")
                    .withHeaders(Arrays.asList(
                            "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 23))",
                            "(Pledges Titles: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 1, colSpan: 20));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 21, colSpan: 2))",
                            "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 1, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 5, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 7, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 9, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 13, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 15, colSpan: 2));(2016: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 17, colSpan: 2));(2017: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 19, colSpan: 2))",
                            "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 1, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 22, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                            .withContents("Pledges Titles", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "780,311", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "49,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "9,389,375", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,729,313,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "2,450,376,95", "Funding-2015-Actual Disbursements", "437,335", "Funding-2016-Actual Commitments", "2,284,254", "Funding-2016-Actual Disbursements", "253,700", "Funding-2017-Actual Commitments", "407", "Funding-2017-Actual Disbursements", "0", "Totals-Actual Commitments", "25,092,997,29", "Totals-Actual Disbursements", "3,460,502")
                            .withChildren(
                                    new ReportAreaForTests(new AreaOwner(3), "Pledges Titles", "Test pledge 1"),
                                    new ReportAreaForTests(new AreaOwner(4), "Pledges Titles", "ACVL Pledge Name 2", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                    new ReportAreaForTests(new AreaOwner(5), "Pledges Titles", "free text name 2"),
                                    new ReportAreaForTests(new AreaOwner(6), "Pledges Titles", "Heavily used pledge", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "3,300,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "5,970,000", "Totals-Actual Disbursements", "450,000"),
                                    new ReportAreaForTests(new AreaOwner(999999999), "Pledges Titles", "Unallocated Transations", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Commitments", "780,311", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2012-Actual Commitments", "49,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "6,719,375", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "5,379,313,77", "Funding-2014-Actual Disbursements", "260,200", "Funding-2015-Actual Commitments", "2,450,376,95", "Funding-2015-Actual Disbursements", "437,335", "Funding-2016-Actual Commitments", "2,284,254", "Funding-2016-Actual Disbursements", "253,700", "Funding-2017-Actual Commitments", "407", "Totals-Actual Commitments", "19,072,997,29", "Totals-Actual Disbursements", "3,010,502")      ));

            ReportSpecificationImpl spec = buildPledgeReport("Pledge Report With Unlinked Funding",
                    Arrays.asList(ColumnConstants.PLEDGES_TITLES),
                    Arrays.asList(MeasureConstants.PLEDGES_ACTUAL_COMMITMENTS, MeasureConstants.PLEDGES_ACTUAL_DISBURSEMENTS),
                    null,
                    GroupingCriteria.GROUPING_YEARLY);

            runNiTestCase(spec, "en", acts, cor);
        } finally {
            AmpReportsScratchpad.displayUnlinkedFundingInPledgesReports = null;
        }
    }
}
