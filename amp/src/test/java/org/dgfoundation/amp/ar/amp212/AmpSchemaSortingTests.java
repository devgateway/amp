package org.dgfoundation.amp.ar.amp212;

import java.util.Arrays;
import java.util.List;

import org.dgfoundation.amp.test.categories.DatabaseTests;
import org.dgfoundation.amp.StandaloneAMPInitializer;
import org.dgfoundation.amp.ar.ColumnConstants;
import org.dgfoundation.amp.ar.MeasureConstants;
import org.dgfoundation.amp.newreports.ReportAreaForTests;
import org.dgfoundation.amp.newreports.AreaOwner;
import org.dgfoundation.amp.newreports.GroupingCriteria;
import org.dgfoundation.amp.newreports.ReportColumn;
import org.dgfoundation.amp.newreports.ReportSpecificationImpl;
import org.dgfoundation.amp.newreports.SortingInfo;
import org.dgfoundation.amp.nireports.output.NiReportExecutor;
import org.dgfoundation.amp.nireports.testcases.NiReportModel;
import org.junit.BeforeClass;
import org.junit.Test;
import org.junit.experimental.categories.Category;

/**
 * 
 * testcases for the fetching states of AMP + the AMP schema
 * 
 * @author Constantin Dolghier
 *
 */
@Category(DatabaseTests.class)
public class AmpSchemaSortingTests extends SortingSanityChecks {

    @Override
    protected NiReportExecutor getNiExecutor(List<String> activityNames) {
        return getDbExecutor(activityNames);
    }

    @BeforeClass
    public static void setUp() {
        StandaloneAMPInitializer.initialize();
    }

    @Test
    public void testSortingByPPC() {
        NiReportModel cor = new NiReportModel("sort by ppc")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 3, colStart: 0, colSpan: 5))",
                        "(Project Title: (startRow: 1, rowSpan: 2, totalRowSpan: 2, colStart: 0, colSpan: 1));(Proposed Project Amount: (startRow: 1, rowSpan: 2, totalRowSpan: 2, colStart: 1, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 2, totalRowSpan: 2, colStart: 2, colSpan: 1));(Totals: (startRow: 1, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 2))",
                        "(Actual Commitments: (startRow: 2, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(Actual Disbursements: (startRow: 2, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Proposed Project Amount", "4,781,901,72", "Donor Agency", "", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Donor Agency", "World Bank", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Donor Agency", "Water Foundation", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Donor Agency", "Ministry of Economy, USAID", "Totals-Actual Disbursements", "143,777"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Donor Agency", "Ministry of Economy, Ministry of Finance"),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Donor Agency", "USAID"),
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Donor Agency", "Finland, Norway, USAID", "Totals-Actual Disbursements", "545,000"),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Donor Agency", "UNDP"),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Donor Agency", "Ministry of Finance", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Donor Agency", "Finland", "Totals-Actual Commitments", "666,777"),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Donor Agency", "USAID", "Totals-Actual Commitments", "333,222"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Donor Agency", "Finland", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Donor Agency", "Water Org", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Donor Agency", "Finland", "Totals-Actual Commitments", "333,333"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Donor Agency", "Finland", "Totals-Actual Commitments", "570,000"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Donor Agency", "Norway", "Totals-Actual Commitments", "890,000"),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Donor Agency", "USAID", "Totals-Actual Commitments", "5,000,000"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Donor Agency", "Finland, USAID", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Donor Agency", "Finland", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "96,840,58", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Donor Agency", "Finland", "Totals-Actual Commitments", "12,000"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Donor Agency", "Finland, Ministry of Economy", "Totals-Actual Commitments", "123,321"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Donor Agency", "UNDP, Water Foundation, World Bank", "Totals-Actual Commitments", "100"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Donor Agency", "UNDP", "Totals-Actual Commitments", "45,000"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Donor Agency", "Finland", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Totals-Actual Commitments", "1,200"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Donor Agency", "Finland", "Totals-Actual Commitments", "123,000"),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Donor Agency", "Norway, USAID", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "888,000"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "150,000"),
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Donor Agency", "Ministry of Economy", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Donor Agency", "Norway, UNDP", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Donor Agency", "Ministry of Finance, UNDP", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Donor Agency", "Finland, Norway, USAID", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Donor Agency", "Finland, Ministry of Finance, Norway", "Totals-Actual Commitments", "97,562,98"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Proposed Project Amount", "35,000", "Donor Agency", "World Bank", "Totals-Actual Commitments", "32,000"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Proposed Project Amount", "60,000", "Donor Agency", "Ministry of Economy", "Totals-Actual Commitments", "75,000"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Proposed Project Amount", "66,392,25", "Donor Agency", "UNDP", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Proposed Project Amount", "70,000", "Donor Agency", "Ministry of Economy", "Totals-Actual Commitments", "15,000"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Proposed Project Amount", "150,999", "Donor Agency", "Finland", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Proposed Project Amount", "1,000,000", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Proposed Project Amount", "3,399,510,47", "Donor Agency", "Ministry of Economy")      ));
        
        ReportSpecificationImpl spec = buildSpecification("sort by ppc", 
                Arrays.asList(ColumnConstants.PROJECT_TITLE, ColumnConstants.PROPOSED_PROJECT_AMOUNT, ColumnConstants.DONOR_AGENCY), 
                Arrays.asList(MeasureConstants.ACTUAL_COMMITMENTS, MeasureConstants.ACTUAL_DISBURSEMENTS),
                null, 
                GroupingCriteria.GROUPING_TOTALS_ONLY);
        
        spec.addSorter(new SortingInfo(new ReportColumn(ColumnConstants.PROPOSED_PROJECT_AMOUNT), true));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingByDirectedMtef() {
        NiReportModel cor = new NiReportModel("sort by directed MTEF")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 8))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Real MTEF 2011: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 1, colSpan: 2));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Totals: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 4))",
                        "(Actual Commitments: (startRow: 2, rowSpan: 2, totalRowSpan: 2, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 2, rowSpan: 2, totalRowSpan: 2, colStart: 5, colSpan: 1));(Real MTEF: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2))",
                        "(EXEC-BENF: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 1, colSpan: 1));(IMPL-EXEC: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(EXEC-BENF: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(IMPL-EXEC: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "50,000", "Real MTEF 2011-IMPL-EXEC", "110,500", "Donor Agency", "", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802", "Totals-Real MTEF-EXEC-BENF", "50,000", "Totals-Real MTEF-IMPL-EXEC", "110,500")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Real MTEF 2011-EXEC-BENF", "50,000", "Real MTEF 2011-IMPL-EXEC", "110,500", "Donor Agency", "Ministry of Economy", "Totals-Actual Commitments", "123,456", "Totals-Real MTEF-EXEC-BENF", "50,000", "Totals-Real MTEF-IMPL-EXEC", "110,500"),
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Donor Agency", "World Bank", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Donor Agency", "Water Foundation", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Donor Agency", "Ministry of Economy"),
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Donor Agency", "Ministry of Economy, USAID", "Totals-Actual Disbursements", "143,777"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Donor Agency", "Ministry of Economy, Ministry of Finance"),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Donor Agency", "USAID"),
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Donor Agency", "Finland, Norway, USAID", "Totals-Actual Disbursements", "545,000"),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Donor Agency", "UNDP"),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Donor Agency", "Ministry of Finance", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Donor Agency", "Finland", "Totals-Actual Commitments", "666,777"),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Donor Agency", "USAID", "Totals-Actual Commitments", "333,222"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Donor Agency", "Finland", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Donor Agency", "Water Org", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Donor Agency", "Finland", "Totals-Actual Commitments", "333,333"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Donor Agency", "Finland", "Totals-Actual Commitments", "570,000"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Donor Agency", "Norway", "Totals-Actual Commitments", "890,000"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Donor Agency", "Ministry of Economy", "Totals-Actual Commitments", "75,000"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Donor Agency", "Finland", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Donor Agency", "UNDP", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Donor Agency", "World Bank", "Totals-Actual Commitments", "32,000"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Donor Agency", "Ministry of Economy", "Totals-Actual Commitments", "15,000"),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Donor Agency", "USAID", "Totals-Actual Commitments", "5,000,000"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Donor Agency", "Finland, USAID", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Donor Agency", "Finland", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "96,840,58", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Donor Agency", "Finland", "Totals-Actual Commitments", "12,000"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Donor Agency", "Finland, Ministry of Economy", "Totals-Actual Commitments", "123,321"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Donor Agency", "UNDP, Water Foundation, World Bank", "Totals-Actual Commitments", "100"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Donor Agency", "UNDP", "Totals-Actual Commitments", "45,000"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Donor Agency", "Finland", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Totals-Actual Commitments", "1,200"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Donor Agency", "Finland", "Totals-Actual Commitments", "123,000"),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Donor Agency", "Norway, USAID", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "888,000"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Commitments", "150,000"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Donor Agency", "Norway, UNDP", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Donor Agency", "Ministry of Finance, UNDP", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Donor Agency", "Finland, Norway, USAID", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Donor Agency", "Finland, Ministry of Finance, Norway", "Totals-Actual Commitments", "97,562,98")      ));

        ReportSpecificationImpl spec = buildSpecification("sort by directed MTEF", 
                Arrays.asList(ColumnConstants.PROJECT_TITLE, "Real MTEF 2011", ColumnConstants.DONOR_AGENCY), 
                Arrays.asList(MeasureConstants.ACTUAL_COMMITMENTS, MeasureConstants.ACTUAL_DISBURSEMENTS),
                null, 
                GroupingCriteria.GROUPING_TOTALS_ONLY);
        
        spec.addSorter(new SortingInfo(Arrays.asList("Real MTEF 2011", "EXEC-BENF"), SortingInfo.ROOT_PATH_NONE, false));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    public void testSortingByFlowTotal() {
        NiReportModel cor = new NiReportModel("sort by Real Disb Flow")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 8))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Totals: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 2, colSpan: 6))",
                        "(Actual Disbursements: (startRow: 2, rowSpan: 2, totalRowSpan: 2, colStart: 2, colSpan: 1));(Real Disbursements: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 3, colSpan: 5))",
                        "(DN-EXEC: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(DN-IMPL: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(EXEC-IMPL: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(IMPL-BENF: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(IMPL-EXEC: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Donor Agency", "", "Totals-Actual Disbursements", "3,206,802", "Totals-Real Disbursements-DN-EXEC", "545,000", "Totals-Real Disbursements-DN-IMPL", "77,222", "Totals-Real Disbursements-EXEC-IMPL", "100,000", "Totals-Real Disbursements-IMPL-BENF", "15,000", "Totals-Real Disbursements-IMPL-EXEC", "44,333")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Donor Agency", "Ministry of Economy, USAID", "Totals-Actual Disbursements", "143,777", "Totals-Real Disbursements-DN-IMPL", "77,222", "Totals-Real Disbursements-IMPL-EXEC", "44,333"),
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Donor Agency", "World Bank", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Donor Agency", "Water Foundation", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Donor Agency", "Ministry of Economy"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Donor Agency", "Ministry of Economy, Ministry of Finance"),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Donor Agency", "USAID"),
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Donor Agency", "Finland, Norway, USAID", "Totals-Actual Disbursements", "545,000", "Totals-Real Disbursements-DN-EXEC", "545,000", "Totals-Real Disbursements-EXEC-IMPL", "100,000", "Totals-Real Disbursements-IMPL-BENF", "15,000"),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Donor Agency", "UNDP"),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Donor Agency", "Ministry of Finance", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Donor Agency", "USAID"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Donor Agency", "Finland", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Donor Agency", "Water Org", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Donor Agency", "Norway"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Donor Agency", "Ministry of Economy"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Donor Agency", "UNDP"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Donor Agency", "World Bank"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Donor Agency", "Ministry of Economy"),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Donor Agency", "USAID"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Donor Agency", "Finland, USAID", "Totals-Actual Disbursements", "450,000"),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Donor Agency", "Finland", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Donor Agency", "Finland, Ministry of Finance", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Donor Agency", "Finland, Ministry of Economy"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Donor Agency", "UNDP, Water Foundation, World Bank"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Donor Agency", "UNDP"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Donor Agency", "Finland", "Totals-Actual Disbursements", "321,765"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Donor Agency", "Ministry of Finance, UNDP, USAID"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Donor Agency", "Finland, Ministry of Finance"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Donor Agency", "Finland"),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Donor Agency", "Norway, USAID", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Donor Agency", "Finland, Ministry of Finance"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Donor Agency", "Finland, Ministry of Finance"),
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Donor Agency", "Ministry of Economy"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Donor Agency", "Norway, UNDP", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Donor Agency", "Ministry of Finance, UNDP", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Donor Agency", "Finland, Norway, USAID", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Donor Agency", "Finland, Ministry of Finance, Norway")      ));
        
        ReportSpecificationImpl spec = buildSpecification("sort by Real Disb Flow", 
            Arrays.asList(ColumnConstants.PROJECT_TITLE, ColumnConstants.DONOR_AGENCY), 
            Arrays.asList(MeasureConstants.ACTUAL_DISBURSEMENTS, MeasureConstants.REAL_DISBURSEMENTS),
            null, 
            GroupingCriteria.GROUPING_TOTALS_ONLY);
    
        spec.addSorter(new SortingInfo(Arrays.asList(MeasureConstants.REAL_DISBURSEMENTS, "DN-IMPL"), SortingInfo.ROOT_PATH_TOTALS, false));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingStoredReportMeasure() {
        NiReportModel cor = new NiReportModel("AMP-22484-by-measure")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 5, colStart: 0, colSpan: 35))",
                        "(Zone: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 1, colSpan: 1));(Real MTEF 2011: (startRow: 1, rowSpan: 3, totalRowSpan: 4, colStart: 2, colSpan: 2));(Primary Sector: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 4, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 4, colStart: 5, colSpan: 21));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 4, colStart: 26, colSpan: 9))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 5, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 7, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 3));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 14, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 16, colSpan: 6));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 22, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 7, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 9, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 10, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 17, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 4));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 25, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 26, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 27, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 28, colSpan: 5));(Real MTEF: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 33, colSpan: 2))",
                        "(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 28, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 29, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 30, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 31, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 32, colSpan: 1));(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 33, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 34, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Zone", "", "Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "7 842 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "8 159 813,77", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "19 408 691,19", "Totals-Actual Disbursements", "3 206 802", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Zone", "Zone: Undefined", -9089))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 382 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "7 998 992,77", "Funding-2014-Actual Disbursements", "660 200", "Funding-2015-Actual Commitments", "1 515 042,84", "Funding-2015-Actual Disbursements", "115 570", "Totals-Actual Commitments", "17 234 240,61", "Totals-Actual Disbursements", "2 835 037", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500", "Zone", "Zone: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Primary Sector", "110 - EDUCATION", "Funding-2010-Actual Disbursements", "143 777", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Actual Disbursements", "143 777", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-IMPL-EXEC", "44 333"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "545 000", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Totals-Actual Disbursements", "545 000", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Primary Sector", "110 - EDUCATION", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Primary Sector", "113 - SECONDARY EDUCATION", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Primary Sector", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Glodeni", 9111))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "37 500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "1 491 289", "Totals-Actual Disbursements", "321 765", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Glodeni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Tiraspol", 9114)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "123 321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123 321", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Tiraspol")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Slobozia", 9115)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Slobozia")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2014-Actual Disbursements", "22 500", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Dolboaca", 9110)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Dolboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "178 000", "Totals-Actual Commitments", "178 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Bulboaca", 9108)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Bulboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Apareni", 9113)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Apareni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500"))));
        
        runNiTestCase(spec("AMP-22484-by-measure"), "en", acts, cor);
    }
    
    @Test
    public void testSortingStoredReportMeasureFlow() {
        NiReportModel cor = new NiReportModel("AMP-22484-by-measure-flow")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 5, colStart: 0, colSpan: 35))",
                        "(Zone: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 1, colSpan: 1));(Real MTEF 2011: (startRow: 1, rowSpan: 3, totalRowSpan: 4, colStart: 2, colSpan: 2));(Primary Sector: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 4, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 4, colStart: 5, colSpan: 21));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 4, colStart: 26, colSpan: 9))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 5, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 7, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 3));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 14, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 16, colSpan: 6));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 22, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 7, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 9, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 10, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 17, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 4));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 25, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 26, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 27, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 28, colSpan: 5));(Real MTEF: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 33, colSpan: 2))",
                        "(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 28, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 29, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 30, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 31, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 32, colSpan: 1));(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 33, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 34, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Zone", "", "Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "7 842 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "8 159 813,77", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "19 408 691,19", "Totals-Actual Disbursements", "3 206 802", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Zone", "Zone: Undefined", -9089))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 382 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "7 998 992,77", "Funding-2014-Actual Disbursements", "660 200", "Funding-2015-Actual Commitments", "1 515 042,84", "Funding-2015-Actual Disbursements", "115 570", "Totals-Actual Commitments", "17 234 240,61", "Totals-Actual Disbursements", "2 835 037", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500", "Zone", "Zone: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "545 000", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Totals-Actual Disbursements", "545 000", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000"),
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Primary Sector", "110 - EDUCATION", "Funding-2010-Actual Disbursements", "143 777", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Actual Disbursements", "143 777", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-IMPL-EXEC", "44 333"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Primary Sector", "110 - EDUCATION", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Primary Sector", "113 - SECONDARY EDUCATION", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Primary Sector", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Tiraspol", 9114)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "123 321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123 321", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Tiraspol")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Slobozia", 9115)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Slobozia")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2014-Actual Disbursements", "22 500", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Glodeni", 9111))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "37 500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "1 491 289", "Totals-Actual Disbursements", "321 765", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Glodeni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Dolboaca", 9110)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Dolboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "178 000", "Totals-Actual Commitments", "178 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Bulboaca", 9108)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Bulboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Apareni", 9113)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Apareni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500"))));
        
        runNiTestCase(spec("AMP-22484-by-measure-flow"), "en", acts, cor);
    }

    @Test
    public void testSortingStoredReportProjectTitle() {
        NiReportModel cor = new NiReportModel("AMP-22484-by-project-title")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 5, colStart: 0, colSpan: 35))",
                        "(Zone: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 1, colSpan: 1));(Real MTEF 2011: (startRow: 1, rowSpan: 3, totalRowSpan: 4, colStart: 2, colSpan: 2));(Primary Sector: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 4, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 4, colStart: 5, colSpan: 21));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 4, colStart: 26, colSpan: 9))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 5, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 7, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 3));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 14, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 16, colSpan: 6));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 22, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 7, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 9, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 10, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 17, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 4));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 25, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 26, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 27, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 28, colSpan: 5));(Real MTEF: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 33, colSpan: 2))",
                        "(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 28, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 29, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 30, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 31, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 32, colSpan: 1));(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 33, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 34, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Zone", "", "Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "7 842 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "8 159 813,77", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "19 408 691,19", "Totals-Actual Disbursements", "3 206 802", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Zone", "Apareni", 9113)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Apareni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Bulboaca", 9108)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Bulboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Dolboaca", 9110)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Dolboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "178 000", "Totals-Actual Commitments", "178 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Glodeni", 9111))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "37 500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "1 491 289", "Totals-Actual Disbursements", "321 765", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Glodeni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Slobozia", 9115)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Slobozia")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2014-Actual Disbursements", "22 500", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Tiraspol", 9114)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "123 321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123 321", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Tiraspol")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Zone: Undefined", -9089))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 382 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "7 998 992,77", "Funding-2014-Actual Disbursements", "660 200", "Funding-2015-Actual Commitments", "1 515 042,84", "Funding-2015-Actual Disbursements", "115 570", "Totals-Actual Commitments", "17 234 240,61", "Totals-Actual Disbursements", "2 835 037", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500", "Zone", "Zone: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Primary Sector", "110 - EDUCATION", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "545 000", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Totals-Actual Disbursements", "545 000", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Primary Sector", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Primary Sector", "113 - SECONDARY EDUCATION", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Primary Sector", "110 - EDUCATION", "Funding-2010-Actual Disbursements", "143 777", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Actual Disbursements", "143 777", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-IMPL-EXEC", "44 333"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98")        )      ));

        runNiTestCase(spec("AMP-22484-by-project-title"), "en", acts, cor);
    }

    
    @Test
    public void testSortingStoredReportTotalMeasure() {
        NiReportModel cor = new NiReportModel("AMP-22484-by-total-measure")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 5, colStart: 0, colSpan: 35))",
                        "(Zone: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 1, colSpan: 1));(Real MTEF 2011: (startRow: 1, rowSpan: 3, totalRowSpan: 4, colStart: 2, colSpan: 2));(Primary Sector: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 4, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 4, colStart: 5, colSpan: 21));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 4, colStart: 26, colSpan: 9))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 5, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 7, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 3));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 14, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 16, colSpan: 6));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 22, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 7, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 9, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 10, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 17, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 4));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 25, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 26, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 27, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 28, colSpan: 5));(Real MTEF: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 33, colSpan: 2))",
                        "(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 28, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 29, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 30, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 31, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 32, colSpan: 1));(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 33, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 34, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Zone", "", "Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "7 842 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "8 159 813,77", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "19 408 691,19", "Totals-Actual Disbursements", "3 206 802", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Zone", "Zone: Undefined", -9089))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 382 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "7 998 992,77", "Funding-2014-Actual Disbursements", "660 200", "Funding-2015-Actual Commitments", "1 515 042,84", "Funding-2015-Actual Disbursements", "115 570", "Totals-Actual Commitments", "17 234 240,61", "Totals-Actual Disbursements", "2 835 037", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500", "Zone", "Zone: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "545 000", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Totals-Actual Disbursements", "545 000", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Primary Sector", "113 - SECONDARY EDUCATION", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Primary Sector", "110 - EDUCATION", "Funding-2010-Actual Disbursements", "143 777", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Actual Disbursements", "143 777", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-IMPL-EXEC", "44 333"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Primary Sector", "110 - EDUCATION", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Primary Sector", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Glodeni", 9111))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "37 500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "1 491 289", "Totals-Actual Disbursements", "321 765", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Glodeni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765"),
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Apareni", 9113)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Apareni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Slobozia", 9115)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Slobozia")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2014-Actual Disbursements", "22 500", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Tiraspol", 9114)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "123 321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123 321", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Tiraspol")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Dolboaca", 9110)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Dolboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "178 000", "Totals-Actual Commitments", "178 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Bulboaca", 9108)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Bulboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"))));
        
        runNiTestCase(spec("AMP-22484-by-total-measure"), "en", acts, cor);
    }

    
    @Test
    public void testSortingStoredReportTotalMeasureFlow() {
        NiReportModel cor = new NiReportModel("AMP-22484-by-total-measure-flow")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 5, colStart: 0, colSpan: 35))",
                        "(Zone: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 1, colSpan: 1));(Real MTEF 2011: (startRow: 1, rowSpan: 3, totalRowSpan: 4, colStart: 2, colSpan: 2));(Primary Sector: (startRow: 1, rowSpan: 4, totalRowSpan: 4, colStart: 4, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 4, colStart: 5, colSpan: 21));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 4, colStart: 26, colSpan: 9))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 5, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 7, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 9, colSpan: 3));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 12, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 14, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 16, colSpan: 6));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 22, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 3, colStart: 24, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 5, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 6, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 7, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 8, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 9, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 10, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 17, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 4));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 22, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 23, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 24, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 25, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 26, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 2, totalRowSpan: 2, colStart: 27, colSpan: 1));(Real Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 28, colSpan: 5));(Real MTEF: (startRow: 3, rowSpan: 1, totalRowSpan: 2, colStart: 33, colSpan: 2))",
                        "(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 2, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 3, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1));(DN-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 28, colSpan: 1));(DN-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 29, colSpan: 1));(EXEC-IMPL: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 30, colSpan: 1));(IMPL-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 31, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 32, colSpan: 1));(EXEC-BENF: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 33, colSpan: 1));(IMPL-EXEC: (startRow: 4, rowSpan: 1, totalRowSpan: 1, colStart: 34, colSpan: 1))"))
                    .withWarnings(Arrays.asList())
                    .withBody(      new ReportAreaForTests(null)
                      .withContents("Zone", "", "Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "96 840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "7 842 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "8 159 813,77", "Funding-2014-Actual Disbursements", "710 200", "Funding-2015-Actual Commitments", "1 971 831,84", "Funding-2015-Actual Disbursements", "437 335", "Totals-Actual Commitments", "19 408 691,19", "Totals-Actual Disbursements", "3 206 802", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500")
                      .withChildren(
                        new ReportAreaForTests(new AreaOwner("Zone", "Zone: Undefined", -9089))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100 000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780 311", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2011-Actual Commitments", "1 213 119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Funding-2013-Actual Commitments", "6 382 086", "Funding-2013-Actual Disbursements", "1 266 956", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Funding-2014-Actual Commitments", "7 998 992,77", "Funding-2014-Actual Disbursements", "660 200", "Funding-2015-Actual Commitments", "1 515 042,84", "Funding-2015-Actual Disbursements", "115 570", "Totals-Actual Commitments", "17 234 240,61", "Totals-Actual Disbursements", "2 835 037", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000", "Totals-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500", "Zone", "Zone: Undefined")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "545 000", "Funding-2013-Real Disbursements-DN-EXEC", "545 000", "Funding-2013-Real Disbursements-EXEC-IMPL", "100 000", "Funding-2013-Real Disbursements-IMPL-BENF", "15 000", "Totals-Actual Disbursements", "545 000", "Totals-Real Disbursements-DN-EXEC", "545 000", "Totals-Real Disbursements-EXEC-IMPL", "100 000", "Totals-Real Disbursements-IMPL-BENF", "15 000"),
                          new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2010-Actual Disbursements", "123 321", "Funding-2011-Actual Commitments", "213 231", "Totals-Actual Commitments", "213 231", "Totals-Actual Disbursements", "123 321"),
                          new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Primary Sector", "130 - POPULATION POLICIES/PROGRAMMES AND REPRODUCTIVE HEALTH", "Funding-2010-Actual Disbursements", "453 213", "Funding-2011-Actual Commitments", "999 888", "Totals-Actual Commitments", "999 888", "Totals-Actual Disbursements", "453 213"),
                          new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Primary Sector", "110 - EDUCATION", "Funding-2010-Actual Disbursements", "143 777", "Funding-2010-Real Disbursements-DN-IMPL", "77 222", "Funding-2013-Real Disbursements-IMPL-EXEC", "44 333", "Totals-Actual Disbursements", "143 777", "Totals-Real Disbursements-DN-IMPL", "77 222", "Totals-Real Disbursements-IMPL-EXEC", "44 333"),
                          new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Primary Sector", "110 - EDUCATION", "Funding-2009-Actual Commitments", "100 000", "Funding-2010-Actual Disbursements", "60 000", "Funding-2012-Actual Commitments", "25 000", "Funding-2012-Actual Disbursements", "12 000", "Totals-Actual Commitments", "125 000", "Totals-Actual Disbursements", "72 000"),
                          new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "666 777", "Totals-Actual Commitments", "666 777"),
                          new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 222", "Totals-Actual Commitments", "333 222"),
                          new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "111 333", "Funding-2013-Actual Disbursements", "555 111", "Totals-Actual Commitments", "111 333", "Totals-Actual Disbursements", "555 111"),
                          new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2013-Actual Commitments", "567 421", "Funding-2013-Actual Disbursements", "131 845", "Totals-Actual Commitments", "567 421", "Totals-Actual Disbursements", "131 845"),
                          new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "333 333", "Totals-Actual Commitments", "333 333"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "50 000", "Totals-Actual Commitments", "50 000"),
                          new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "32 000", "Totals-Actual Commitments", "32 000"),
                          new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "15 000", "Totals-Actual Commitments", "15 000"),
                          new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "1 700 000", "Funding-2014-Actual Commitments", "3 300 000", "Totals-Actual Commitments", "5 000 000"),
                          new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Primary Sector", "113 - SECONDARY EDUCATION", "Funding-2013-Actual Commitments", "2 670 000", "Funding-2014-Actual Commitments", "4 400 000", "Funding-2014-Actual Disbursements", "450 000", "Totals-Actual Commitments", "7 070 000", "Totals-Actual Disbursements", "450 000"),
                          new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "65 760,63", "Funding-2014-Actual Disbursements", "80 000", "Totals-Actual Commitments", "65 760,63", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Primary Sector", "", "Funding-2014-Actual Commitments", "12 000", "Totals-Actual Commitments", "12 000"),
                          new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                          new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "45 000", "Totals-Actual Commitments", "45 000"),
                          new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "1 200", "Totals-Actual Commitments", "1 200"),
                          new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456"),
                          new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 000", "Totals-Actual Commitments", "123 000"),
                          new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Primary Sector", "112 - BASIC EDUCATION", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                          new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "888 000", "Totals-Actual Commitments", "888 000"),
                          new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Primary Sector", "110 - EDUCATION, 113 - SECONDARY EDUCATION", "Funding-2014-Actual Commitments", "33 000", "Funding-2015-Actual Commitments", "117 000", "Totals-Actual Commitments", "150 000"),
                          new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Real MTEF 2011-EXEC-BENF", "50 000", "Real MTEF 2011-IMPL-EXEC", "110 500", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Commitments", "123 456", "Totals-Actual Commitments", "123 456", "Totals-Real MTEF-EXEC-BENF", "50 000", "Totals-Real MTEF-IMPL-EXEC", "110 500"),
                          new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Disbursements", "35 000", "Funding-2014-Actual Disbursements", "75 000", "Totals-Actual Disbursements", "110 000"),
                          new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Disbursements", "55 000", "Funding-2015-Actual Disbursements", "35 000", "Totals-Actual Disbursements", "90 000"),
                          new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Primary Sector", "110 - EDUCATION", "Funding-2015-Actual Disbursements", "80 000", "Totals-Actual Disbursements", "80 000"),
                          new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2014-Actual Commitments", "3 632,14", "Funding-2015-Actual Commitments", "93 930,84", "Totals-Actual Commitments", "97 562,98")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Tiraspol", 9114)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "123 321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123 321", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Tiraspol")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "123 321", "Totals-Actual Commitments", "123 321")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Slobozia", 9115)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Slobozia")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "43 578,26", "Funding-2014-Actual Disbursements", "22 500", "Totals-Actual Commitments", "43 578,26", "Totals-Actual Disbursements", "22 500")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Glodeni", 9111))
                        .withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "37 500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "1 491 289", "Totals-Actual Disbursements", "321 765", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Glodeni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000"),
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "712 000", "Totals-Actual Commitments", "712 000"),
                          new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Primary Sector", "110 - EDUCATION", "Funding-2014-Actual Commitments", "37 500", "Totals-Actual Commitments", "37 500"),
                          new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION", "Funding-2015-Actual Commitments", "456 789", "Funding-2015-Actual Disbursements", "321 765", "Totals-Actual Commitments", "456 789", "Totals-Actual Disbursements", "321 765")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Dolboaca", 9110)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Dolboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Primary Sector", "110 - EDUCATION, 120 - HEALTH", "Funding-2013-Actual Commitments", "178 000", "Totals-Actual Commitments", "178 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Bulboaca", 9108)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285 000", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285 000", "Totals-Actual Disbursements", "0", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Bulboaca")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Primary Sector", "110 - EDUCATION", "Funding-2013-Actual Commitments", "285 000", "Totals-Actual Commitments", "285 000")        ),
                        new ReportAreaForTests(new AreaOwner("Zone", "Apareni", 9113)).withContents("Project Title", "", "Real MTEF 2011-EXEC-BENF", "0", "Real MTEF 2011-IMPL-EXEC", "0", "Primary Sector", "", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2010-Real Disbursements-DN-IMPL", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2013-Real Disbursements-DN-EXEC", "0", "Funding-2013-Real Disbursements-EXEC-IMPL", "0", "Funding-2013-Real Disbursements-IMPL-BENF", "0", "Funding-2013-Real Disbursements-IMPL-EXEC", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27 500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500", "Totals-Real Disbursements-DN-EXEC", "0", "Totals-Real Disbursements-DN-IMPL", "0", "Totals-Real Disbursements-EXEC-IMPL", "0", "Totals-Real Disbursements-IMPL-BENF", "0", "Totals-Real Disbursements-IMPL-EXEC", "0", "Totals-Real MTEF-EXEC-BENF", "0", "Totals-Real MTEF-IMPL-EXEC", "0", "Zone", "Apareni")
                        .withChildren(
                          new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Primary Sector", "110 - EDUCATION, 112 - BASIC EDUCATION, 120 - HEALTH", "Funding-2006-Actual Commitments", "53 262,32", "Funding-2014-Actual Disbursements", "27 500", "Totals-Actual Commitments", "53 262,32", "Totals-Actual Disbursements", "27 500"))));

        runNiTestCase(spec("AMP-22484-by-total-measure-flow"), "en", acts, cor);
    }

}
