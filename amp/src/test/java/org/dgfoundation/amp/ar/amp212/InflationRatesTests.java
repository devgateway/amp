package org.dgfoundation.amp.ar.amp212;

import java.util.Arrays;
import java.util.Date;
import java.util.Iterator;
import java.util.List;

import javax.validation.ConstraintViolationException;

import org.dgfoundation.amp.currency.ConstantCurrency;
import org.dgfoundation.amp.currency.CurrencyInflationUtil;
import org.dgfoundation.amp.currency.inflation.CCExchangeRate;
import org.dgfoundation.amp.currency.inflation.InflationRateGenerator;
import org.dgfoundation.amp.newreports.AmpReportingTestCase;
import org.digijava.kernel.persistence.PersistenceManager;
import org.digijava.module.aim.dbentity.AmpCurrency;
import org.digijava.module.aim.dbentity.AmpCurrencyRate;
import org.digijava.module.aim.dbentity.AmpFiscalCalendar;
import org.digijava.module.aim.dbentity.AmpInflationRate;
import org.digijava.module.aim.util.CurrencyUtil;
import org.digijava.module.aim.util.FiscalCalendarUtil;
import org.digijava.module.common.util.DateTimeUtil;
import org.hibernate.Session;
import org.junit.Test;

/**
 * testcases for Currency Deflator (https://jira.dgfoundation.org/browse/AMP-20534)
 * @author Constantin Dolghier
 *
 */
public class InflationRatesTests extends AmpReportingTestCase {
    
    private final static String DP = "yyyy-MM-dd";

    public final static List<String> activities = Arrays.asList(
            "TAC_activity_1", "Test MTEF directed", "Pure MTEF Project", "mtef activity 1", "Activity with both MTEFs and Act.Comms");
    
    @Test(expected = ConstraintViolationException.class)
    public void testInvalidYear() {
        AmpCurrency usd = CurrencyUtil.getAmpcurrency("USD");
        AmpInflationRate impossibleYear = new AmpInflationRate(usd, DateTimeUtil.parseDate("1940-01-01", DP), -2.7);
        saveInflation(impossibleYear);
    }

    @Test(expected = ConstraintViolationException.class)
    public void testImpossibleInflation() throws Exception {
        AmpCurrency usd = CurrencyUtil.getAmpcurrency("USD");
        AmpInflationRate impossibleInflation = new AmpInflationRate(usd, DateTimeUtil.parseDate("2010-01-01", DP), -999);
        saveInflation(impossibleInflation);
    }

    @Test(expected = ConstraintViolationException.class)
    public void testNoCurrencyGiven() throws Exception {
        AmpInflationRate noCurrencyGiven = new AmpInflationRate(null, DateTimeUtil.parseDate("2010-01-01", DP), 3.5);
        saveInflation(noCurrencyGiven);
    }

    private void saveInflation(final AmpInflationRate inflationRate) {
        Session session = PersistenceManager.getSession();
        session.save(inflationRate);
        session.flush();
    }
    
    @Test
    public void testInflationAndExchangeRates() {
        AmpCurrency usd = CurrencyUtil.getCurrencyByCode("USD");
        List<AmpInflationRate> rates = Arrays.asList(
                new AmpInflationRate(usd, DateTimeUtil.parseDate("2007-01-01", DP), 1.1),
                new AmpInflationRate(usd, DateTimeUtil.parseDate("2008-01-01", DP), 2.0),
                new AmpInflationRate(usd, DateTimeUtil.parseDate("2009-01-01", DP), -5.0),
                new AmpInflationRate(usd, DateTimeUtil.parseDate("2011-01-01", DP), 1.7));
        
        InflationRateGenerator.GENERATE_ALL = true;
        
        CCExchangeRate generator = new CCExchangeRate(rates);
        AmpFiscalCalendar gregorian = FiscalCalendarUtil.getAmpFiscalCalendar("Calendrier Gr√©gorien");
        
        // test Gregorian 2006 Constant Currency
        ConstantCurrency cc = CurrencyInflationUtil.createOrActivateConstantCurrency(usd, gregorian, 2006);
        List<AmpCurrencyRate> ccRates = filterToDate("2015-12-10", generator.generateExchangeRates(cc));
        
        String allIntervalsRates = InflationRateGenerator.toDatePeriodStrRates(
                generator.getIrgPerCurrency().get("USD").getAllGeneratedInflationRates()).toString();
        assertEquals(
                "{2007-01-01 to 2008-01-01=1.1, 2007-01-01 to 2009-01-01=3.122, 2007-01-01 to 2011-01-01=-2.0341, 2007-01-01 to 2012-01-01=-0.36868, 2008-01-01 to 2009-01-01=2.0, 2008-01-01 to 2011-01-01=-3.1, 2008-01-01 to 2012-01-01=-1.4527, 2009-01-01 to 2011-01-01=-5.0, 2009-01-01 to 2012-01-01=-3.385, 2011-01-01 to 2012-01-01=1.7}"
                , allIntervalsRates);
        assertEquals(
                "[from USD to USD2006-4 on 2007-01-01 equals 1.0000, from USD to USD2006-4 on 2007-04-02 equals 1.0000, from USD to USD2006-4 on 2007-04-03 equals 1.0000, from USD to USD2006-4 on 2007-04-04 equals 1.0000, from USD to USD2006-4 on 2007-04-05 equals 1.0000, from USD to USD2006-4 on 2007-04-06 equals 1.0000, from USD to USD2006-4 on 2007-04-07 equals 1.0000, from USD to USD2006-4 on 2007-04-08 equals 1.0000, from USD to USD2006-4 on 2007-04-09 equals 1.0000, from USD to USD2006-4 on 2007-04-10 equals 1.0000, from USD to USD2006-4 on 2007-04-11 equals 1.0000, from USD to USD2006-4 on 2007-04-12 equals 1.0000, from USD to USD2006-4 on 2007-04-13 equals 1.0000, from USD to USD2006-4 on 2007-04-14 equals 1.0000, from USD to USD2006-4 on 2007-04-15 equals 1.0000, from USD to USD2006-4 on 2007-04-16 equals 1.0000, from USD to USD2006-4 on 2007-04-17 equals 1.0000, from USD to USD2006-4 on 2007-04-18 equals 1.0000, from USD to USD2006-4 on 2007-04-19 equals 1.0000, from USD to USD2006-4 on 2007-04-20 equals 1.0000, from USD to USD2006-4 on 2007-04-21 equals 1.0000, from USD to USD2006-4 on 2007-04-22 equals 1.0000, from USD to USD2006-4 on 2007-04-23 equals 1.0000, from USD to USD2006-4 on 2007-04-24 equals 1.0000, from USD to USD2006-4 on 2007-04-25 equals 1.0000, from USD to USD2006-4 on 2007-04-26 equals 1.0000, from USD to USD2006-4 on 2007-04-27 equals 1.0000, from USD to USD2006-4 on 2007-04-28 equals 1.0000, from USD to USD2006-4 on 2007-04-29 equals 1.0000, from USD to USD2006-4 on 2007-04-30 equals 1.0000, from USD to USD2006-4 on 2007-05-01 equals 1.0000, from USD to USD2006-4 on 2007-05-02 equals 1.0000, from USD to USD2006-4 on 2007-05-03 equals 1.0000, from USD to USD2006-4 on 2007-05-04 equals 1.0000, from USD to USD2006-4 on 2007-05-05 equals 1.0000, from USD to USD2006-4 on 2007-05-06 equals 1.0000, from USD to USD2006-4 on 2007-05-07 equals 1.0000, from USD to USD2006-4 on 2007-05-08 equals 1.0000, from USD to USD2006-4 on 2007-05-09 equals 1.0000, from USD to USD2006-4 on 2007-05-10 equals 1.0000, from USD to USD2006-4 on 2007-05-11 equals 1.0000, from USD to USD2006-4 on 2007-05-12 equals 1.0000, from USD to USD2006-4 on 2007-05-13 equals 1.0000, from USD to USD2006-4 on 2007-05-14 equals 1.0000, from USD to USD2006-4 on 2007-05-15 equals 1.0000, from USD to USD2006-4 on 2007-05-16 equals 1.0000, from USD to USD2006-4 on 2007-05-17 equals 1.0000, from USD to USD2006-4 on 2007-05-18 equals 1.0000, from USD to USD2006-4 on 2007-05-19 equals 1.0000, from USD to USD2006-4 on 2007-05-20 equals 1.0000, from USD to USD2006-4 on 2007-05-21 equals 1.0000, from USD to USD2006-4 on 2007-05-22 equals 1.0000, from USD to USD2006-4 on 2007-05-23 equals 1.0000, from USD to USD2006-4 on 2007-05-24 equals 1.0000, from USD to USD2006-4 on 2007-05-25 equals 1.0000, from USD to USD2006-4 on 2007-05-26 equals 1.0000, from USD to USD2006-4 on 2007-05-27 equals 1.0000, from USD to USD2006-4 on 2007-05-28 equals 1.0000, from USD to USD2006-4 on 2007-05-29 equals 1.0000, from USD to USD2006-4 on 2007-05-30 equals 1.0000, from USD to USD2006-4 on 2007-05-31 equals 1.0000, from USD to USD2006-4 on 2007-06-01 equals 1.0000, from USD to USD2006-4 on 2007-06-02 equals 1.0000, from USD to USD2006-4 on 2007-06-03 equals 1.0000, from USD to USD2006-4 on 2007-06-04 equals 1.0000, from USD to USD2006-4 on 2007-06-05 equals 1.0000, from USD to USD2006-4 on 2007-06-06 equals 1.0000, from USD to USD2006-4 on 2007-06-07 equals 1.0000, from USD to USD2006-4 on 2007-06-08 equals 1.0000, from USD to USD2006-4 on 2007-06-09 equals 1.0000, from USD to USD2006-4 on 2007-06-10 equals 1.0000, from USD to USD2006-4 on 2007-06-11 equals 1.0000, from USD to USD2006-4 on 2007-06-12 equals 1.0000, from USD to USD2006-4 on 2007-06-13 equals 1.0000, from USD to USD2006-4 on 2007-06-14 equals 1.0000, from USD to USD2006-4 on 2007-06-15 equals 1.0000, from USD to USD2006-4 on 2007-06-16 equals 1.0000, from USD to USD2006-4 on 2007-06-17 equals 1.0000, from USD to USD2006-4 on 2007-06-18 equals 1.0000, from USD to USD2006-4 on 2007-06-19 equals 1.0000, from USD to USD2006-4 on 2007-06-20 equals 1.0000, from USD to USD2006-4 on 2007-06-21 equals 1.0000, from USD to USD2006-4 on 2007-06-22 equals 1.0000, from USD to USD2006-4 on 2007-06-23 equals 1.0000, from USD to USD2006-4 on 2007-06-24 equals 1.0000, from USD to USD2006-4 on 2007-06-25 equals 1.0000, from USD to USD2006-4 on 2007-06-26 equals 1.0000, from USD to USD2006-4 on 2007-06-27 equals 1.0000, from USD to USD2006-4 on 2007-06-28 equals 1.0000, from USD to USD2006-4 on 2007-06-29 equals 1.0000, from USD to USD2006-4 on 2007-06-30 equals 1.0000, from USD to USD2006-4 on 2007-07-01 equals 1.0000, from USD to USD2006-4 on 2007-07-02 equals 1.0000, from USD to USD2006-4 on 2007-07-03 equals 1.0000, from USD to USD2006-4 on 2007-07-04 equals 1.0000, from USD to USD2006-4 on 2007-07-05 equals 1.0000, from USD to USD2006-4 on 2007-07-06 equals 1.0000, from USD to USD2006-4 on 2007-07-07 equals 1.0000, from USD to USD2006-4 on 2007-07-08 equals 1.0000, from USD to USD2006-4 on 2007-07-09 equals 1.0000, from USD to USD2006-4 on 2007-07-10 equals 1.0000, from USD to USD2006-4 on 2007-07-11 equals 1.0000, from USD to USD2006-4 on 2007-07-12 equals 1.0000, from USD to USD2006-4 on 2007-07-13 equals 1.0000, from USD to USD2006-4 on 2007-07-14 equals 1.0000, from USD to USD2006-4 on 2007-07-15 equals 1.0000, from USD to USD2006-4 on 2007-07-16 equals 1.0000, from USD to USD2006-4 on 2007-07-17 equals 1.0000, from USD to USD2006-4 on 2007-07-18 equals 1.0000, from USD to USD2006-4 on 2007-07-19 equals 1.0000, from USD to USD2006-4 on 2007-07-20 equals 1.0000, from USD to USD2006-4 on 2007-07-21 equals 1.0000, from USD to USD2006-4 on 2007-07-22 equals 1.0000, from USD to USD2006-4 on 2007-07-23 equals 1.0000, from USD to USD2006-4 on 2007-07-24 equals 1.0000, from USD to USD2006-4 on 2007-07-25 equals 1.0000, from USD to USD2006-4 on 2007-07-26 equals 1.0000, from USD to USD2006-4 on 2007-07-27 equals 1.0000, from USD to USD2006-4 on 2007-07-28 equals 1.0000, from USD to USD2006-4 on 2007-07-29 equals 1.0000, from USD to USD2006-4 on 2007-07-30 equals 1.0000, from USD to USD2006-4 on 2007-07-31 equals 1.0000, from USD to USD2006-4 on 2007-08-01 equals 1.0000, from USD to USD2006-4 on 2007-08-02 equals 1.0000, from USD to USD2006-4 on 2007-08-03 equals 1.0000, from USD to USD2006-4 on 2007-08-04 equals 1.0000, from USD to USD2006-4 on 2007-08-05 equals 1.0000, from USD to USD2006-4 on 2007-08-06 equals 1.0000, from USD to USD2006-4 on 2007-08-07 equals 1.0000, from USD to USD2006-4 on 2007-08-08 equals 1.0000, from USD to USD2006-4 on 2007-08-09 equals 1.0000, from USD to USD2006-4 on 2007-08-10 equals 1.0000, from USD to USD2006-4 on 2007-08-11 equals 1.0000, from USD to USD2006-4 on 2007-08-12 equals 1.0000, from USD to USD2006-4 on 2007-08-13 equals 1.0000, from USD to USD2006-4 on 2007-08-14 equals 1.0000, from USD to USD2006-4 on 2007-08-15 equals 1.0000, from USD to USD2006-4 on 2007-08-16 equals 1.0000, from USD to USD2006-4 on 2007-08-17 equals 1.0000, from USD to USD2006-4 on 2007-08-18 equals 1.0000, from USD to USD2006-4 on 2007-08-19 equals 1.0000, from USD to USD2006-4 on 2007-08-20 equals 1.0000, from USD to USD2006-4 on 2007-08-21 equals 1.0000, from USD to USD2006-4 on 2007-08-22 equals 1.0000, from USD to USD2006-4 on 2007-08-23 equals 1.0000, from USD to USD2006-4 on 2007-08-24 equals 1.0000, from USD to USD2006-4 on 2007-08-25 equals 1.0000, from USD to USD2006-4 on 2007-08-26 equals 1.0000, from USD to USD2006-4 on 2007-08-27 equals 1.0000, from USD to USD2006-4 on 2007-08-28 equals 1.0000, from USD to USD2006-4 on 2007-08-29 equals 1.0000, from USD to USD2006-4 on 2007-08-30 equals 1.0000, from USD to USD2006-4 on 2007-08-31 equals 1.0000, from USD to USD2006-4 on 2007-09-01 equals 1.0000, from USD to USD2006-4 on 2007-09-02 equals 1.0000, from USD to USD2006-4 on 2007-09-03 equals 1.0000, from USD to USD2006-4 on 2007-09-04 equals 1.0000, from USD to USD2006-4 on 2007-09-05 equals 1.0000, from USD to USD2006-4 on 2007-09-06 equals 1.0000, from USD to USD2006-4 on 2007-09-07 equals 1.0000, from USD to USD2006-4 on 2007-09-08 equals 1.0000, from USD to USD2006-4 on 2007-09-09 equals 1.0000, from USD to USD2006-4 on 2007-09-10 equals 1.0000, from USD to USD2006-4 on 2007-09-11 equals 1.0000, from USD to USD2006-4 on 2007-09-12 equals 1.0000, from USD to USD2006-4 on 2007-09-13 equals 1.0000, from USD to USD2006-4 on 2007-09-14 equals 1.0000, from USD to USD2006-4 on 2007-09-15 equals 1.0000, from USD to USD2006-4 on 2007-09-16 equals 1.0000, from USD to USD2006-4 on 2007-09-17 equals 1.0000, from USD to USD2006-4 on 2007-09-18 equals 1.0000, from USD to USD2006-4 on 2007-09-19 equals 1.0000, from USD to USD2006-4 on 2007-09-20 equals 1.0000, from USD to USD2006-4 on 2007-09-21 equals 1.0000, from USD to USD2006-4 on 2007-09-22 equals 1.0000, from USD to USD2006-4 on 2007-09-23 equals 1.0000, from USD to USD2006-4 on 2007-09-24 equals 1.0000, from USD to USD2006-4 on 2007-09-25 equals 1.0000, from USD to USD2006-4 on 2007-09-26 equals 1.0000, from USD to USD2006-4 on 2007-09-27 equals 1.0000, from USD to USD2006-4 on 2007-09-28 equals 1.0000, from USD to USD2006-4 on 2007-09-29 equals 1.0000, from USD to USD2006-4 on 2007-09-30 equals 1.0000, from USD to USD2006-4 on 2007-10-01 equals 1.0000, from USD to USD2006-4 on 2007-10-02 equals 1.0000, from USD to USD2006-4 on 2007-10-03 equals 1.0000, from USD to USD2006-4 on 2007-12-01 equals 1.0000, from USD to USD2006-4 on 2008-01-01 equals 0.9891, from USD to USD2006-4 on 2008-04-01 equals 0.9891, from USD to USD2006-4 on 2008-05-21 equals 0.9891, from USD to USD2006-4 on 2008-07-15 equals 0.9891, from USD to USD2006-4 on 2008-09-20 equals 0.9891, from USD to USD2006-4 on 2008-09-22 equals 0.9891, from USD to USD2006-4 on 2008-09-23 equals 0.9891, from USD to USD2006-4 on 2008-09-24 equals 0.9891, from USD to USD2006-4 on 2008-09-25 equals 0.9891, from USD to USD2006-4 on 2008-09-26 equals 0.9891, from USD to USD2006-4 on 2008-09-27 equals 0.9891, from USD to USD2006-4 on 2008-09-28 equals 0.9891, from USD to USD2006-4 on 2008-09-29 equals 0.9891, from USD to USD2006-4 on 2008-09-30 equals 0.9891, from USD to USD2006-4 on 2008-10-01 equals 0.9891, from USD to USD2006-4 on 2008-10-02 equals 0.9891, from USD to USD2006-4 on 2008-10-03 equals 0.9891, from USD to USD2006-4 on 2008-12-30 equals 0.9891, from USD to USD2006-4 on 2009-01-01 equals 0.9697, from USD to USD2006-4 on 2010-05-11 equals 0.9697, from USD to USD2006-4 on 2010-05-12 equals 0.9697, from USD to USD2006-4 on 2010-06-04 equals 0.9697, from USD to USD2006-4 on 2010-06-05 equals 0.9697, from USD to USD2006-4 on 2010-06-06 equals 0.9697, from USD to USD2006-4 on 2010-06-07 equals 0.9697, from USD to USD2006-4 on 2010-06-15 equals 0.9697, from USD to USD2006-4 on 2010-06-16 equals 0.9697, from USD to USD2006-4 on 2010-06-18 equals 0.9697, from USD to USD2006-4 on 2010-06-19 equals 0.9697, from USD to USD2006-4 on 2010-06-20 equals 0.9697, from USD to USD2006-4 on 2010-06-21 equals 0.9697, from USD to USD2006-4 on 2010-06-22 equals 0.9697, from USD to USD2006-4 on 2010-06-23 equals 0.9697, from USD to USD2006-4 on 2010-06-24 equals 0.9697, from USD to USD2006-4 on 2010-06-25 equals 0.9697, from USD to USD2006-4 on 2010-06-26 equals 0.9697, from USD to USD2006-4 on 2010-06-27 equals 0.9697, from USD to USD2006-4 on 2010-06-28 equals 0.9697, from USD to USD2006-4 on 2010-06-29 equals 0.9697, from USD to USD2006-4 on 2010-06-30 equals 0.9697, from USD to USD2006-4 on 2010-07-01 equals 0.9697, from USD to USD2006-4 on 2010-07-02 equals 0.9697, from USD to USD2006-4 on 2010-07-03 equals 0.9697, from USD to USD2006-4 on 2010-07-04 equals 0.9697, from USD to USD2006-4 on 2010-07-05 equals 0.9697, from USD to USD2006-4 on 2010-07-06 equals 0.9697, from USD to USD2006-4 on 2010-07-07 equals 0.9697, from USD to USD2006-4 on 2010-07-08 equals 0.9697, from USD to USD2006-4 on 2010-07-09 equals 0.9697, from USD to USD2006-4 on 2010-07-11 equals 0.9697, from USD to USD2006-4 on 2010-07-12 equals 0.9697, from USD to USD2006-4 on 2010-07-13 equals 0.9697, from USD to USD2006-4 on 2010-07-14 equals 0.9697, from USD to USD2006-4 on 2010-07-15 equals 0.9697, from USD to USD2006-4 on 2010-07-16 equals 0.9697, from USD to USD2006-4 on 2010-07-17 equals 0.9697, from USD to USD2006-4 on 2010-07-18 equals 0.9697, from USD to USD2006-4 on 2010-07-19 equals 0.9697, from USD to USD2006-4 on 2010-07-22 equals 0.9697, from USD to USD2006-4 on 2010-07-27 equals 0.9697, from USD to USD2006-4 on 2010-07-28 equals 0.9697, from USD to USD2006-4 on 2010-07-29 equals 0.9697, from USD to USD2006-4 on 2010-07-30 equals 0.9697, from USD to USD2006-4 on 2010-07-31 equals 0.9697, from USD to USD2006-4 on 2010-08-01 equals 0.9697, from USD to USD2006-4 on 2010-08-02 equals 0.9697, from USD to USD2006-4 on 2010-08-03 equals 0.9697, from USD to USD2006-4 on 2010-08-04 equals 0.9697, from USD to USD2006-4 on 2010-08-05 equals 0.9697, from USD to USD2006-4 on 2010-08-06 equals 0.9697, from USD to USD2006-4 on 2010-08-07 equals 0.9697, from USD to USD2006-4 on 2010-08-08 equals 0.9697, from USD to USD2006-4 on 2010-08-09 equals 0.9697, from USD to USD2006-4 on 2010-08-10 equals 0.9697, from USD to USD2006-4 on 2010-08-11 equals 0.9697, from USD to USD2006-4 on 2010-08-12 equals 0.9697, from USD to USD2006-4 on 2010-08-13 equals 0.9697, from USD to USD2006-4 on 2010-08-14 equals 0.9697, from USD to USD2006-4 on 2010-08-15 equals 0.9697, from USD to USD2006-4 on 2010-08-16 equals 0.9697, from USD to USD2006-4 on 2010-08-17 equals 0.9697, from USD to USD2006-4 on 2010-08-18 equals 0.9697, from USD to USD2006-4 on 2010-08-19 equals 0.9697, from USD to USD2006-4 on 2010-08-20 equals 0.9697, from USD to USD2006-4 on 2010-08-21 equals 0.9697, from USD to USD2006-4 on 2010-08-22 equals 0.9697, from USD to USD2006-4 on 2010-08-23 equals 0.9697, from USD to USD2006-4 on 2010-08-24 equals 0.9697, from USD to USD2006-4 on 2010-08-25 equals 0.9697, from USD to USD2006-4 on 2010-08-27 equals 0.9697, from USD to USD2006-4 on 2010-08-28 equals 0.9697, from USD to USD2006-4 on 2010-08-29 equals 0.9697, from USD to USD2006-4 on 2010-08-30 equals 0.9697, from USD to USD2006-4 on 2010-08-31 equals 0.9697, from USD to USD2006-4 on 2010-09-01 equals 0.9697, from USD to USD2006-4 on 2010-09-02 equals 0.9697, from USD to USD2006-4 on 2010-09-03 equals 0.9697, from USD to USD2006-4 on 2010-09-04 equals 0.9697, from USD to USD2006-4 on 2010-09-05 equals 0.9697, from USD to USD2006-4 on 2010-09-06 equals 0.9697, from USD to USD2006-4 on 2010-09-07 equals 0.9697, from USD to USD2006-4 on 2010-09-08 equals 0.9697, from USD to USD2006-4 on 2010-09-15 equals 0.9697, from USD to USD2006-4 on 2010-09-16 equals 0.9697, from USD to USD2006-4 on 2010-09-17 equals 0.9697, from USD to USD2006-4 on 2010-09-18 equals 0.9697, from USD to USD2006-4 on 2010-09-21 equals 0.9697, from USD to USD2006-4 on 2010-09-29 equals 0.9697, from USD to USD2006-4 on 2010-10-02 equals 0.9697, from USD to USD2006-4 on 2010-10-03 equals 0.9697, from USD to USD2006-4 on 2010-12-31 equals 1.0208, from USD to USD2006-4 on 2011-01-01 equals 1.0208, from USD to USD2006-4 on 2011-04-02 equals 1.0208, from USD to USD2006-4 on 2011-04-04 equals 1.0208, from USD to USD2006-4 on 2011-04-05 equals 1.0208, from USD to USD2006-4 on 2011-04-06 equals 1.0208, from USD to USD2006-4 on 2011-04-07 equals 1.0208, from USD to USD2006-4 on 2011-04-08 equals 1.0208, from USD to USD2006-4 on 2011-04-09 equals 1.0208, from USD to USD2006-4 on 2011-04-12 equals 1.0208, from USD to USD2006-4 on 2011-04-13 equals 1.0208, from USD to USD2006-4 on 2011-04-14 equals 1.0208, from USD to USD2006-4 on 2011-04-16 equals 1.0208, from USD to USD2006-4 on 2011-04-17 equals 1.0208, from USD to USD2006-4 on 2011-04-18 equals 1.0208, from USD to USD2006-4 on 2011-04-19 equals 1.0208, from USD to USD2006-4 on 2011-04-20 equals 1.0208, from USD to USD2006-4 on 2011-04-21 equals 1.0208, from USD to USD2006-4 on 2011-04-22 equals 1.0208, from USD to USD2006-4 on 2011-04-23 equals 1.0208, from USD to USD2006-4 on 2011-04-24 equals 1.0208, from USD to USD2006-4 on 2011-04-25 equals 1.0208, from USD to USD2006-4 on 2011-04-26 equals 1.0208, from USD to USD2006-4 on 2011-04-27 equals 1.0208, from USD to USD2006-4 on 2011-04-30 equals 1.0208, from USD to USD2006-4 on 2011-05-01 equals 1.0208, from USD to USD2006-4 on 2011-05-02 equals 1.0208, from USD to USD2006-4 on 2011-05-03 equals 1.0208, from USD to USD2006-4 on 2011-05-04 equals 1.0208, from USD to USD2006-4 on 2011-05-05 equals 1.0208, from USD to USD2006-4 on 2011-05-06 equals 1.0208, from USD to USD2006-4 on 2011-05-10 equals 1.0208, from USD to USD2006-4 on 2011-05-11 equals 1.0208, from USD to USD2006-4 on 2011-05-12 equals 1.0208, from USD to USD2006-4 on 2011-05-13 equals 1.0208, from USD to USD2006-4 on 2011-05-15 equals 1.0208, from USD to USD2006-4 on 2011-05-16 equals 1.0208, from USD to USD2006-4 on 2011-05-17 equals 1.0208, from USD to USD2006-4 on 2011-05-18 equals 1.0208, from USD to USD2006-4 on 2011-05-19 equals 1.0208, from USD to USD2006-4 on 2011-05-20 equals 1.0208, from USD to USD2006-4 on 2011-05-21 equals 1.0208, from USD to USD2006-4 on 2011-05-22 equals 1.0208, from USD to USD2006-4 on 2011-05-23 equals 1.0208, from USD to USD2006-4 on 2011-05-24 equals 1.0208, from USD to USD2006-4 on 2011-05-25 equals 1.0208, from USD to USD2006-4 on 2011-05-26 equals 1.0208, from USD to USD2006-4 on 2011-05-27 equals 1.0208, from USD to USD2006-4 on 2011-05-28 equals 1.0208, from USD to USD2006-4 on 2011-05-29 equals 1.0208, from USD to USD2006-4 on 2011-05-30 equals 1.0208, from USD to USD2006-4 on 2011-05-31 equals 1.0208, from USD to USD2006-4 on 2011-06-01 equals 1.0208, from USD to USD2006-4 on 2011-06-02 equals 1.0208, from USD to USD2006-4 on 2011-06-03 equals 1.0208, from USD to USD2006-4 on 2011-06-04 equals 1.0208, from USD to USD2006-4 on 2011-06-05 equals 1.0208, from USD to USD2006-4 on 2011-06-06 equals 1.0208, from USD to USD2006-4 on 2011-06-07 equals 1.0208, from USD to USD2006-4 on 2011-06-08 equals 1.0208, from USD to USD2006-4 on 2011-06-09 equals 1.0208, from USD to USD2006-4 on 2011-06-10 equals 1.0208, from USD to USD2006-4 on 2011-06-11 equals 1.0208, from USD to USD2006-4 on 2011-06-12 equals 1.0208, from USD to USD2006-4 on 2011-06-13 equals 1.0208, from USD to USD2006-4 on 2011-06-14 equals 1.0208, from USD to USD2006-4 on 2011-06-15 equals 1.0208, from USD to USD2006-4 on 2011-06-16 equals 1.0208, from USD to USD2006-4 on 2011-06-24 equals 1.0208, from USD to USD2006-4 on 2011-06-25 equals 1.0208, from USD to USD2006-4 on 2011-06-26 equals 1.0208, from USD to USD2006-4 on 2011-06-27 equals 1.0208, from USD to USD2006-4 on 2011-06-28 equals 1.0208, from USD to USD2006-4 on 2011-06-29 equals 1.0208, from USD to USD2006-4 on 2011-06-30 equals 1.0208, from USD to USD2006-4 on 2011-07-01 equals 1.0208, from USD to USD2006-4 on 2011-07-02 equals 1.0208, from USD to USD2006-4 on 2011-07-03 equals 1.0208, from USD to USD2006-4 on 2011-07-04 equals 1.0208, from USD to USD2006-4 on 2011-07-05 equals 1.0208, from USD to USD2006-4 on 2011-07-06 equals 1.0208, from USD to USD2006-4 on 2011-07-07 equals 1.0208, from USD to USD2006-4 on 2011-07-08 equals 1.0208, from USD to USD2006-4 on 2011-07-10 equals 1.0208, from USD to USD2006-4 on 2011-07-11 equals 1.0208, from USD to USD2006-4 on 2011-07-12 equals 1.0208, from USD to USD2006-4 on 2011-07-13 equals 1.0208, from USD to USD2006-4 on 2011-07-14 equals 1.0208, from USD to USD2006-4 on 2011-07-15 equals 1.0208, from USD to USD2006-4 on 2011-07-16 equals 1.0208, from USD to USD2006-4 on 2011-07-17 equals 1.0208, from USD to USD2006-4 on 2011-07-18 equals 1.0208, from USD to USD2006-4 on 2011-07-19 equals 1.0208, from USD to USD2006-4 on 2011-07-20 equals 1.0208, from USD to USD2006-4 on 2011-07-21 equals 1.0208, from USD to USD2006-4 on 2011-07-22 equals 1.0208, from USD to USD2006-4 on 2011-07-23 equals 1.0208, from USD to USD2006-4 on 2011-07-24 equals 1.0208, from USD to USD2006-4 on 2011-07-25 equals 1.0208, from USD to USD2006-4 on 2011-07-26 equals 1.0208, from USD to USD2006-4 on 2011-07-27 equals 1.0208, from USD to USD2006-4 on 2011-07-29 equals 1.0208, from USD to USD2006-4 on 2011-07-30 equals 1.0208, from USD to USD2006-4 on 2011-07-31 equals 1.0208, from USD to USD2006-4 on 2011-08-01 equals 1.0208, from USD to USD2006-4 on 2011-08-02 equals 1.0208, from USD to USD2006-4 on 2011-08-03 equals 1.0208, from USD to USD2006-4 on 2011-08-05 equals 1.0208, from USD to USD2006-4 on 2011-08-06 equals 1.0208, from USD to USD2006-4 on 2011-08-07 equals 1.0208, from USD to USD2006-4 on 2011-08-08 equals 1.0208, from USD to USD2006-4 on 2011-08-09 equals 1.0208, from USD to USD2006-4 on 2011-08-10 equals 1.0208, from USD to USD2006-4 on 2011-08-11 equals 1.0208, from USD to USD2006-4 on 2011-08-12 equals 1.0208, from USD to USD2006-4 on 2011-08-13 equals 1.0208, from USD to USD2006-4 on 2011-08-14 equals 1.0208, from USD to USD2006-4 on 2011-08-15 equals 1.0208, from USD to USD2006-4 on 2011-08-16 equals 1.0208, from USD to USD2006-4 on 2011-08-17 equals 1.0208, from USD to USD2006-4 on 2011-08-18 equals 1.0208, from USD to USD2006-4 on 2011-08-19 equals 1.0208, from USD to USD2006-4 on 2011-08-20 equals 1.0208, from USD to USD2006-4 on 2011-08-21 equals 1.0208, from USD to USD2006-4 on 2011-08-22 equals 1.0208, from USD to USD2006-4 on 2011-08-23 equals 1.0208, from USD to USD2006-4 on 2011-08-26 equals 1.0208, from USD to USD2006-4 on 2011-08-31 equals 1.0208, from USD to USD2006-4 on 2011-09-01 equals 1.0208, from USD to USD2006-4 on 2011-09-03 equals 1.0208, from USD to USD2006-4 on 2011-09-04 equals 1.0208, from USD to USD2006-4 on 2011-09-05 equals 1.0208, from USD to USD2006-4 on 2011-09-06 equals 1.0208, from USD to USD2006-4 on 2011-09-07 equals 1.0208, from USD to USD2006-4 on 2011-09-08 equals 1.0208, from USD to USD2006-4 on 2011-09-09 equals 1.0208, from USD to USD2006-4 on 2011-09-10 equals 1.0208, from USD to USD2006-4 on 2011-09-11 equals 1.0208, from USD to USD2006-4 on 2011-09-12 equals 1.0208, from USD to USD2006-4 on 2011-09-13 equals 1.0208, from USD to USD2006-4 on 2011-09-14 equals 1.0208, from USD to USD2006-4 on 2011-09-15 equals 1.0208, from USD to USD2006-4 on 2011-09-16 equals 1.0208, from USD to USD2006-4 on 2011-09-17 equals 1.0208, from USD to USD2006-4 on 2011-09-18 equals 1.0208, from USD to USD2006-4 on 2011-09-19 equals 1.0208, from USD to USD2006-4 on 2011-09-20 equals 1.0208, from USD to USD2006-4 on 2011-09-21 equals 1.0208, from USD to USD2006-4 on 2011-09-22 equals 1.0208, from USD to USD2006-4 on 2011-09-23 equals 1.0208, from USD to USD2006-4 on 2011-09-24 equals 1.0208, from USD to USD2006-4 on 2011-09-25 equals 1.0208, from USD to USD2006-4 on 2011-09-26 equals 1.0208, from USD to USD2006-4 on 2011-09-27 equals 1.0208, from USD to USD2006-4 on 2011-09-28 equals 1.0208, from USD to USD2006-4 on 2011-09-29 equals 1.0208, from USD to USD2006-4 on 2011-09-30 equals 1.0208, from USD to USD2006-4 on 2011-10-01 equals 1.0208, from USD to USD2006-4 on 2012-01-01 equals 1.0037]"
                , ccRates.toString());
        // test Gregorian 2008 Constant Currency
        cc = CurrencyInflationUtil.createOrActivateConstantCurrency(usd, gregorian, 2008);
        ccRates = filterToDate("2015-12-10", generator.generateExchangeRates(cc));
        assertEquals(
                "[from USD to USD2008-4 on 2007-01-01 equals 1.0200, from USD to USD2008-4 on 2007-04-02 equals 1.0200, from USD to USD2008-4 on 2007-04-03 equals 1.0200, from USD to USD2008-4 on 2007-04-04 equals 1.0200, from USD to USD2008-4 on 2007-04-05 equals 1.0200, from USD to USD2008-4 on 2007-04-06 equals 1.0200, from USD to USD2008-4 on 2007-04-07 equals 1.0200, from USD to USD2008-4 on 2007-04-08 equals 1.0200, from USD to USD2008-4 on 2007-04-09 equals 1.0200, from USD to USD2008-4 on 2007-04-10 equals 1.0200, from USD to USD2008-4 on 2007-04-11 equals 1.0200, from USD to USD2008-4 on 2007-04-12 equals 1.0200, from USD to USD2008-4 on 2007-04-13 equals 1.0200, from USD to USD2008-4 on 2007-04-14 equals 1.0200, from USD to USD2008-4 on 2007-04-15 equals 1.0200, from USD to USD2008-4 on 2007-04-16 equals 1.0200, from USD to USD2008-4 on 2007-04-17 equals 1.0200, from USD to USD2008-4 on 2007-04-18 equals 1.0200, from USD to USD2008-4 on 2007-04-19 equals 1.0200, from USD to USD2008-4 on 2007-04-20 equals 1.0200, from USD to USD2008-4 on 2007-04-21 equals 1.0200, from USD to USD2008-4 on 2007-04-22 equals 1.0200, from USD to USD2008-4 on 2007-04-23 equals 1.0200, from USD to USD2008-4 on 2007-04-24 equals 1.0200, from USD to USD2008-4 on 2007-04-25 equals 1.0200, from USD to USD2008-4 on 2007-04-26 equals 1.0200, from USD to USD2008-4 on 2007-04-27 equals 1.0200, from USD to USD2008-4 on 2007-04-28 equals 1.0200, from USD to USD2008-4 on 2007-04-29 equals 1.0200, from USD to USD2008-4 on 2007-04-30 equals 1.0200, from USD to USD2008-4 on 2007-05-01 equals 1.0200, from USD to USD2008-4 on 2007-05-02 equals 1.0200, from USD to USD2008-4 on 2007-05-03 equals 1.0200, from USD to USD2008-4 on 2007-05-04 equals 1.0200, from USD to USD2008-4 on 2007-05-05 equals 1.0200, from USD to USD2008-4 on 2007-05-06 equals 1.0200, from USD to USD2008-4 on 2007-05-07 equals 1.0200, from USD to USD2008-4 on 2007-05-08 equals 1.0200, from USD to USD2008-4 on 2007-05-09 equals 1.0200, from USD to USD2008-4 on 2007-05-10 equals 1.0200, from USD to USD2008-4 on 2007-05-11 equals 1.0200, from USD to USD2008-4 on 2007-05-12 equals 1.0200, from USD to USD2008-4 on 2007-05-13 equals 1.0200, from USD to USD2008-4 on 2007-05-14 equals 1.0200, from USD to USD2008-4 on 2007-05-15 equals 1.0200, from USD to USD2008-4 on 2007-05-16 equals 1.0200, from USD to USD2008-4 on 2007-05-17 equals 1.0200, from USD to USD2008-4 on 2007-05-18 equals 1.0200, from USD to USD2008-4 on 2007-05-19 equals 1.0200, from USD to USD2008-4 on 2007-05-20 equals 1.0200, from USD to USD2008-4 on 2007-05-21 equals 1.0200, from USD to USD2008-4 on 2007-05-22 equals 1.0200, from USD to USD2008-4 on 2007-05-23 equals 1.0200, from USD to USD2008-4 on 2007-05-24 equals 1.0200, from USD to USD2008-4 on 2007-05-25 equals 1.0200, from USD to USD2008-4 on 2007-05-26 equals 1.0200, from USD to USD2008-4 on 2007-05-27 equals 1.0200, from USD to USD2008-4 on 2007-05-28 equals 1.0200, from USD to USD2008-4 on 2007-05-29 equals 1.0200, from USD to USD2008-4 on 2007-05-30 equals 1.0200, from USD to USD2008-4 on 2007-05-31 equals 1.0200, from USD to USD2008-4 on 2007-06-01 equals 1.0200, from USD to USD2008-4 on 2007-06-02 equals 1.0200, from USD to USD2008-4 on 2007-06-03 equals 1.0200, from USD to USD2008-4 on 2007-06-04 equals 1.0200, from USD to USD2008-4 on 2007-06-05 equals 1.0200, from USD to USD2008-4 on 2007-06-06 equals 1.0200, from USD to USD2008-4 on 2007-06-07 equals 1.0200, from USD to USD2008-4 on 2007-06-08 equals 1.0200, from USD to USD2008-4 on 2007-06-09 equals 1.0200, from USD to USD2008-4 on 2007-06-10 equals 1.0200, from USD to USD2008-4 on 2007-06-11 equals 1.0200, from USD to USD2008-4 on 2007-06-12 equals 1.0200, from USD to USD2008-4 on 2007-06-13 equals 1.0200, from USD to USD2008-4 on 2007-06-14 equals 1.0200, from USD to USD2008-4 on 2007-06-15 equals 1.0200, from USD to USD2008-4 on 2007-06-16 equals 1.0200, from USD to USD2008-4 on 2007-06-17 equals 1.0200, from USD to USD2008-4 on 2007-06-18 equals 1.0200, from USD to USD2008-4 on 2007-06-19 equals 1.0200, from USD to USD2008-4 on 2007-06-20 equals 1.0200, from USD to USD2008-4 on 2007-06-21 equals 1.0200, from USD to USD2008-4 on 2007-06-22 equals 1.0200, from USD to USD2008-4 on 2007-06-23 equals 1.0200, from USD to USD2008-4 on 2007-06-24 equals 1.0200, from USD to USD2008-4 on 2007-06-25 equals 1.0200, from USD to USD2008-4 on 2007-06-26 equals 1.0200, from USD to USD2008-4 on 2007-06-27 equals 1.0200, from USD to USD2008-4 on 2007-06-28 equals 1.0200, from USD to USD2008-4 on 2007-06-29 equals 1.0200, from USD to USD2008-4 on 2007-06-30 equals 1.0200, from USD to USD2008-4 on 2007-07-01 equals 1.0200, from USD to USD2008-4 on 2007-07-02 equals 1.0200, from USD to USD2008-4 on 2007-07-03 equals 1.0200, from USD to USD2008-4 on 2007-07-04 equals 1.0200, from USD to USD2008-4 on 2007-07-05 equals 1.0200, from USD to USD2008-4 on 2007-07-06 equals 1.0200, from USD to USD2008-4 on 2007-07-07 equals 1.0200, from USD to USD2008-4 on 2007-07-08 equals 1.0200, from USD to USD2008-4 on 2007-07-09 equals 1.0200, from USD to USD2008-4 on 2007-07-10 equals 1.0200, from USD to USD2008-4 on 2007-07-11 equals 1.0200, from USD to USD2008-4 on 2007-07-12 equals 1.0200, from USD to USD2008-4 on 2007-07-13 equals 1.0200, from USD to USD2008-4 on 2007-07-14 equals 1.0200, from USD to USD2008-4 on 2007-07-15 equals 1.0200, from USD to USD2008-4 on 2007-07-16 equals 1.0200, from USD to USD2008-4 on 2007-07-17 equals 1.0200, from USD to USD2008-4 on 2007-07-18 equals 1.0200, from USD to USD2008-4 on 2007-07-19 equals 1.0200, from USD to USD2008-4 on 2007-07-20 equals 1.0200, from USD to USD2008-4 on 2007-07-21 equals 1.0200, from USD to USD2008-4 on 2007-07-22 equals 1.0200, from USD to USD2008-4 on 2007-07-23 equals 1.0200, from USD to USD2008-4 on 2007-07-24 equals 1.0200, from USD to USD2008-4 on 2007-07-25 equals 1.0200, from USD to USD2008-4 on 2007-07-26 equals 1.0200, from USD to USD2008-4 on 2007-07-27 equals 1.0200, from USD to USD2008-4 on 2007-07-28 equals 1.0200, from USD to USD2008-4 on 2007-07-29 equals 1.0200, from USD to USD2008-4 on 2007-07-30 equals 1.0200, from USD to USD2008-4 on 2007-07-31 equals 1.0200, from USD to USD2008-4 on 2007-08-01 equals 1.0200, from USD to USD2008-4 on 2007-08-02 equals 1.0200, from USD to USD2008-4 on 2007-08-03 equals 1.0200, from USD to USD2008-4 on 2007-08-04 equals 1.0200, from USD to USD2008-4 on 2007-08-05 equals 1.0200, from USD to USD2008-4 on 2007-08-06 equals 1.0200, from USD to USD2008-4 on 2007-08-07 equals 1.0200, from USD to USD2008-4 on 2007-08-08 equals 1.0200, from USD to USD2008-4 on 2007-08-09 equals 1.0200, from USD to USD2008-4 on 2007-08-10 equals 1.0200, from USD to USD2008-4 on 2007-08-11 equals 1.0200, from USD to USD2008-4 on 2007-08-12 equals 1.0200, from USD to USD2008-4 on 2007-08-13 equals 1.0200, from USD to USD2008-4 on 2007-08-14 equals 1.0200, from USD to USD2008-4 on 2007-08-15 equals 1.0200, from USD to USD2008-4 on 2007-08-16 equals 1.0200, from USD to USD2008-4 on 2007-08-17 equals 1.0200, from USD to USD2008-4 on 2007-08-18 equals 1.0200, from USD to USD2008-4 on 2007-08-19 equals 1.0200, from USD to USD2008-4 on 2007-08-20 equals 1.0200, from USD to USD2008-4 on 2007-08-21 equals 1.0200, from USD to USD2008-4 on 2007-08-22 equals 1.0200, from USD to USD2008-4 on 2007-08-23 equals 1.0200, from USD to USD2008-4 on 2007-08-24 equals 1.0200, from USD to USD2008-4 on 2007-08-25 equals 1.0200, from USD to USD2008-4 on 2007-08-26 equals 1.0200, from USD to USD2008-4 on 2007-08-27 equals 1.0200, from USD to USD2008-4 on 2007-08-28 equals 1.0200, from USD to USD2008-4 on 2007-08-29 equals 1.0200, from USD to USD2008-4 on 2007-08-30 equals 1.0200, from USD to USD2008-4 on 2007-08-31 equals 1.0200, from USD to USD2008-4 on 2007-09-01 equals 1.0200, from USD to USD2008-4 on 2007-09-02 equals 1.0200, from USD to USD2008-4 on 2007-09-03 equals 1.0200, from USD to USD2008-4 on 2007-09-04 equals 1.0200, from USD to USD2008-4 on 2007-09-05 equals 1.0200, from USD to USD2008-4 on 2007-09-06 equals 1.0200, from USD to USD2008-4 on 2007-09-07 equals 1.0200, from USD to USD2008-4 on 2007-09-08 equals 1.0200, from USD to USD2008-4 on 2007-09-09 equals 1.0200, from USD to USD2008-4 on 2007-09-10 equals 1.0200, from USD to USD2008-4 on 2007-09-11 equals 1.0200, from USD to USD2008-4 on 2007-09-12 equals 1.0200, from USD to USD2008-4 on 2007-09-13 equals 1.0200, from USD to USD2008-4 on 2007-09-14 equals 1.0200, from USD to USD2008-4 on 2007-09-15 equals 1.0200, from USD to USD2008-4 on 2007-09-16 equals 1.0200, from USD to USD2008-4 on 2007-09-17 equals 1.0200, from USD to USD2008-4 on 2007-09-18 equals 1.0200, from USD to USD2008-4 on 2007-09-19 equals 1.0200, from USD to USD2008-4 on 2007-09-20 equals 1.0200, from USD to USD2008-4 on 2007-09-21 equals 1.0200, from USD to USD2008-4 on 2007-09-22 equals 1.0200, from USD to USD2008-4 on 2007-09-23 equals 1.0200, from USD to USD2008-4 on 2007-09-24 equals 1.0200, from USD to USD2008-4 on 2007-09-25 equals 1.0200, from USD to USD2008-4 on 2007-09-26 equals 1.0200, from USD to USD2008-4 on 2007-09-27 equals 1.0200, from USD to USD2008-4 on 2007-09-28 equals 1.0200, from USD to USD2008-4 on 2007-09-29 equals 1.0200, from USD to USD2008-4 on 2007-09-30 equals 1.0200, from USD to USD2008-4 on 2007-10-01 equals 1.0200, from USD to USD2008-4 on 2007-10-02 equals 1.0200, from USD to USD2008-4 on 2007-10-03 equals 1.0200, from USD to USD2008-4 on 2007-12-01 equals 1.0200, from USD to USD2008-4 on 2008-01-01 equals 1.0000, from USD to USD2008-4 on 2008-04-01 equals 1.0000, from USD to USD2008-4 on 2008-05-21 equals 1.0000, from USD to USD2008-4 on 2008-07-15 equals 1.0000, from USD to USD2008-4 on 2008-09-20 equals 1.0000, from USD to USD2008-4 on 2008-09-22 equals 1.0000, from USD to USD2008-4 on 2008-09-23 equals 1.0000, from USD to USD2008-4 on 2008-09-24 equals 1.0000, from USD to USD2008-4 on 2008-09-25 equals 1.0000, from USD to USD2008-4 on 2008-09-26 equals 1.0000, from USD to USD2008-4 on 2008-09-27 equals 1.0000, from USD to USD2008-4 on 2008-09-28 equals 1.0000, from USD to USD2008-4 on 2008-09-29 equals 1.0000, from USD to USD2008-4 on 2008-09-30 equals 1.0000, from USD to USD2008-4 on 2008-10-01 equals 1.0000, from USD to USD2008-4 on 2008-10-02 equals 1.0000, from USD to USD2008-4 on 2008-10-03 equals 1.0000, from USD to USD2008-4 on 2008-12-30 equals 1.0000, from USD to USD2008-4 on 2009-01-01 equals 1.0000, from USD to USD2008-4 on 2010-05-11 equals 1.0000, from USD to USD2008-4 on 2010-05-12 equals 1.0000, from USD to USD2008-4 on 2010-06-04 equals 1.0000, from USD to USD2008-4 on 2010-06-05 equals 1.0000, from USD to USD2008-4 on 2010-06-06 equals 1.0000, from USD to USD2008-4 on 2010-06-07 equals 1.0000, from USD to USD2008-4 on 2010-06-15 equals 1.0000, from USD to USD2008-4 on 2010-06-16 equals 1.0000, from USD to USD2008-4 on 2010-06-18 equals 1.0000, from USD to USD2008-4 on 2010-06-19 equals 1.0000, from USD to USD2008-4 on 2010-06-20 equals 1.0000, from USD to USD2008-4 on 2010-06-21 equals 1.0000, from USD to USD2008-4 on 2010-06-22 equals 1.0000, from USD to USD2008-4 on 2010-06-23 equals 1.0000, from USD to USD2008-4 on 2010-06-24 equals 1.0000, from USD to USD2008-4 on 2010-06-25 equals 1.0000, from USD to USD2008-4 on 2010-06-26 equals 1.0000, from USD to USD2008-4 on 2010-06-27 equals 1.0000, from USD to USD2008-4 on 2010-06-28 equals 1.0000, from USD to USD2008-4 on 2010-06-29 equals 1.0000, from USD to USD2008-4 on 2010-06-30 equals 1.0000, from USD to USD2008-4 on 2010-07-01 equals 1.0000, from USD to USD2008-4 on 2010-07-02 equals 1.0000, from USD to USD2008-4 on 2010-07-03 equals 1.0000, from USD to USD2008-4 on 2010-07-04 equals 1.0000, from USD to USD2008-4 on 2010-07-05 equals 1.0000, from USD to USD2008-4 on 2010-07-06 equals 1.0000, from USD to USD2008-4 on 2010-07-07 equals 1.0000, from USD to USD2008-4 on 2010-07-08 equals 1.0000, from USD to USD2008-4 on 2010-07-09 equals 1.0000, from USD to USD2008-4 on 2010-07-11 equals 1.0000, from USD to USD2008-4 on 2010-07-12 equals 1.0000, from USD to USD2008-4 on 2010-07-13 equals 1.0000, from USD to USD2008-4 on 2010-07-14 equals 1.0000, from USD to USD2008-4 on 2010-07-15 equals 1.0000, from USD to USD2008-4 on 2010-07-16 equals 1.0000, from USD to USD2008-4 on 2010-07-17 equals 1.0000, from USD to USD2008-4 on 2010-07-18 equals 1.0000, from USD to USD2008-4 on 2010-07-19 equals 1.0000, from USD to USD2008-4 on 2010-07-22 equals 1.0000, from USD to USD2008-4 on 2010-07-27 equals 1.0000, from USD to USD2008-4 on 2010-07-28 equals 1.0000, from USD to USD2008-4 on 2010-07-29 equals 1.0000, from USD to USD2008-4 on 2010-07-30 equals 1.0000, from USD to USD2008-4 on 2010-07-31 equals 1.0000, from USD to USD2008-4 on 2010-08-01 equals 1.0000, from USD to USD2008-4 on 2010-08-02 equals 1.0000, from USD to USD2008-4 on 2010-08-03 equals 1.0000, from USD to USD2008-4 on 2010-08-04 equals 1.0000, from USD to USD2008-4 on 2010-08-05 equals 1.0000, from USD to USD2008-4 on 2010-08-06 equals 1.0000, from USD to USD2008-4 on 2010-08-07 equals 1.0000, from USD to USD2008-4 on 2010-08-08 equals 1.0000, from USD to USD2008-4 on 2010-08-09 equals 1.0000, from USD to USD2008-4 on 2010-08-10 equals 1.0000, from USD to USD2008-4 on 2010-08-11 equals 1.0000, from USD to USD2008-4 on 2010-08-12 equals 1.0000, from USD to USD2008-4 on 2010-08-13 equals 1.0000, from USD to USD2008-4 on 2010-08-14 equals 1.0000, from USD to USD2008-4 on 2010-08-15 equals 1.0000, from USD to USD2008-4 on 2010-08-16 equals 1.0000, from USD to USD2008-4 on 2010-08-17 equals 1.0000, from USD to USD2008-4 on 2010-08-18 equals 1.0000, from USD to USD2008-4 on 2010-08-19 equals 1.0000, from USD to USD2008-4 on 2010-08-20 equals 1.0000, from USD to USD2008-4 on 2010-08-21 equals 1.0000, from USD to USD2008-4 on 2010-08-22 equals 1.0000, from USD to USD2008-4 on 2010-08-23 equals 1.0000, from USD to USD2008-4 on 2010-08-24 equals 1.0000, from USD to USD2008-4 on 2010-08-25 equals 1.0000, from USD to USD2008-4 on 2010-08-27 equals 1.0000, from USD to USD2008-4 on 2010-08-28 equals 1.0000, from USD to USD2008-4 on 2010-08-29 equals 1.0000, from USD to USD2008-4 on 2010-08-30 equals 1.0000, from USD to USD2008-4 on 2010-08-31 equals 1.0000, from USD to USD2008-4 on 2010-09-01 equals 1.0000, from USD to USD2008-4 on 2010-09-02 equals 1.0000, from USD to USD2008-4 on 2010-09-03 equals 1.0000, from USD to USD2008-4 on 2010-09-04 equals 1.0000, from USD to USD2008-4 on 2010-09-05 equals 1.0000, from USD to USD2008-4 on 2010-09-06 equals 1.0000, from USD to USD2008-4 on 2010-09-07 equals 1.0000, from USD to USD2008-4 on 2010-09-08 equals 1.0000, from USD to USD2008-4 on 2010-09-15 equals 1.0000, from USD to USD2008-4 on 2010-09-16 equals 1.0000, from USD to USD2008-4 on 2010-09-17 equals 1.0000, from USD to USD2008-4 on 2010-09-18 equals 1.0000, from USD to USD2008-4 on 2010-09-21 equals 1.0000, from USD to USD2008-4 on 2010-09-29 equals 1.0000, from USD to USD2008-4 on 2010-10-02 equals 1.0000, from USD to USD2008-4 on 2010-10-03 equals 1.0000, from USD to USD2008-4 on 2010-12-31 equals 1.0526, from USD to USD2008-4 on 2011-01-01 equals 1.0526, from USD to USD2008-4 on 2011-04-02 equals 1.0526, from USD to USD2008-4 on 2011-04-04 equals 1.0526, from USD to USD2008-4 on 2011-04-05 equals 1.0526, from USD to USD2008-4 on 2011-04-06 equals 1.0526, from USD to USD2008-4 on 2011-04-07 equals 1.0526, from USD to USD2008-4 on 2011-04-08 equals 1.0526, from USD to USD2008-4 on 2011-04-09 equals 1.0526, from USD to USD2008-4 on 2011-04-12 equals 1.0526, from USD to USD2008-4 on 2011-04-13 equals 1.0526, from USD to USD2008-4 on 2011-04-14 equals 1.0526, from USD to USD2008-4 on 2011-04-16 equals 1.0526, from USD to USD2008-4 on 2011-04-17 equals 1.0526, from USD to USD2008-4 on 2011-04-18 equals 1.0526, from USD to USD2008-4 on 2011-04-19 equals 1.0526, from USD to USD2008-4 on 2011-04-20 equals 1.0526, from USD to USD2008-4 on 2011-04-21 equals 1.0526, from USD to USD2008-4 on 2011-04-22 equals 1.0526, from USD to USD2008-4 on 2011-04-23 equals 1.0526, from USD to USD2008-4 on 2011-04-24 equals 1.0526, from USD to USD2008-4 on 2011-04-25 equals 1.0526, from USD to USD2008-4 on 2011-04-26 equals 1.0526, from USD to USD2008-4 on 2011-04-27 equals 1.0526, from USD to USD2008-4 on 2011-04-30 equals 1.0526, from USD to USD2008-4 on 2011-05-01 equals 1.0526, from USD to USD2008-4 on 2011-05-02 equals 1.0526, from USD to USD2008-4 on 2011-05-03 equals 1.0526, from USD to USD2008-4 on 2011-05-04 equals 1.0526, from USD to USD2008-4 on 2011-05-05 equals 1.0526, from USD to USD2008-4 on 2011-05-06 equals 1.0526, from USD to USD2008-4 on 2011-05-10 equals 1.0526, from USD to USD2008-4 on 2011-05-11 equals 1.0526, from USD to USD2008-4 on 2011-05-12 equals 1.0526, from USD to USD2008-4 on 2011-05-13 equals 1.0526, from USD to USD2008-4 on 2011-05-15 equals 1.0526, from USD to USD2008-4 on 2011-05-16 equals 1.0526, from USD to USD2008-4 on 2011-05-17 equals 1.0526, from USD to USD2008-4 on 2011-05-18 equals 1.0526, from USD to USD2008-4 on 2011-05-19 equals 1.0526, from USD to USD2008-4 on 2011-05-20 equals 1.0526, from USD to USD2008-4 on 2011-05-21 equals 1.0526, from USD to USD2008-4 on 2011-05-22 equals 1.0526, from USD to USD2008-4 on 2011-05-23 equals 1.0526, from USD to USD2008-4 on 2011-05-24 equals 1.0526, from USD to USD2008-4 on 2011-05-25 equals 1.0526, from USD to USD2008-4 on 2011-05-26 equals 1.0526, from USD to USD2008-4 on 2011-05-27 equals 1.0526, from USD to USD2008-4 on 2011-05-28 equals 1.0526, from USD to USD2008-4 on 2011-05-29 equals 1.0526, from USD to USD2008-4 on 2011-05-30 equals 1.0526, from USD to USD2008-4 on 2011-05-31 equals 1.0526, from USD to USD2008-4 on 2011-06-01 equals 1.0526, from USD to USD2008-4 on 2011-06-02 equals 1.0526, from USD to USD2008-4 on 2011-06-03 equals 1.0526, from USD to USD2008-4 on 2011-06-04 equals 1.0526, from USD to USD2008-4 on 2011-06-05 equals 1.0526, from USD to USD2008-4 on 2011-06-06 equals 1.0526, from USD to USD2008-4 on 2011-06-07 equals 1.0526, from USD to USD2008-4 on 2011-06-08 equals 1.0526, from USD to USD2008-4 on 2011-06-09 equals 1.0526, from USD to USD2008-4 on 2011-06-10 equals 1.0526, from USD to USD2008-4 on 2011-06-11 equals 1.0526, from USD to USD2008-4 on 2011-06-12 equals 1.0526, from USD to USD2008-4 on 2011-06-13 equals 1.0526, from USD to USD2008-4 on 2011-06-14 equals 1.0526, from USD to USD2008-4 on 2011-06-15 equals 1.0526, from USD to USD2008-4 on 2011-06-16 equals 1.0526, from USD to USD2008-4 on 2011-06-24 equals 1.0526, from USD to USD2008-4 on 2011-06-25 equals 1.0526, from USD to USD2008-4 on 2011-06-26 equals 1.0526, from USD to USD2008-4 on 2011-06-27 equals 1.0526, from USD to USD2008-4 on 2011-06-28 equals 1.0526, from USD to USD2008-4 on 2011-06-29 equals 1.0526, from USD to USD2008-4 on 2011-06-30 equals 1.0526, from USD to USD2008-4 on 2011-07-01 equals 1.0526, from USD to USD2008-4 on 2011-07-02 equals 1.0526, from USD to USD2008-4 on 2011-07-03 equals 1.0526, from USD to USD2008-4 on 2011-07-04 equals 1.0526, from USD to USD2008-4 on 2011-07-05 equals 1.0526, from USD to USD2008-4 on 2011-07-06 equals 1.0526, from USD to USD2008-4 on 2011-07-07 equals 1.0526, from USD to USD2008-4 on 2011-07-08 equals 1.0526, from USD to USD2008-4 on 2011-07-10 equals 1.0526, from USD to USD2008-4 on 2011-07-11 equals 1.0526, from USD to USD2008-4 on 2011-07-12 equals 1.0526, from USD to USD2008-4 on 2011-07-13 equals 1.0526, from USD to USD2008-4 on 2011-07-14 equals 1.0526, from USD to USD2008-4 on 2011-07-15 equals 1.0526, from USD to USD2008-4 on 2011-07-16 equals 1.0526, from USD to USD2008-4 on 2011-07-17 equals 1.0526, from USD to USD2008-4 on 2011-07-18 equals 1.0526, from USD to USD2008-4 on 2011-07-19 equals 1.0526, from USD to USD2008-4 on 2011-07-20 equals 1.0526, from USD to USD2008-4 on 2011-07-21 equals 1.0526, from USD to USD2008-4 on 2011-07-22 equals 1.0526, from USD to USD2008-4 on 2011-07-23 equals 1.0526, from USD to USD2008-4 on 2011-07-24 equals 1.0526, from USD to USD2008-4 on 2011-07-25 equals 1.0526, from USD to USD2008-4 on 2011-07-26 equals 1.0526, from USD to USD2008-4 on 2011-07-27 equals 1.0526, from USD to USD2008-4 on 2011-07-29 equals 1.0526, from USD to USD2008-4 on 2011-07-30 equals 1.0526, from USD to USD2008-4 on 2011-07-31 equals 1.0526, from USD to USD2008-4 on 2011-08-01 equals 1.0526, from USD to USD2008-4 on 2011-08-02 equals 1.0526, from USD to USD2008-4 on 2011-08-03 equals 1.0526, from USD to USD2008-4 on 2011-08-05 equals 1.0526, from USD to USD2008-4 on 2011-08-06 equals 1.0526, from USD to USD2008-4 on 2011-08-07 equals 1.0526, from USD to USD2008-4 on 2011-08-08 equals 1.0526, from USD to USD2008-4 on 2011-08-09 equals 1.0526, from USD to USD2008-4 on 2011-08-10 equals 1.0526, from USD to USD2008-4 on 2011-08-11 equals 1.0526, from USD to USD2008-4 on 2011-08-12 equals 1.0526, from USD to USD2008-4 on 2011-08-13 equals 1.0526, from USD to USD2008-4 on 2011-08-14 equals 1.0526, from USD to USD2008-4 on 2011-08-15 equals 1.0526, from USD to USD2008-4 on 2011-08-16 equals 1.0526, from USD to USD2008-4 on 2011-08-17 equals 1.0526, from USD to USD2008-4 on 2011-08-18 equals 1.0526, from USD to USD2008-4 on 2011-08-19 equals 1.0526, from USD to USD2008-4 on 2011-08-20 equals 1.0526, from USD to USD2008-4 on 2011-08-21 equals 1.0526, from USD to USD2008-4 on 2011-08-22 equals 1.0526, from USD to USD2008-4 on 2011-08-23 equals 1.0526, from USD to USD2008-4 on 2011-08-26 equals 1.0526, from USD to USD2008-4 on 2011-08-31 equals 1.0526, from USD to USD2008-4 on 2011-09-01 equals 1.0526, from USD to USD2008-4 on 2011-09-03 equals 1.0526, from USD to USD2008-4 on 2011-09-04 equals 1.0526, from USD to USD2008-4 on 2011-09-05 equals 1.0526, from USD to USD2008-4 on 2011-09-06 equals 1.0526, from USD to USD2008-4 on 2011-09-07 equals 1.0526, from USD to USD2008-4 on 2011-09-08 equals 1.0526, from USD to USD2008-4 on 2011-09-09 equals 1.0526, from USD to USD2008-4 on 2011-09-10 equals 1.0526, from USD to USD2008-4 on 2011-09-11 equals 1.0526, from USD to USD2008-4 on 2011-09-12 equals 1.0526, from USD to USD2008-4 on 2011-09-13 equals 1.0526, from USD to USD2008-4 on 2011-09-14 equals 1.0526, from USD to USD2008-4 on 2011-09-15 equals 1.0526, from USD to USD2008-4 on 2011-09-16 equals 1.0526, from USD to USD2008-4 on 2011-09-17 equals 1.0526, from USD to USD2008-4 on 2011-09-18 equals 1.0526, from USD to USD2008-4 on 2011-09-19 equals 1.0526, from USD to USD2008-4 on 2011-09-20 equals 1.0526, from USD to USD2008-4 on 2011-09-21 equals 1.0526, from USD to USD2008-4 on 2011-09-22 equals 1.0526, from USD to USD2008-4 on 2011-09-23 equals 1.0526, from USD to USD2008-4 on 2011-09-24 equals 1.0526, from USD to USD2008-4 on 2011-09-25 equals 1.0526, from USD to USD2008-4 on 2011-09-26 equals 1.0526, from USD to USD2008-4 on 2011-09-27 equals 1.0526, from USD to USD2008-4 on 2011-09-28 equals 1.0526, from USD to USD2008-4 on 2011-09-29 equals 1.0526, from USD to USD2008-4 on 2011-09-30 equals 1.0526, from USD to USD2008-4 on 2011-10-01 equals 1.0526, from USD to USD2008-4 on 2012-01-01 equals 1.0350]"
                , ccRates.toString());
        
        PersistenceManager.getSession().clear();
    }
    
    private List<AmpCurrencyRate> filterToDate(String topDateStr, List<AmpCurrencyRate> rates) {
        Date topLimit = DateTimeUtil.parseDate(topDateStr, "yyyy-MM-dd");
        for (Iterator<AmpCurrencyRate> iter = rates.iterator(); iter.hasNext();) {
            AmpCurrencyRate rate = iter.next();
            if (rate.getExchangeRateDate().after(topLimit)) {
                iter.remove();
            }
        }
        return rates;
    }
}
