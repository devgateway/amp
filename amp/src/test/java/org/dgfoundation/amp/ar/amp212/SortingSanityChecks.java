package org.dgfoundation.amp.ar.amp212;

import org.dgfoundation.amp.ar.ColumnConstants;
import org.dgfoundation.amp.ar.MeasureConstants;
import org.dgfoundation.amp.newreports.*;
import org.dgfoundation.amp.nireports.testcases.NiReportModel;
import org.junit.Test;

import java.util.Arrays;
import java.util.List;

/**
 * sorting tests common between both the offdb schema and the AmpReportsSchema-using one.
 * These are not supposed to be exhaustive tests; instead they are concerned about "no stupid or weird things happening"
 * @author Dolghier Constantin
 *
 */
public abstract class SortingSanityChecks extends ReportingTestCase {
            
    final List<String> acts = Arrays.asList(
            "activity 1 with agreement",
            "Activity 2 with multiple agreements",
            "Activity Linked With Pledge",
            "Activity with both MTEFs and Act.Comms",
            "activity with capital spending",
            "activity with components",
            "activity with contracting agency",
            "activity with directed MTEFs",
            "activity_with_disaster_response",
            "activity with funded components",
            "activity with incomplete agreement",
            "activity with many MTEFs",
            "activity with pipeline MTEFs and act. disb",
            "Activity with planned disbursements",
            "activity with primary_program",
            "Activity with primary_tertiary_program",
            "activity with tertiary_program",
            "activity-with-unfunded-components",
            "Activity with Zones",
            "Activity With Zones and Percentages",
            "crazy funding 1",
            "date-filters-activity",
            "Eth Water",
            "execution rate activity",
            "mtef activity 1",
            "mtef activity 2",
            "new activity with contracting",
            "pledged 2",
            "pledged education activity 1",
            "Project with documents",
            "Proposed Project Cost 1 - USD",
            "Proposed Project Cost 2 - EUR",
            "ptc activity 1",
            "ptc activity 2",
            "Pure MTEF Project",
            "SSC Project 1",
            "SSC Project 2",
            "SubNational no percentages",
            "TAC_activity_1",
            "TAC_activity_2",
            "Test MTEF directed",
            "third activity with agreements",
            "Unvalidated activity",
            "with weird currencies"
        );
    
    protected ReportSpecificationImpl buildSpecForSorting(String title, List<String> hiers, List<SortingInfo> sortingInfos) {
        ReportSpecificationImpl spec = buildSpecification(title, 
                Arrays.asList(ColumnConstants.PROJECT_TITLE, ColumnConstants.ACTIVITY_CREATED_ON, ColumnConstants.DONOR_AGENCY, ColumnConstants.LOCATION_ADM_LEVEL_2),
                Arrays.asList(MeasureConstants.ACTUAL_COMMITMENTS, MeasureConstants.ACTUAL_DISBURSEMENTS),
                hiers, 
                GroupingCriteria.GROUPING_YEARLY);
        
        spec.setSorters(sortingInfos);
        return spec;
    }
    
    @Test
    public void testSortingFlatReportByProjectTitle() {
        NiReportModel cor = new NiReportModel("flat by project title")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Administrative Level 2", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "Glodeni", "Funding-2014-Actual Commitments", "75,000", "Totals-Actual Commitments", "75,000"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Activity Created On", "11/10/2013", "Donor Agency", "Ministry of Economy, Ministry of Finance", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Activity Created On", "01/10/2013", "Donor Agency", "Ministry of Economy", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Activity Created On", "01/10/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Activity Created On", "18/11/2013", "Donor Agency", "USAID", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Activity Created On", "05/08/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Activity Created On", "05/08/2013", "Donor Agency", "UNDP", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Administrative Level 2", "", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Administrative Level 2", "Tiraspol", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Administrative Level 2", "Dolboaca, Glodeni", "Funding-2013-Actual Commitments", "890,000", "Totals-Actual Commitments", "890,000"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "Bulboaca, Glodeni", "Funding-2013-Actual Commitments", "570,000", "Totals-Actual Commitments", "570,000"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "Apareni, Slobozia", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2014-Actual Disbursements", "50,000", "Totals-Actual Commitments", "96,840,58", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Activity Created On", "15/11/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "Glodeni", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765")      ));
        ReportSpecificationImpl spec = buildSpecForSorting("flat by project title", null, Arrays.asList(new SortingInfo(new ReportColumn(ColumnConstants.PROJECT_TITLE), false)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingFlatReportByActivityCreatedOn() {
        NiReportModel cor = new NiReportModel("flat by activity created on")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Administrative Level 2", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Activity Created On", "05/08/2013", "Donor Agency", "UNDP", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Activity Created On", "05/08/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Administrative Level 2", "", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Activity Created On", "01/10/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Activity Created On", "01/10/2013", "Donor Agency", "Ministry of Economy", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Activity Created On", "11/10/2013", "Donor Agency", "Ministry of Economy, Ministry of Finance", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Activity Created On", "15/11/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Activity Created On", "18/11/2013", "Donor Agency", "USAID", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "Bulboaca, Glodeni", "Funding-2013-Actual Commitments", "570,000", "Totals-Actual Commitments", "570,000"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Administrative Level 2", "Dolboaca, Glodeni", "Funding-2013-Actual Commitments", "890,000", "Totals-Actual Commitments", "890,000"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "Glodeni", "Funding-2014-Actual Commitments", "75,000", "Totals-Actual Commitments", "75,000"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "Apareni, Slobozia", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2014-Actual Disbursements", "50,000", "Totals-Actual Commitments", "96,840,58", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Administrative Level 2", "Tiraspol", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "Glodeni", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98")      ));

        ReportSpecificationImpl spec = buildSpecForSorting("flat by activity created on", null, Arrays.asList(new SortingInfo(new ReportColumn(ColumnConstants.ACTIVITY_CREATED_ON), true)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingFlatReportByZone() {
        NiReportModel cor = new NiReportModel("flat by zone")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Administrative Level 2", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Activity Created On", "01/10/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Activity Created On", "01/10/2013", "Donor Agency", "Ministry of Economy", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Activity Created On", "11/10/2013", "Donor Agency", "Ministry of Economy, Ministry of Finance", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Activity Created On", "15/11/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Activity Created On", "18/11/2013", "Donor Agency", "USAID", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Activity Created On", "05/08/2013", "Donor Agency", "UNDP", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Administrative Level 2", "", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Activity Created On", "05/08/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "Apareni, Slobozia", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2014-Actual Disbursements", "50,000", "Totals-Actual Commitments", "96,840,58", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "Bulboaca, Glodeni", "Funding-2013-Actual Commitments", "570,000", "Totals-Actual Commitments", "570,000"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Administrative Level 2", "Dolboaca, Glodeni", "Funding-2013-Actual Commitments", "890,000", "Totals-Actual Commitments", "890,000"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "Glodeni", "Funding-2014-Actual Commitments", "75,000", "Totals-Actual Commitments", "75,000"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "Glodeni", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Administrative Level 2", "Tiraspol", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321")      ));
        
        ReportSpecificationImpl spec = buildSpecForSorting("flat by zone", null, Arrays.asList(new SortingInfo(new ReportColumn(ColumnConstants.LOCATION_ADM_LEVEL_2), true)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    
    @Test
    public void testSortingFlatReportByTotals() {
        NiReportModel cor = new NiReportModel("flat by Totals")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Administrative Level 2", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner(15), "Project Title", "Proposed Project Cost 1 - USD", "Activity Created On", "01/10/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(17), "Project Title", "Proposed Project Cost 2 - EUR", "Activity Created On", "01/10/2013", "Donor Agency", "Ministry of Economy", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                new ReportAreaForTests(new AreaOwner(19), "Project Title", "Pure MTEF Project", "Activity Created On", "11/10/2013", "Donor Agency", "Ministry of Economy, Ministry of Finance", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(21), "Project Title", "activity with components", "Activity Created On", "15/11/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(23), "Project Title", "Project with documents", "Activity Created On", "18/11/2013", "Donor Agency", "USAID", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                new ReportAreaForTests(new AreaOwner(25), "Project Title", "mtef activity 1", "Activity Created On", "05/08/2013", "Donor Agency", "UNDP", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(27), "Project Title", "mtef activity 2", "Activity Created On", "05/08/2013", "Donor Agency", "Finland", "Administrative Level 2", ""),
                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Administrative Level 2", "", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Administrative Level 2", "", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Administrative Level 2", "", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "Glodeni", "Funding-2014-Actual Commitments", "75,000", "Totals-Actual Commitments", "75,000"),
                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "Apareni, Slobozia", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2014-Actual Disbursements", "50,000", "Totals-Actual Commitments", "96,840,58", "Totals-Actual Disbursements", "50,000"),
                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98"),
                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Administrative Level 2", "Tiraspol", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321"),
                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Administrative Level 2", "", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Administrative Level 2", "Glodeni", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765"),
                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Administrative Level 2", "Bulboaca, Glodeni", "Funding-2013-Actual Commitments", "570,000", "Totals-Actual Commitments", "570,000"),
                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Administrative Level 2", "", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Administrative Level 2", "Dolboaca, Glodeni", "Funding-2013-Actual Commitments", "890,000", "Totals-Actual Commitments", "890,000"),
                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Administrative Level 2", "", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Administrative Level 2", "", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000")      ));
        
        ReportSpecificationImpl spec = buildSpecForSorting("flat by Totals", null, Arrays.asList(new SortingInfo(new ReportMeasure(MeasureConstants.ACTUAL_COMMITMENTS), true)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingHierReportByProjectTitle() {
        NiReportModel cor = new NiReportModel("hier by project title")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Administrative Level 2", "", "Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Apareni", 9113)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500", "Administrative Level 2", "Apareni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2014-Actual Disbursements", "27,500", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Bulboaca", 9108)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Bulboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Dolboaca", 9110)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Dolboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "178,000", "Totals-Actual Commitments", "178,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Glodeni", 9111))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "37,500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "1,491,289", "Totals-Actual Disbursements", "321,765", "Administrative Level 2", "Glodeni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "712,000", "Totals-Actual Commitments", "712,000"),
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000"),
                                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Slobozia", 9115)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500", "Administrative Level 2", "Slobozia")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2014-Actual Disbursements", "22,500", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Tiraspol", 9114)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "123,321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123,321", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Tiraspol")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Administrative Level 2: Undefined", -9089))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "6,382,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "7,998,992,77", "Funding-2014-Actual Disbursements", "660,200", "Funding-2015-Actual Commitments", "1,515,042,84", "Funding-2015-Actual Disbursements", "115,570", "Totals-Actual Commitments", "17,234,240,61", "Totals-Actual Disbursements", "2,835,037", "Administrative Level 2", "Administrative Level 2: Undefined")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98"),
                                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200")        )      ));
        
        ReportSpecificationImpl spec = buildSpecForSorting("hier by project title", Arrays.asList(ColumnConstants.LOCATION_ADM_LEVEL_2), Arrays.asList(new SortingInfo(new ReportColumn(ColumnConstants.PROJECT_TITLE), false)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingHierReportByActivityCreatedOn() {
        NiReportModel cor = new NiReportModel("hier by activity created on")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Administrative Level 2", "", "Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Apareni", 9113)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500", "Administrative Level 2", "Apareni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2014-Actual Disbursements", "27,500", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Bulboaca", 9108)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Bulboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Dolboaca", 9110)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Dolboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "178,000", "Totals-Actual Commitments", "178,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Glodeni", 9111))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "37,500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "1,491,289", "Totals-Actual Disbursements", "321,765", "Administrative Level 2", "Glodeni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000"),
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "712,000", "Totals-Actual Commitments", "712,000"),
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Slobozia", 9115)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500", "Administrative Level 2", "Slobozia")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2014-Actual Disbursements", "22,500", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Tiraspol", 9114)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "123,321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123,321", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Tiraspol")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Administrative Level 2: Undefined", -9089))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "6,382,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "7,998,992,77", "Funding-2014-Actual Disbursements", "660,200", "Funding-2015-Actual Commitments", "1,515,042,84", "Funding-2015-Actual Disbursements", "115,570", "Totals-Actual Commitments", "17,234,240,61", "Totals-Actual Disbursements", "2,835,037", "Administrative Level 2", "Administrative Level 2: Undefined")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98")        )      ));
        
        ReportSpecificationImpl spec = buildSpecForSorting("hier by activity created on", Arrays.asList(ColumnConstants.LOCATION_ADM_LEVEL_2), Arrays.asList(new SortingInfo(new ReportColumn(ColumnConstants.ACTIVITY_CREATED_ON), true)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    @Test
    public void testSortingHierReportByZone() {
        NiReportModel cor = new NiReportModel("hier by zone")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Administrative Level 2", "", "Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Apareni", 9113)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500", "Administrative Level 2", "Apareni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2014-Actual Disbursements", "27,500", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Bulboaca", 9108)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Bulboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Dolboaca", 9110)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Dolboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "178,000", "Totals-Actual Commitments", "178,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Glodeni", 9111))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "37,500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "1,491,289", "Totals-Actual Disbursements", "321,765", "Administrative Level 2", "Glodeni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000"),
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "712,000", "Totals-Actual Commitments", "712,000"),
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Slobozia", 9115)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500", "Administrative Level 2", "Slobozia")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2014-Actual Disbursements", "22,500", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Tiraspol", 9114)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "123,321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123,321", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Tiraspol")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Administrative Level 2: Undefined", -9089))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "6,382,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "7,998,992,77", "Funding-2014-Actual Disbursements", "660,200", "Funding-2015-Actual Commitments", "1,515,042,84", "Funding-2015-Actual Disbursements", "115,570", "Totals-Actual Commitments", "17,234,240,61", "Totals-Actual Disbursements", "2,835,037", "Administrative Level 2", "Administrative Level 2: Undefined")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000"),
                                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98")        )      ));
        
        ReportSpecificationImpl spec = buildSpecForSorting("hier by zone", Arrays.asList(ColumnConstants.LOCATION_ADM_LEVEL_2), Arrays.asList(new SortingInfo(new ReportColumn(ColumnConstants.LOCATION_ADM_LEVEL_2), true)));
        runNiTestCase(spec, "en", acts, cor);
    }
    
    
    @Test
    public void testSortingHierReportByTotals() {
        NiReportModel cor = new NiReportModel("hier by Totals")
                .withHeaders(Arrays.asList(
                        "(RAW: (startRow: 0, rowSpan: 1, totalRowSpan: 4, colStart: 0, colSpan: 22))",
                        "(Administrative Level 2: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 0, colSpan: 1));(Project Title: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 1, colSpan: 1));(Activity Created On: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 2, colSpan: 1));(Donor Agency: (startRow: 1, rowSpan: 3, totalRowSpan: 3, colStart: 3, colSpan: 1));(Funding: (startRow: 1, rowSpan: 1, totalRowSpan: 3, colStart: 4, colSpan: 16));(Totals: (startRow: 1, rowSpan: 2, totalRowSpan: 3, colStart: 20, colSpan: 2))",
                        "(2006: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 4, colSpan: 2));(2009: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 6, colSpan: 2));(2010: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 8, colSpan: 2));(2011: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 10, colSpan: 2));(2012: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 12, colSpan: 2));(2013: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 14, colSpan: 2));(2014: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 16, colSpan: 2));(2015: (startRow: 2, rowSpan: 1, totalRowSpan: 2, colStart: 18, colSpan: 2))",
                        "(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 4, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 5, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 6, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 7, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 8, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 9, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 10, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 11, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 12, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 13, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 14, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 15, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 16, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 17, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 18, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 19, colSpan: 1));(Actual Commitments: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 20, colSpan: 1));(Actual Disbursements: (startRow: 3, rowSpan: 1, totalRowSpan: 1, colStart: 21, colSpan: 1))"))
                .withWarnings(Arrays.asList())
                .withBody(      new ReportAreaForTests(null)
                        .withContents("Administrative Level 2", "", "Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "96,840,58", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "7,842,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "8,159,813,77", "Funding-2014-Actual Disbursements", "710,200", "Funding-2015-Actual Commitments", "1,971,831,84", "Funding-2015-Actual Disbursements", "437,335", "Totals-Actual Commitments", "19,408,691,19", "Totals-Actual Disbursements", "3,206,802")
                        .withChildren(
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Slobozia", 9115)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "22,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500", "Administrative Level 2", "Slobozia")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "43,578,26", "Funding-2014-Actual Disbursements", "22,500", "Totals-Actual Commitments", "43,578,26", "Totals-Actual Disbursements", "22,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Apareni", 9113)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "27,500", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500", "Administrative Level 2", "Apareni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(52), "Project Title", "activity with contracting agency", "Activity Created On", "26/11/2014", "Donor Agency", "Finland, Ministry of Finance", "Funding-2006-Actual Commitments", "53,262,32", "Funding-2014-Actual Disbursements", "27,500", "Totals-Actual Commitments", "53,262,32", "Totals-Actual Disbursements", "27,500")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Tiraspol", 9114)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "0", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "123,321", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "123,321", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Tiraspol")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(61), "Project Title", "activity-with-unfunded-components", "Activity Created On", "15/12/2014", "Donor Agency", "Finland, Ministry of Economy", "Funding-2014-Actual Commitments", "123,321", "Totals-Actual Commitments", "123,321")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Dolboaca", 9110)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "178,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "178,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Dolboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "178,000", "Totals-Actual Commitments", "178,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Bulboaca", 9108)).withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "285,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "0", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "0", "Funding-2015-Actual Disbursements", "0", "Totals-Actual Commitments", "285,000", "Totals-Actual Disbursements", "0", "Administrative Level 2", "Bulboaca")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Glodeni", 9111))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "0", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "0", "Funding-2011-Actual Commitments", "0", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "0", "Funding-2012-Actual Disbursements", "0", "Funding-2013-Actual Commitments", "997,000", "Funding-2013-Actual Disbursements", "0", "Funding-2014-Actual Commitments", "37,500", "Funding-2014-Actual Disbursements", "0", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "1,491,289", "Totals-Actual Disbursements", "321,765", "Administrative Level 2", "Glodeni")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(33), "Project Title", "Activity with Zones", "Activity Created On", "23/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "285,000", "Totals-Actual Commitments", "285,000"),
                                                new ReportAreaForTests(new AreaOwner(65), "Project Title", "activity 1 with agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "456,789", "Funding-2015-Actual Disbursements", "321,765", "Totals-Actual Commitments", "456,789", "Totals-Actual Disbursements", "321,765"),
                                                new ReportAreaForTests(new AreaOwner(36), "Project Title", "Activity With Zones and Percentages", "Activity Created On", "23/12/2013", "Donor Agency", "Norway", "Funding-2013-Actual Commitments", "712,000", "Totals-Actual Commitments", "712,000")        ),
                                new ReportAreaForTests(new AreaOwner("Administrative Level 2", "Administrative Level 2: Undefined", -9089))
                                        .withContents("Project Title", "", "Activity Created On", "", "Donor Agency", "", "Funding-2006-Actual Commitments", "0", "Funding-2006-Actual Disbursements", "0", "Funding-2009-Actual Commitments", "100,000", "Funding-2009-Actual Disbursements", "0", "Funding-2010-Actual Commitments", "0", "Funding-2010-Actual Disbursements", "780,311", "Funding-2011-Actual Commitments", "1,213,119", "Funding-2011-Actual Disbursements", "0", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Funding-2013-Actual Commitments", "6,382,086", "Funding-2013-Actual Disbursements", "1,266,956", "Funding-2014-Actual Commitments", "7,998,992,77", "Funding-2014-Actual Disbursements", "660,200", "Funding-2015-Actual Commitments", "1,515,042,84", "Funding-2015-Actual Disbursements", "115,570", "Totals-Actual Commitments", "17,234,240,61", "Totals-Actual Disbursements", "2,835,037", "Administrative Level 2", "Administrative Level 2: Undefined")
                                        .withChildren(
                                                new ReportAreaForTests(new AreaOwner(18), "Project Title", "Test MTEF directed", "Activity Created On", "10/10/2013", "Donor Agency", "Ministry of Economy, USAID", "Funding-2010-Actual Disbursements", "143,777", "Totals-Actual Disbursements", "143,777"),
                                                new ReportAreaForTests(new AreaOwner(24), "Project Title", "Eth Water", "Activity Created On", "01/08/2013", "Donor Agency", "Finland, Norway, USAID", "Funding-2013-Actual Disbursements", "545,000", "Totals-Actual Disbursements", "545,000"),
                                                new ReportAreaForTests(new AreaOwner(69), "Project Title", "Activity with planned disbursements", "Activity Created On", "10/04/2015", "Donor Agency", "Norway, USAID", "Funding-2014-Actual Disbursements", "200", "Funding-2015-Actual Disbursements", "570", "Totals-Actual Disbursements", "770"),
                                                new ReportAreaForTests(new AreaOwner(76), "Project Title", "activity with pipeline MTEFs and act. disb", "Activity Created On", "19/10/2015", "Donor Agency", "Norway, UNDP", "Funding-2013-Actual Disbursements", "35,000", "Funding-2014-Actual Disbursements", "75,000", "Totals-Actual Disbursements", "110,000"),
                                                new ReportAreaForTests(new AreaOwner(77), "Project Title", "execution rate activity", "Activity Created On", "19/10/2015", "Donor Agency", "Ministry of Finance, UNDP", "Funding-2014-Actual Disbursements", "55,000", "Funding-2015-Actual Disbursements", "35,000", "Totals-Actual Disbursements", "90,000"),
                                                new ReportAreaForTests(new AreaOwner(78), "Project Title", "activity with many MTEFs", "Activity Created On", "05/11/2015", "Donor Agency", "Finland, Norway, USAID", "Funding-2015-Actual Disbursements", "80,000", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(63), "Project Title", "activity with funded components", "Activity Created On", "16/12/2014", "Donor Agency", "UNDP, Water Foundation, World Bank", "Funding-2014-Actual Commitments", "100", "Totals-Actual Commitments", "100"),
                                                new ReportAreaForTests(new AreaOwner(66), "Project Title", "Activity 2 with multiple agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Ministry of Finance, UNDP, USAID", "Funding-2015-Actual Commitments", "1,200", "Totals-Actual Commitments", "1,200"),
                                                new ReportAreaForTests(new AreaOwner(53), "Project Title", "new activity with contracting", "Activity Created On", "26/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "12,000", "Totals-Actual Commitments", "12,000"),
                                                new ReportAreaForTests(new AreaOwner(45), "Project Title", "activity with tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "15,000", "Totals-Actual Commitments", "15,000"),
                                                new ReportAreaForTests(new AreaOwner(44), "Project Title", "activity with primary_program", "Activity Created On", "28/03/2014", "Donor Agency", "World Bank", "Funding-2014-Actual Commitments", "32,000", "Totals-Actual Commitments", "32,000"),
                                                new ReportAreaForTests(new AreaOwner(40), "Project Title", "SubNational no percentages", "Activity Created On", "21/02/2014", "Donor Agency", "Ministry of Economy", "Funding-2014-Actual Commitments", "37,500", "Totals-Actual Commitments", "37,500"),
                                                new ReportAreaForTests(new AreaOwner(64), "Project Title", "Unvalidated activity", "Activity Created On", "25/01/2015", "Donor Agency", "UNDP", "Funding-2015-Actual Commitments", "45,000", "Totals-Actual Commitments", "45,000"),
                                                new ReportAreaForTests(new AreaOwner(41), "Project Title", "Activity Linked With Pledge", "Activity Created On", "27/03/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(43), "Project Title", "Activity with primary_tertiary_program", "Activity Created On", "28/03/2014", "Donor Agency", "UNDP", "Funding-2014-Actual Commitments", "50,000", "Totals-Actual Commitments", "50,000"),
                                                new ReportAreaForTests(new AreaOwner(50), "Project Title", "activity with capital spending", "Activity Created On", "21/11/2014", "Donor Agency", "Finland", "Funding-2014-Actual Commitments", "65,760,63", "Funding-2014-Actual Disbursements", "80,000", "Totals-Actual Commitments", "65,760,63", "Totals-Actual Disbursements", "80,000"),
                                                new ReportAreaForTests(new AreaOwner(79), "Project Title", "with weird currencies", "Activity Created On", "15/12/2015", "Donor Agency", "Finland, Ministry of Finance, Norway", "Funding-2014-Actual Commitments", "3,632,14", "Funding-2015-Actual Commitments", "93,930,84", "Totals-Actual Commitments", "97,562,98"),
                                                new ReportAreaForTests(new AreaOwner(30), "Project Title", "SSC Project 1", "Activity Created On", "20/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "111,333", "Funding-2013-Actual Disbursements", "555,111", "Totals-Actual Commitments", "111,333", "Totals-Actual Disbursements", "555,111"),
                                                new ReportAreaForTests(new AreaOwner(68), "Project Title", "activity with incomplete agreement", "Activity Created On", "22/03/2015", "Donor Agency", "Finland", "Funding-2015-Actual Commitments", "123,000", "Totals-Actual Commitments", "123,000"),
                                                new ReportAreaForTests(new AreaOwner(67), "Project Title", "third activity with agreements", "Activity Created On", "22/03/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(73), "Project Title", "activity with directed MTEFs", "Activity Created On", "29/09/2015", "Donor Agency", "Ministry of Economy", "Funding-2015-Actual Commitments", "123,456", "Totals-Actual Commitments", "123,456"),
                                                new ReportAreaForTests(new AreaOwner(26), "Project Title", "date-filters-activity", "Activity Created On", "21/09/2013", "Donor Agency", "Ministry of Finance", "Funding-2009-Actual Commitments", "100,000", "Funding-2010-Actual Disbursements", "60,000", "Funding-2012-Actual Commitments", "25,000", "Funding-2012-Actual Disbursements", "12,000", "Totals-Actual Commitments", "125,000", "Totals-Actual Disbursements", "72,000"),
                                                new ReportAreaForTests(new AreaOwner(71), "Project Title", "activity_with_disaster_response", "Activity Created On", "24/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2014-Actual Commitments", "33,000", "Funding-2015-Actual Commitments", "117,000", "Totals-Actual Commitments", "150,000"),
                                                new ReportAreaForTests(new AreaOwner(12), "Project Title", "TAC_activity_1", "Activity Created On", "23/08/2013", "Donor Agency", "World Bank", "Funding-2010-Actual Disbursements", "123,321", "Funding-2011-Actual Commitments", "213,231", "Totals-Actual Commitments", "213,231", "Totals-Actual Disbursements", "123,321"),
                                                new ReportAreaForTests(new AreaOwner(29), "Project Title", "ptc activity 2", "Activity Created On", "19/08/2013", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "333,222", "Totals-Actual Commitments", "333,222"),
                                                new ReportAreaForTests(new AreaOwner(32), "Project Title", "crazy funding 1", "Activity Created On", "20/12/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "333,333", "Totals-Actual Commitments", "333,333"),
                                                new ReportAreaForTests(new AreaOwner(31), "Project Title", "SSC Project 2", "Activity Created On", "20/08/2013", "Donor Agency", "Water Org", "Funding-2013-Actual Commitments", "567,421", "Funding-2013-Actual Disbursements", "131,845", "Totals-Actual Commitments", "567,421", "Totals-Actual Disbursements", "131,845"),
                                                new ReportAreaForTests(new AreaOwner(28), "Project Title", "ptc activity 1", "Activity Created On", "19/08/2013", "Donor Agency", "Finland", "Funding-2013-Actual Commitments", "666,777", "Totals-Actual Commitments", "666,777"),
                                                new ReportAreaForTests(new AreaOwner(70), "Project Title", "Activity with both MTEFs and Act.Comms", "Activity Created On", "06/08/2015", "Donor Agency", "Finland, Ministry of Finance", "Funding-2015-Actual Commitments", "888,000", "Totals-Actual Commitments", "888,000"),
                                                new ReportAreaForTests(new AreaOwner(13), "Project Title", "TAC_activity_2", "Activity Created On", "23/08/2013", "Donor Agency", "Water Foundation", "Funding-2010-Actual Disbursements", "453,213", "Funding-2011-Actual Commitments", "999,888", "Totals-Actual Commitments", "999,888", "Totals-Actual Disbursements", "453,213"),
                                                new ReportAreaForTests(new AreaOwner(46), "Project Title", "pledged education activity 1", "Activity Created On", "29/04/2014", "Donor Agency", "USAID", "Funding-2013-Actual Commitments", "1,700,000", "Funding-2014-Actual Commitments", "3,300,000", "Totals-Actual Commitments", "5,000,000"),
                                                new ReportAreaForTests(new AreaOwner(48), "Project Title", "pledged 2", "Activity Created On", "29/04/2014", "Donor Agency", "Finland, USAID", "Funding-2013-Actual Commitments", "2,670,000", "Funding-2014-Actual Commitments", "4,400,000", "Funding-2014-Actual Disbursements", "450,000", "Totals-Actual Commitments", "7,070,000", "Totals-Actual Disbursements", "450,000")        )      ));
        
        ReportSpecificationImpl spec = buildSpecForSorting("hier by Totals", Arrays.asList(ColumnConstants.LOCATION_ADM_LEVEL_2), Arrays.asList(new SortingInfo(new ReportMeasure(MeasureConstants.ACTUAL_COMMITMENTS), true)));
        runNiTestCase(spec, "en", acts, cor);
    }
}
